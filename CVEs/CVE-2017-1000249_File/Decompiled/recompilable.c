#include <emmintrin.h>
#include <stdio.h>
#include <stdlib.h>
#include <ctype.h>
#include <errno.h>
#include <sys/stat.h> // TODO: Manually added for type stat.

#define _stdout stdout //TODO
#define _stderr stderr //TODO
long DAT_001244f4; //TODO
long DAT_0011c415; //TODO
long DAT_001244e8; //TODO
long DAT_001244e0; // TODO
long DAT_001245e0; // TODO
long DAT_00124500; //TODO
long DAT_0011c549; //TODO
long DAT_0011c544; //TODO
long DAT_0011c570; //TODO
long DAT_0011c4ce; //TODO
long DAT_001244f0; //TODO
long DAT_0011bcc0; //TODO
long DAT_00124500; //TODO
long DAT_001245e0; //TODO
long DAT_001244f0; //TODO
long DAT_0011ddf7; //TODO
long DAT_0011c77d; //TODO
long DAT_0011ce1b; //TODO:"first use in this function"
long DAT_0011ce16; //TODO
long DAT_0011cf63; //TODO
long DAT_0011ce1b; //TODO
long DAT_0011d936; //TODO
long DAT_0011d952; //TODO
long DAT_0011e895; //TODO
long DAT_0011d95a; //TODO
long DAT_0011d956; //TODO
long DAT_0011dbe0; //TODO
long DAT_0011d9e0; //TODO
long DAT_0011dae0; //TODO
long DAT_0011dd35; //TODO
long DAT_0011e5d0; //TODO
long DAT_0011e640; //TODO
long DAT_0011e600; //TODO
long DAT_0011e152; //TODO
long DAT_0011e168; //TODO
long DAT_0011e1bc; //TODO
long DAT_0011e1bf; //TODO
long DAT_0011e1c3; //TODO
long DAT_0011e8a9; //TODO
long DAT_0011e20d; //TODO
long DAT_0011e212; //TODO
long DAT_0011ddf7; //TODO
long DAT_0011e895; //TODO
long DAT_0011e898; //TODO
long DAT_0011ddf7; //TODO
long DAT_0011ddf7; //TODO
long DAT_0011e299; //TODO
long DAT_001238e0; //TODO
long DAT_00123740; //TODO
long DAT_001245e0; //TODO
long DAT_0011e88b; //TODO
long DAT_0011e890; //TODO
long DAT_0011e897; //TODO
long DAT_0011e89d; //TODO
long DAT_0011e8a8; //TODO
long DAT_0011e8ac; //TODO
long DAT_0011e8b1; //TODO
long DAT_0011e88c; //TODO
long DAT_0011ddf7; //TODO
long DAT_0011e898; //TODO
long DAT_0011ce1b; //TODO
long DAT_0011ddf7; //TODO
long DAT_0011e898; //TODO
long DAT_0011eddf; //TODO
long DAT_0011edfd; //TODO
long DAT_001244f8; //TODO
long DAT_00123ab0; //TODO
long DAT_0011ef8a; //TODO
long DAT_0011ef8f; //TODO
long DAT_0011ef9a; //TODO
long DAT_0011f2c0; //TODO
long DAT_001244c0; //TODO
long DAT_0011e898; //TODO
long DAT_00123d40; //TODO
long DAT_00123c68; //TODO
long stack0x00000008; //TODO
long stack0xffffffffffffffd0; //TODO
long stack0x00000008; //TODO
long stack0xffffffffffffffd0; //TODO
long stack0x00000008; //TODO
long stack0x00000008; //TODO
long stack0x00000008; //TODO
long PTR_s__mprotect_00123700; //TODO
long PTR_s_Code_page_00123aa8; //TODO
long PTR_s_Encrypted_00123be0; //TODO
long PTR_s_mfbu_header_00123c40; //TODO
long PTR_s_encrypted_00123be8; //TODO
long PTR_DAT_00123ce0; //TODO
long PTR_DAT_00123c80; //TODO
long PTR_DAT_001239a0; //TODO
long PTR_DAT_00123520; //TODO
long PTR_FUN_00123530; //TODO
long PTR_FUN_001235a0; //TODO
long PTR_PTR_DAT_001235b0; //TODO
long PTR_LOOP_00124380; //TODO
long UNK_001235a8; //TODO
typedef void code; //TODO
typedef unsigned char   undefined;
typedef unsigned char    byte;
typedef unsigned char    dwfenc;
typedef unsigned int    dword;
typedef unsigned long    qword;
typedef unsigned char    uchar;
typedef unsigned int    uint;
typedef unsigned int    uint3; // TODO: Manually add.
typedef unsigned long    ulong;
typedef unsigned long long    ulonglong;
typedef unsigned char    undefined1;
typedef unsigned short    undefined2;
typedef unsigned int    undefined4;
typedef unsigned long    undefined8;
typedef unsigned short    ushort;
typedef int    wchar_t;
typedef unsigned short    word;
typedef struct eh_frame_hdr eh_frame_hdr, *Peh_frame_hdr;

#define false 0    // TODO:"first use in this function"
#define true 1     // TODO
typedef int bool;  // TODO

// TODO: error: conflicting types for ‘FUN_00107140’
// TODO: note: previous implicit declaration of ‘FUN_0011a440’ was here.
// TODO: Take the line righrt after the "error" and prototype it here.
long FUN_0011a440(long param_1,long param_2);
undefined8 * FUN_00107030(undefined4 param_1);
undefined4 FUN_00107140(long *param_1,long param_2,long param_3,long param_4);
undefined4 FUN_00109b50(long *param_1,undefined8 param_2,uint param_3);
ulong FUN_0010d250(long param_1,long param_2,uint param_3,undefined8 param_4,undefined8 param_5,
                  undefined8 param_6,uint param_7,int param_8,undefined4 param_9,undefined8 param_10
                  ,undefined8 param_11,int *param_12,int *param_13,uint *param_14);
undefined8 FUN_0010e410(long param_1,ulong param_2,long param_3,long *param_4);
undefined8 FUN_0010e5b0(undefined8 param_1,byte *param_2,ulong param_3,long *param_4,long *param_5,
            undefined8 *param_6,undefined8 *param_7,undefined8 *param_8);
ulong FUN_0010eeb0(int param_1,void *param_2,size_t param_3,int param_4);
char * FUN_00113da0(time_t param_1,uint param_2,char *param_3);
uint FUN_001145b0(long param_1,char *param_2, struct stat *param_3);
undefined4 FUN_00114ee0(long param_1,undefined8 param_2,undefined8 param_3);
undefined8 FUN_001157e0(long *param_1);
char * FUN_00115840(long param_1);
undefined8 FUN_00115ad0(long param_1,uint param_2);
size_t FUN_00115b50(long param_1);
undefined8 * FUN_00115e40(long param_1);
undefined8 FUN_00115e90(long param_1,undefined8 *param_2);
byte * FUN_00115ef0(byte *param_1,long param_2,byte *param_3);
long FUN_001160a0(long param_1,ushort *param_2,ulong param_3);
undefined8 FUN_00116150(long param_1,long param_2);
undefined8 FUN_00118d10(time_t *param_1,long param_2);
uint FUN_00119180(long param_1,undefined4 param_2,undefined8 param_3,undefined8 param_4);
char * FUN_00119e40(char *param_1,char *param_2,long param_3);
char * FUN_00119ec0(char *param_1,char *param_2,long param_3);
undefined8 FUN_00104f30(long param_1,char *param_2,int param_3);


struct eh_frame_hdr {
    byte eh_frame_hdr_version; // Exception Handler Frame Header Version
    dwfenc eh_frame_pointer_encoding; // Exception Handler Frame Pointer Encoding
    dwfenc eh_frame_desc_entry_count_encoding; // Encoding of # of Exception Handler FDEs
    dwfenc eh_frame_table_encoding; // Exception Handler Table Encoding
};

typedef struct NoteGnuPropertyElement_4 NoteGnuPropertyElement_4, *PNoteGnuPropertyElement_4;

struct NoteGnuPropertyElement_4 {
    dword prType;
    dword prDatasz;
    byte data[4];
};

typedef struct fde_table_entry fde_table_entry, *Pfde_table_entry;

struct fde_table_entry {
    dword initial_loc; // Initial Location
    dword data_loc; // Data location
};

typedef void _IO_lock_t;

typedef struct _IO_marker _IO_marker, *P_IO_marker;

typedef struct _IO_FILE _IO_FILE, *P_IO_FILE;

typedef long __off_t;

typedef long __off64_t;

typedef ulong size_t;

// struct _IO_FILE {
//     int _flags;
//     char *_IO_read_ptr;
//     char *_IO_read_end;
//     char *_IO_read_base;
//     char *_IO_write_base;
//     char *_IO_write_ptr;
//     char *_IO_write_end;
//     char *_IO_buf_base;
//     char *_IO_buf_end;
//     char *_IO_save_base;
//     char *_IO_backup_base;
//     char *_IO_save_end;
//     struct _IO_marker *_markers;
//     struct _IO_FILE *_chain;
//     int _fileno;
//     int _flags2;
//     __off_t _old_offset;
//     ushort _cur_column;
//     char _vtable_offset;
//     char _shortbuf[1];
//     _IO_lock_t *_lock;
//     __off64_t _offset;
//     void *__pad1;
//     void *__pad2;
//     void *__pad3;
//     void *__pad4;
//     size_t __pad5;
//     int _mode;
//     char _unused2[20];
// };
 // Script-added comment
struct _IO_marker {
    struct _IO_marker *_next;
    struct _IO_FILE *_sbuf;
    int _pos;
};

//typedef struct stat stat, *Pstat;

typedef ulong __dev_t;

typedef ulong __ino_t;

typedef ulong __nlink_t;

typedef uint __mode_t;

typedef uint __uid_t;

typedef uint __gid_t;

typedef long __blksize_t;

typedef long __blkcnt_t;

typedef struct timespec timespec, *Ptimespec;

typedef long __time_t;

// struct timespec {
//     __time_t tv_sec;
//     long tv_nsec;
// };
 // Script-added comment
//struct stat {
//    __dev_t st_dev;
//    __ino_t st_ino;
//    __nlink_t st_nlink;
//    __mode_t st_mode;
//    __uid_t st_uid;
//    __gid_t st_gid;
//    int __pad0;
//    __dev_t st_rdev;
//    __off_t st_size;
//    __blksize_t st_blksize;
//    __blkcnt_t st_blocks;
//    struct timespec st_atim;
//    struct timespec st_mtim;
//    struct timespec st_ctim;
//    long __unused[3];
//};

typedef struct timeval timeval, *Ptimeval;

typedef long __suseconds_t;

// struct timeval {
//     __time_t tv_sec;
//     __suseconds_t tv_usec;
// };
 // Script-added comment
typedef struct tm tm, *Ptm;

struct tm {
    int tm_sec;
    int tm_min;
    int tm_hour;
    int tm_mday;
    int tm_mon;
    int tm_year;
    int tm_wday;
    int tm_yday;
    int tm_isdst;
    long tm_gmtoff;
    char *tm_zone;
};

typedef __time_t time_t;

// typedef struct _IO_FILE FILE; // TODO:conflicting types.

typedef struct __locale_data __locale_data, *P__locale_data;

struct __locale_data {
};

typedef struct __locale_struct __locale_struct, *P__locale_struct;

// struct __locale_struct {
//     struct __locale_data *__locales[13];
//     ushort *__ctype_b;
//     int *__ctype_tolower;
//     int *__ctype_toupper;
//     char *__names[13];
// };
 // Script-added comment
//typedef struct __locale_struct *__locale_t;

typedef uint wint_t;

typedef long __fd_mask;

//typedef struct fd_set fd_set, *Pfd_set;

struct fd_set {
    __fd_mask fds_bits[16];
};

typedef long __ssize_t;

typedef __ssize_t ssize_t;

typedef int __pid_t;

typedef int __int32_t;

typedef void (*__sighandler_t)(int);

typedef struct __dirstream __dirstream, *P__dirstream;

struct __dirstream {
};

typedef struct __dirstream DIR;

typedef struct dirent dirent, *Pdirent;

struct dirent {
    __ino_t d_ino;
    __off_t d_off;
    ushort d_reclen;
    uchar d_type;
    char d_name[256];
};

typedef struct re_pattern_buffer re_pattern_buffer, *Pre_pattern_buffer;

typedef ulong reg_syntax_t;

struct re_pattern_buffer {
    uchar *buffer;
    ulong allocated;
    ulong used;
    reg_syntax_t syntax;
    char *fastmap;
    uchar *translate;
    size_t re_nsub;
    uint can_be_null:1;
    uint regs_allocated:2;
    uint fastmap_accurate:1;
    uint no_sub:1;
    uint not_bol:1;
    uint not_eol:1;
    uint newline_anchor:1;
};

typedef struct regmatch_t regmatch_t, *Pregmatch_t;

typedef int regoff_t;

struct regmatch_t {
    regoff_t rm_so;
    regoff_t rm_eo;
};

typedef struct re_pattern_buffer regex_t;

//typedef struct __mbstate_t __mbstate_t, *P__mbstate_t;

typedef union _union_27 _union_27, *P_union_27;

union _union_27 {
    uint __wch;
    char __wchb[4];
};

struct __mbstate_t {
    int __count;
    union _union_27 __value;
};

typedef struct __mbstate_t mbstate_t;

//typedef int (*__compar_fn_t)(void *, void *);

typedef struct Elf64_Rela Elf64_Rela, *PElf64_Rela;

struct Elf64_Rela {
    qword r_offset; // location to apply the relocation action
    qword r_info; // the symbol table index and the type of relocation
    qword r_addend; // a constant addend used to compute the relocatable field value
};

typedef enum Elf_ProgramHeaderType {
    PT_NULL=0,
    PT_LOAD=1,
    PT_DYNAMIC=2,
    PT_INTERP=3,
    PT_NOTE=4,
    PT_SHLIB=5,
    PT_PHDR=6,
    PT_TLS=7,
    PT_GNU_EH_FRAME=1685382480,
    PT_GNU_STACK=1685382481,
    PT_GNU_RELRO=1685382482
} Elf_ProgramHeaderType;

typedef struct Elf64_Shdr Elf64_Shdr, *PElf64_Shdr;

typedef enum Elf_SectionHeaderType {
    SHT_NULL=0,
    SHT_PROGBITS=1,
    SHT_SYMTAB=2,
    SHT_STRTAB=3,
    SHT_RELA=4,
    SHT_HASH=5,
    SHT_DYNAMIC=6,
    SHT_NOTE=7,
    SHT_NOBITS=8,
    SHT_REL=9,
    SHT_SHLIB=10,
    SHT_DYNSYM=11,
    SHT_INIT_ARRAY=14,
    SHT_FINI_ARRAY=15,
    SHT_PREINIT_ARRAY=16,
    SHT_GROUP=17,
    SHT_SYMTAB_SHNDX=18,
    SHT_ANDROID_REL=1610612737,
    SHT_ANDROID_RELA=1610612738,
    SHT_GNU_ATTRIBUTES=1879048181,
    SHT_GNU_HASH=1879048182,
    SHT_GNU_LIBLIST=1879048183,
    SHT_CHECKSUM=1879048184,
    SHT_SUNW_move=1879048186,
    SHT_SUNW_COMDAT=1879048187,
    SHT_SUNW_syminfo=1879048188,
    SHT_GNU_verdef=1879048189,
    SHT_GNU_verneed=1879048190,
    SHT_GNU_versym=1879048191
} Elf_SectionHeaderType;

struct Elf64_Shdr {
    dword sh_name;
    enum Elf_SectionHeaderType sh_type;
    qword sh_flags;
    qword sh_addr;
    qword sh_offset;
    qword sh_size;
    dword sh_link;
    dword sh_info;
    qword sh_addralign;
    qword sh_entsize;
};

typedef struct Elf64_Dyn Elf64_Dyn, *PElf64_Dyn;

typedef enum Elf64_DynTag {
    DT_NULL=0,
    DT_NEEDED=1,
    DT_PLTRELSZ=2,
    DT_PLTGOT=3,
    DT_HASH=4,
    DT_STRTAB=5,
    DT_SYMTAB=6,
    DT_RELA=7,
    DT_RELASZ=8,
    DT_RELAENT=9,
    DT_STRSZ=10,
    DT_SYMENT=11,
    DT_INIT=12,
    DT_FINI=13,
    DT_SONAME=14,
    DT_RPATH=15,
    DT_SYMBOLIC=16,
    DT_REL=17,
    DT_RELSZ=18,
    DT_RELENT=19,
    DT_PLTREL=20,
    DT_DEBUG=21,
    DT_TEXTREL=22,
    DT_JMPREL=23,
    DT_BIND_NOW=24,
    DT_INIT_ARRAY=25,
    DT_FINI_ARRAY=26,
    DT_INIT_ARRAYSZ=27,
    DT_FINI_ARRAYSZ=28,
    DT_RUNPATH=29,
    DT_FLAGS=30,
    DT_PREINIT_ARRAY=32,
    DT_PREINIT_ARRAYSZ=33,
    DT_RELRSZ=35,
    DT_RELR=36,
    DT_RELRENT=37,
    DT_ANDROID_REL=1610612751,
    DT_ANDROID_RELSZ=1610612752,
    DT_ANDROID_RELA=1610612753,
    DT_ANDROID_RELASZ=1610612754,
    DT_ANDROID_RELR=1879040000,
    DT_ANDROID_RELRSZ=1879040001,
    DT_ANDROID_RELRENT=1879040003,
    DT_GNU_PRELINKED=1879047669,
    DT_GNU_CONFLICTSZ=1879047670,
    DT_GNU_LIBLISTSZ=1879047671,
    DT_CHECKSUM=1879047672,
    DT_PLTPADSZ=1879047673,
    DT_MOVEENT=1879047674,
    DT_MOVESZ=1879047675,
    DT_FEATURE_1=1879047676,
    DT_POSFLAG_1=1879047677,
    DT_SYMINSZ=1879047678,
    DT_SYMINENT=1879047679,
    DT_GNU_XHASH=1879047924,
    DT_GNU_HASH=1879047925,
    DT_TLSDESC_PLT=1879047926,
    DT_TLSDESC_GOT=1879047927,
    DT_GNU_CONFLICT=1879047928,
    DT_GNU_LIBLIST=1879047929,
    DT_CONFIG=1879047930,
    DT_DEPAUDIT=1879047931,
    DT_AUDIT=1879047932,
    DT_PLTPAD=1879047933,
    DT_MOVETAB=1879047934,
    DT_SYMINFO=1879047935,
    DT_VERSYM=1879048176,
    DT_RELACOUNT=1879048185,
    DT_RELCOUNT=1879048186,
    DT_FLAGS_1=1879048187,
    DT_VERDEF=1879048188,
    DT_VERDEFNUM=1879048189,
    DT_VERNEED=1879048190,
    DT_VERNEEDNUM=1879048191,
    DT_AUXILIARY=2147483645,
    DT_FILTER=2147483647
} Elf64_DynTag;

struct Elf64_Dyn {
    enum Elf64_DynTag d_tag;
    qword d_val;
};

typedef struct GnuBuildId GnuBuildId, *PGnuBuildId;

struct GnuBuildId {
    dword namesz; // Length of name field
    dword descsz; // Length of description field
    dword type; // Vendor specific type
    char name[4]; // Vendor name
    byte hash[20];
};

typedef struct NoteGnuProperty_4 NoteGnuProperty_4, *PNoteGnuProperty_4;

struct NoteGnuProperty_4 {
    dword namesz; // Length of name field
    dword descsz; // Length of description field
    dword type; // Vendor specific type
    char name[4]; // Vendor name
};

typedef struct Elf64_Ehdr Elf64_Ehdr, *PElf64_Ehdr;

struct Elf64_Ehdr {
    byte e_ident_magic_num;
    char e_ident_magic_str[3];
    byte e_ident_class;
    byte e_ident_data;
    byte e_ident_version;
    byte e_ident_osabi;
    byte e_ident_abiversion;
    byte e_ident_pad[7];
    word e_type;
    word e_machine;
    dword e_version;
    qword e_entry;
    qword e_phoff;
    qword e_shoff;
    dword e_flags;
    word e_ehsize;
    word e_phentsize;
    word e_phnum;
    word e_shentsize;
    word e_shnum;
    word e_shstrndx;
};

typedef struct Elf64_Phdr Elf64_Phdr, *PElf64_Phdr;

struct Elf64_Phdr {
    enum Elf_ProgramHeaderType p_type;
    dword p_flags;
    qword p_offset;
    qword p_vaddr;
    qword p_paddr;
    qword p_filesz;
    qword p_memsz;
    qword p_align;
};

typedef struct Elf64_Sym Elf64_Sym, *PElf64_Sym;

struct Elf64_Sym {
    dword st_name;
    byte st_info;
    byte st_other;
    word st_shndx;
    qword st_value;
    qword st_size;
};




void _DT_INIT(void)

{
  if (true) {
    __gmon_start__();
  }
  return;
}



/* void FUN_00104020(void)

{
  (*(code *)(undefined *)0x0)()();
  return;
} */



/* void __cxa_finalize(void)

{
  __cxa_finalize();
  return;
}
 */ // TODO: error: too many arguments to function ‘__cxa_finalize’


// WARNING: Unknown calling convention -- yet parameter storage is locked

/* __int32_t ** __ctype_toupper_loc(void)

{
  __int32_t **pp_Var1;
  
  pp_Var1 = __ctype_toupper_loc();
  return pp_Var1;
}
 */ // TODO: error: conflicting types for ‘__ctype_toupper_loc’


// WARNING: Unknown calling convention -- yet parameter storage is locked

/* char * getenv(char *__name)

{
  char *pcVar1;
  
  pcVar1 = getenv(__name);
  return pcVar1;
} */ //TODO:error: conflicting types for ‘getenv’.



/* void __snprintf_chk(void)

{
  __snprintf_chk();
  return;
}
 */ //TODO: error: too many arguments to function ‘__snprintf_chk’ //  note: declared here


// WARNING: Unknown calling convention -- yet parameter storage is locked

/* void free(void *__ptr)

{
  free(__ptr);
  return;
}
 */


/* void __vfprintf_chk(void)

{
  __vfprintf_chk();
  return;
} */



// WARNING: Unknown calling convention -- yet parameter storage is locked

/* void abort(void)

{
                    // WARNING: Subroutine does not return
  abort();
}
 */


// WARNING: Unknown calling convention -- yet parameter storage is locked

int * __errno_location(void)

{
  int *piVar1;
  
  piVar1 = __errno_location();
  return piVar1;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

int unlink(char *__name)

{
  int iVar1;
  
  iVar1 = unlink(__name);
  return iVar1;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

int strncmp(char *__s1,char *__s2,size_t __n)

{
  int iVar1;
  
  iVar1 = strncmp(__s1,__s2,__n);
  return iVar1;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

tm * localtime_r(time_t *__timer,tm *__tp)

{
  tm *ptVar1;
  
  ptVar1 = localtime_r(__timer,__tp);
  return ptVar1;
}



void inflate(void)

{
  inflate();
  return;
}



/* void __read_chk(void)

{
  __read_chk();
  return;
} */



// WARNING: Unknown calling convention -- yet parameter storage is locked

/* int puts(char *__s)

{
  int iVar1;
  
  iVar1 = puts(__s);
  return iVar1;
} */ // TODO:  note: previous declaration of ‘puts’



// WARNING: Unknown calling convention -- yet parameter storage is locked

/* void qsort(void *__base,size_t __nmemb,size_t __size,__compar_fn_t __compar)

{
  qsort(__base,__nmemb,__size,__compar);
  return;
}
 */ //TODO: error: conflicting types for ‘qsort’. //TODO:  note: previous declaration of ‘qsort’ was here.


// WARNING: Unknown calling convention -- yet parameter storage is locked

/* double strtod(char *__nptr,char **__endptr)

{
  double dVar1;
  
  dVar1 = strtod(__nptr,__endptr);
  return dVar1;
} */ //TODO: error: conflicting types for ‘strtod’.



// WARNING: Unknown calling convention -- yet parameter storage is locked

ssize_t readlink(char *__path,char *__buf,size_t __len)

{
  ssize_t sVar1;
  
  sVar1 = readlink(__path,__buf,__len);
  return sVar1;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

int fcntl(int __fd,int __cmd,...)

{
  int iVar1;
  
  iVar1 = fcntl(__fd,__cmd);
  return iVar1;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

ssize_t write(int __fd,void *__buf,size_t __n)

{
  ssize_t sVar1;
  
  sVar1 = write(__fd,__buf,__n);
  return sVar1;
}



/* void __open_2(void)

{
  __open_2();
  return;
}
 */


// WARNING: Unknown calling convention -- yet parameter storage is locked

/* int fclose(FILE *__stream)

{
  int iVar1;
  
  iVar1 = fclose(__stream);
  return iVar1;
} */ //TODO:  error: conflicting types for ‘fclose’



// WARNING: Unknown calling convention -- yet parameter storage is locked

DIR * opendir(char *__name)

{
  DIR *pDVar1;
  
  pDVar1 = opendir(__name);
  return pDVar1;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

void regfree(regex_t *__preg)

{
  regfree(__preg);
  return;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

size_t strlen(char *__s)

{
  size_t sVar1;
  
  sVar1 = strlen(__s);
  return sVar1;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked
/* 
int __lxstat(int __ver,char *__filename,stat *__stat_buf)

{
  int iVar1;
  
  iVar1 = __lxstat(__ver,__filename,__stat_buf);
  return iVar1;
} */



undefined8 magic_file(long param_1,undefined8 param_2)

{
  undefined8 uVar1;
  
  if (param_1 == 0) {
    return 0;
  }
  uVar1 = FUN_00104f30(param_1,param_2,0);
  return uVar1;
}



/* void __stack_chk_fail(void)

{
                    // WARNING: Subroutine does not return
  __stack_chk_fail();
} */



// WARNING: Unknown calling convention -- yet parameter storage is locked

void * mmap(void *__addr,size_t __len,int __prot,int __flags,int __fd,__off_t __offset)

{
  void *pvVar1;
  
  pvVar1 = mmap(__addr,__len,__prot,__flags,__fd,__offset);
  return pvVar1;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

void freelocale(__locale_t __dataset)

{
  freelocale(__dataset);
  return;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

size_t mbrtowc(wchar_t *__pwc,char *__s,size_t __n,mbstate_t *__p)

{
  size_t sVar1;
  
  sVar1 = mbrtowc(__pwc,__s,__n,__p);
  return sVar1;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

int dup2(int __fd,int __fd2)

{
  int iVar1;
  
  iVar1 = dup2(__fd,__fd2);
  return iVar1;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

/* char * strchr(char *__s,int __c)

{
  char *pcVar1;
  
  pcVar1 = strchr(__s,__c);
  return pcVar1;
}



void zError(void)

{
  zError();
  return;
}



void __fdelt_chk(void)

{
  __fdelt_chk();
  return;
} */



// WARNING: Unknown calling convention -- yet parameter storage is locked

/* __locale_t newlocale(int __category_mask,char *__locale,__locale_t __base)

{
  __locale_t p_Var1;
  
  p_Var1 = newlocale(__category_mask,__locale,__base);
  return p_Var1;
}
 */


// WARNING: Unknown calling convention -- yet parameter storage is locked

/* int snprintf(char *__s,size_t __maxlen,char *__format,...)

{
  int iVar1;
  
  iVar1 = snprintf(__s,__maxlen,__format);
  return iVar1;
}
 */


// WARNING: Unknown calling convention -- yet parameter storage is locked

/* char * strrchr(char *__s,int __c)

{
  char *pcVar1;
  
  pcVar1 = strrchr(__s,__c);
  return pcVar1;
}
 */


// WARNING: Unknown calling convention -- yet parameter storage is locked

/* tm * gmtime_r(time_t *__timer,tm *__tp)

{
  tm *ptVar1;
  
  ptVar1 = gmtime_r(__timer,__tp);
  return ptVar1;
} */



// WARNING: Unknown calling convention -- yet parameter storage is locked

/* __off_t lseek(int __fd,__off_t __offset,int __whence)

{
  __off_t _Var1;
  
  _Var1 = lseek(__fd,__offset,__whence);
  return _Var1;
} */



// WARNING: Unknown calling convention -- yet parameter storage is locked

/* void __assert_fail(char *__assertion,char *__file,uint __line,char *__function)

{
                    // WARNING: Subroutine does not return
  __assert_fail(__assertion,__file,__line,__function);
} */



// WARNING: Unknown calling convention -- yet parameter storage is locked

/* float strtof(char *__nptr,char **__endptr)

{
  float fVar1;
  
  fVar1 = strtof(__nptr,__endptr);
  return fVar1;
} */



// WARNING: Unknown calling convention -- yet parameter storage is locked

/* void * memset(void *__s,int __c,size_t __n)

{
  void *pvVar1;
  
  pvVar1 = memset(__s,__c,__n);
  return pvVar1;
}
 */


// WARNING: Unknown calling convention -- yet parameter storage is locked

/* int ioctl(int __fd,ulong __request,...)

{
  int iVar1;
  
  iVar1 = ioctl(__fd,__request);
  return iVar1;
} */



// WARNING: Unknown calling convention -- yet parameter storage is locked

/* int close(int __fd)

{
  int iVar1;
  
  iVar1 = close(__fd);
  return iVar1;
} */



// WARNING: Unknown calling convention -- yet parameter storage is locked

/* int pipe(int *__pipedes)

{
  int iVar1;
  
  iVar1 = pipe(__pipedes);
  return iVar1;
} */



// WARNING: Unknown calling convention -- yet parameter storage is locked

/* int closedir(DIR *__dirp)

{
  int iVar1;
  
  iVar1 = closedir(__dirp);
  return iVar1;
} */



// WARNING: Unknown calling convention -- yet parameter storage is locked

/* int regcomp(regex_t *__preg,char *__pattern,int __cflags)

{
  int iVar1;
  
  iVar1 = regcomp(__preg,__pattern,__cflags);
  return iVar1;
}
 */


// WARNING: Unknown calling convention -- yet parameter storage is locked

/* int fputc(int __c,FILE *__stream)

{
  int iVar1;
  
  iVar1 = fputc(__c,__stream);
  return iVar1;
} */



// WARNING: Unknown calling convention -- yet parameter storage is locked

/* size_t strcspn(char *__s,char *__reject)

{
  size_t sVar1;
  
  sVar1 = strcspn(__s,__reject);
  return sVar1;
}
 */


// WARNING: Unknown calling convention -- yet parameter storage is locked

/* void * memchr(void *__s,int __c,size_t __n)

{
  void *pvVar1;
  
  pvVar1 = memchr(__s,__c,__n);
  return pvVar1;
} */



// WARNING: Unknown calling convention -- yet parameter storage is locked

/* ssize_t read(int __fd,void *__buf,size_t __nbytes)

{
  ssize_t sVar1;
  
  sVar1 = read(__fd,__buf,__nbytes);
  return sVar1;
} */



// WARNING: Unknown calling convention -- yet parameter storage is locked

/* char * strndup(char *__string,size_t __n)

{
  char *pcVar1;
  
  pcVar1 = strndup(__string,__n);
  return pcVar1;
}
 */


// WARNING: Unknown calling convention -- yet parameter storage is locked

/* int memcmp(void *__s1,void *__s2,size_t __n)

{
  int iVar1;
  
  iVar1 = memcmp(__s1,__s2,__n);
  return iVar1;
} */



// WARNING: Unknown calling convention -- yet parameter storage is locked

/* ulonglong strtoull(char *__nptr,char **__endptr,int __base)

{
  ulonglong uVar1;
  
  uVar1 = strtoull(__nptr,__endptr,__base);
  return uVar1;
}
 */


/* void __asprintf_chk(void)

{
  __asprintf_chk();
  return;
} */



// WARNING: Unknown calling convention -- yet parameter storage is locked

/* int utimes(char *__file,timeval *__tvp)

{
  int iVar1;
  
  iVar1 = utimes(__file,__tvp);
  return iVar1;
}

 */

// WARNING: Unknown calling convention -- yet parameter storage is locked

/* void * calloc(size_t __nmemb,size_t __size)

{
  void *pvVar1;
  
  pvVar1 = calloc(__nmemb,__size);
  return pvVar1;
}
 */


// WARNING: Unknown calling convention -- yet parameter storage is locked
// This kind of comment indicates the presence of the "error: conflicting types for ‘__getdelim’" error.

/* __ssize_t __getdelim(char **__lineptr,size_t *__n,int __delimiter,FILE *__stream)

{
  __ssize_t _Var1;
  
  _Var1 = __getdelim(__lineptr,__n,__delimiter,__stream);
  return _Var1;
} */



// WARNING: Unknown calling convention -- yet parameter storage is locked

/* int strcmp(char *__s1,char *__s2)

{
  int iVar1;
  
  iVar1 = strcmp(__s1,__s2);
  return iVar1;
}
 */


// WARNING: Unknown calling convention -- yet parameter storage is locked

/* __sighandler_t signal(int __sig,__sighandler_t __handler)

{
  __sighandler_t p_Var1;
  
  p_Var1 = signal(__sig,__handler);
  return p_Var1;
} */


/* 
void __memcpy_chk(void)

{
  __memcpy_chk();
  return;
} */



// WARNING: Unknown calling convention -- yet parameter storage is locked

/* long strtol(char *__nptr,char **__endptr,int __base)

{
  long lVar1;
  
  lVar1 = strtol(__nptr,__endptr,__base);
  return lVar1;
} */



// WARNING: Unknown calling convention -- yet parameter storage is locked

/* void * memcpy(void *__dest,void *__src,size_t __n)

{
  void *pvVar1;
  
  pvVar1 = memcpy(__dest,__src,__n);
  return pvVar1;
} */



// WARNING: Unknown calling convention -- yet parameter storage is locked

/* size_t regerror(int __errcode,regex_t *__preg,char *__errbuf,size_t __errbuf_size)

{
  size_t sVar1;
  
  sVar1 = regerror(__errcode,__preg,__errbuf,__errbuf_size);
  return sVar1;
} */


/* 
void inflateEnd(void)

{
  inflateEnd();
  return;
}
 */


/* undefined8 magic_setflags(long param_1,undefined4 param_2)

{
  if (param_1 == 0) {
    return 0xffffffff;
  }
  *(undefined4 *)(param_1 + 0x38) = param_2;
  return 0;
} */



// WARNING: Unknown calling convention -- yet parameter storage is locked

/* int select(int __nfds,fd_set *__readfds,fd_set *__writefds,fd_set *__exceptfds,timeval *__timeout)

{
  int iVar1;
  
  iVar1 = select(__nfds,__readfds,__writefds,__exceptfds,__timeout);
  return iVar1;
} */



// WARNING: Unknown calling convention -- yet parameter storage is locked

/* int __xstat(int __ver,char *__filename,stat *__stat_buf)

{
  int iVar1;
  
  iVar1 = __xstat(__ver,__filename,__stat_buf);
  return iVar1;
} */



// WARNING: Unknown calling convention -- yet parameter storage is locked

/* dirent * readdir(DIR *__dirp)

{
  dirent *pdVar1;
  
  pdVar1 = readdir(__dirp);
  return pdVar1;
} */



// WARNING: Unknown calling convention -- yet parameter storage is locked

/* __locale_t uselocale(__locale_t __dataset)

{
  __locale_t p_Var1;
  
  p_Var1 = uselocale(__dataset);
  return p_Var1;
} */



// WARNING: Unknown calling convention -- yet parameter storage is locked

/* void * malloc(size_t __size)

{
  void *pvVar1;
  
  pvVar1 = malloc(__size);
  return pvVar1;
}
 */


// WARNING: Unknown calling convention -- yet parameter storage is locked

/* int fflush(FILE *__stream)

{
  int iVar1;
  
  iVar1 = fflush(__stream);
  return iVar1;
}
 */


// WARNING: Unknown calling convention -- yet parameter storage is locked

/* char * ctime_r(time_t *__timer,char *__buf)

{
  char *pcVar1;
  
  pcVar1 = ctime_r(__timer,__buf);
  return pcVar1;
} */



/* void __vasprintf_chk(void)

{
  __vasprintf_chk();
  return;
} */ //TODO: The ones that has the __*_chk thing added indicates: "note: declared here" 



// WARNING: Unknown calling convention -- yet parameter storage is locked

/* int __fxstat(int __ver,int __fildes,stat *__stat_buf)

{
  int iVar1;
  
  iVar1 = __fxstat(__ver,__fildes,__stat_buf);
  return iVar1;
} */



// WARNING: Unknown calling convention -- yet parameter storage is locked

/* int regexec(regex_t *__preg,char *__string,size_t __nmatch,regmatch_t *__pmatch,int __eflags)

{
  int iVar1;
  
  iVar1 = regexec(__preg,__string,__nmatch,__pmatch,__eflags);
  return iVar1;
} */



// WARNING: Unknown calling convention -- yet parameter storage is locked

/* time_t mktime(tm *__tp)

{
  time_t tVar1;
  
  tVar1 = mktime(__tp);
  return tVar1;
} */



// WARNING: Unknown calling convention -- yet parameter storage is locked

/* int mkstemp(char *__template)

{
  int iVar1;
  
  iVar1 = mkstemp(__template);
  return iVar1;
} */



// WARNING: Unknown calling convention -- yet parameter storage is locked

/* void * realloc(void *__ptr,size_t __size)

{
  void *pvVar1;
  
  pvVar1 = realloc(__ptr,__size);
  return pvVar1;
} */



char * magic_getpath(char *param_1,int param_2)

{
  int iVar1;
  char *pcVar2;
  long in_FS_OFFSET;
  char *pcStack_d0;
  struct stat sStack_c8;
  long lStack_30;
  
  lStack_30 = *(long *)(in_FS_OFFSET + 0x28);
  if (((param_1 != (char *)0x0) || (param_1 = getenv("MAGIC"), param_1 != (char *)0x0)) ||
     (param_1 = "/usr/local/share/misc/magic", param_2 != 0)) goto LAB_001054ac;
  if (DAT_001244e8 != (char *)0x0) {
    free(DAT_001244e8);
    DAT_001244e8 = (char *)0x0;
  }
  pcVar2 = getenv("HOME");
  if (pcVar2 != (char *)0x0) {
    iVar1 = __asprintf_chk(&pcStack_d0,1,"%s/.magic.mgc",pcVar2);
    if (-1 < iVar1) {
      iVar1 = __xstat(1,pcStack_d0,&sStack_c8);
      if (iVar1 == -1) {
        free(pcStack_d0);
        iVar1 = __asprintf_chk(&pcStack_d0,1,"%s/.magic",pcVar2);
        if (iVar1 < 0) goto LAB_00105668;
        iVar1 = __xstat(1,pcStack_d0,&sStack_c8);
        if (iVar1 != -1) {
          if ((sStack_c8.st_mode & 0xf000) == 0x4000) {
            free(pcStack_d0);
            iVar1 = __asprintf_chk(&pcStack_d0,1,"%s/%s",pcVar2,"/.magic/magic.mgc");
            if (iVar1 < 0) goto LAB_00105668;
            iVar1 = access(pcStack_d0,4);
            if (iVar1 == -1) goto LAB_0010564f;
          }
          goto LAB_00105571;
        }
      }
      else {
LAB_00105571:
        iVar1 = __asprintf_chk(&DAT_001244e8,1,"%s:%s",pcStack_d0,"/usr/local/share/misc/magic");
        if (-1 < iVar1) {
          free(pcStack_d0);
          param_1 = DAT_001244e8;
          goto LAB_001054ac;
        }
      }
LAB_0010564f:
      DAT_001244e8 = (char *)0x0;
      free(pcStack_d0);
    }
  }
LAB_00105668:
  param_1 = "/usr/local/share/misc/magic";
LAB_001054ac:
  if (lStack_30 != *(long *)(in_FS_OFFSET + 0x28)) {
                    // WARNING: Subroutine does not return
    __stack_chk_fail();
  }
  return param_1;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

int munmap(void *__addr,size_t __len)

{
  int iVar1;
  
  iVar1 = munmap(__addr,__len);
  return iVar1;
}



/* void __printf_chk(void)

{
  __printf_chk();
  return;
}
 */


// WARNING: Unknown calling convention -- yet parameter storage is locked

char * asctime_r(tm *__tp,char *__buf)

{
  char *pcVar1;
  
  pcVar1 = asctime_r(__tp,__buf);
  return pcVar1;
}



int inflateInit_(void)

{
  inflateInit_();
  return 0;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

void * memmove(void *__dest,void *__src,size_t __n)

{
  void *pvVar1;
  
  pvVar1 = memmove(__dest,__src,__n);
  return pvVar1;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

int mprotect(void *__addr,size_t __len,int __prot)

{
  int iVar1;
  
  iVar1 = mprotect(__addr,__len,__prot);
  return iVar1;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

int open(char *__file,int __oflag,...)

{
  int iVar1;
  
  iVar1 = open(__file,__oflag);
  return iVar1;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

int access(char *__name,int __type)

{
  int iVar1;
  
  iVar1 = access(__name,__type);
  return iVar1;
}



/* void __pread_chk(void)

{
  __pread_chk();
  return;
} */



// WARNING: Unknown calling convention -- yet parameter storage is locked

/* FILE * fopen(char *__filename,char *__modes)

{
  FILE *pFVar1;
  
  pFVar1 = fopen(__filename,__modes);
  return pFVar1;
}
 */


/* void inflateInit2_(void)

{
  inflateInit2_();
  return;
} */ // TODO: error: too many arguments to function ‘inflateInit2_’ //note: declared here



// WARNING: Unknown calling convention -- yet parameter storage is locked

/* char * strcasestr(char *__haystack,char *__needle)

{
  char *pcVar1;
  
  pcVar1 = strcasestr(__haystack,__needle);
  return pcVar1;
}
 */


/* void __dprintf_chk(void)

{
  __dprintf_chk();
  return;
}
 */


// WARNING: Unknown calling convention -- yet parameter storage is locked

/* ulong strtoul(char *__nptr,char **__endptr,int __base)

{
  ulong uVar1;
  
  uVar1 = strtoul(__nptr,__endptr,__base);
  return uVar1;
}
 */


// WARNING: Unknown calling convention -- yet parameter storage is locked

/* int execvp(char *__file,char **__argv)

{
  int iVar1;
  
  iVar1 = execvp(__file,__argv);
  return iVar1;
} */



// WARNING: Unknown calling convention -- yet parameter storage is locked

/* ssize_t pread(int __fd,void *__buf,size_t __nbytes,__off_t __offset)

{
  ssize_t sVar1;
  
  sVar1 = pread(__fd,__buf,__nbytes,__offset);
  return sVar1;
}
 */


// WARNING: Unknown calling convention -- yet parameter storage is locked

/* void exit(int __status)

{
                    // WARNING: Subroutine does not return
  exit(__status);
} */



// WARNING: Unknown calling convention -- yet parameter storage is locked

/* size_t fwrite(void *__ptr,size_t __size,size_t __n,FILE *__s)

{
  size_t sVar1;
  
  sVar1 = fwrite(__ptr,__size,__n,__s);
  return sVar1;
} */



/* void __fprintf_chk(void)

{
  __fprintf_chk();
  return;
}
 */ // TODO: note: declared here
// 1761 | void __fprintf_chk(void)


// WARNING: Unknown calling convention -- yet parameter storage is locked

char * strdup(char *__s)

{
  char *pcVar1;
  
  pcVar1 = strdup(__s);
  return pcVar1;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

char * strerror(int __errnum)

{
  char *pcVar1;
  
  pcVar1 = strerror(__errnum);
  return pcVar1;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

int iswprint(wint_t __wc)

{
  int iVar1;
  
  iVar1 = iswprint(__wc);
  return iVar1;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

__pid_t wait(void *__stat_loc)

{
  __pid_t _Var1;
  
  _Var1 = wait(__stat_loc);
  return _Var1;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

__pid_t fork(void)

{
  __pid_t _Var1;
  
  _Var1 = fork();
  return _Var1;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

char * strstr(char *__haystack,char *__needle)

{
  char *pcVar1;
  
  pcVar1 = strstr(__haystack,__needle);
  return pcVar1;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

/* __int32_t ** __ctype_tolower_loc(void)

{
  __int32_t **pp_Var1;
  
  pp_Var1 = __ctype_tolower_loc();
  return pp_Var1;
} */



int FUN_00104d70(void)

{
  __ctype_b_loc();
  return 0;
}



void entry(void)

{
                    // WARNING: Subroutine does not return
  abort();
} // TODO: fix "recompilable.c:2007:19: error: expected ‘=’, ‘,’, ‘;’, ‘asm’ or ‘__attribute__’ before ‘entry’" // TODO: Fix it by  remove the name before.



/* // WARNING: Unknown calling convention -- yet parameter storage is locked

void abort(void)

{
                    // WARNING: Subroutine does not return
  abort();
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

void abort(void)

{
                    // WARNING: Subroutine does not return
  abort();
} */



void FUN_00104d8f(void)

{
                    // WARNING: Subroutine does not return
  abort();
}



void abort_caseD_0(void)

{
                    // WARNING: Subroutine does not return
  abort();
}



void FUN_00104d99(void)

{
                    // WARNING: Subroutine does not return
  abort();
}



/* // WARNING: Unknown calling convention -- yet parameter storage is locked

void abort(void)

{
                    // WARNING: Subroutine does not return
  abort();
}
 */


void FUN_00104db0(void)

{
  if ((false) && (true)) {
    _ITM_deregisterTMCloneTable();
    return;
  }
  return;
}



void FUN_00104de0(void)

{
  if ((false) && (true)) {
    _ITM_registerTMCloneTable();
    return;
  }
  return;
}



void _FINI_0(void)

{
  if (DAT_001244e0 == '\0') {
    if (true) {
      __cxa_finalize(PTR_LOOP_00124380);
    }
    FUN_00104db0();
    DAT_001244e0 = 1;
    return;
  }
  return;
}



void _INIT_0(void)

{
  FUN_00104de0();
  return;
}



int FUN_00104e70(undefined8 param_1,uint param_2,char *param_3)

{
  int iVar1;
  
  if (((param_3 == (char *)0x0) ||
      (((iVar1 = access(param_3,2), iVar1 != 0 ||
        (iVar1 = FUN_00114fd0(param_1,"writable, ", ""), iVar1 != -1)) &&
       ((iVar1 = access(param_3,1), iVar1 != 0 ||
        (iVar1 = FUN_00114fd0(param_1,"executable, "), iVar1 != -1)))))) &&
     (((param_2 & 0xf000) != 0x8000 || (iVar1 = FUN_00114fd0(param_1,"regular file, ", ""), iVar1 != -1)
      ))) {
    iVar1 = FUN_00114fd0(param_1,"no read permission", "");
    iVar1 = -(uint)(iVar1 == -1);
  }
  else {
    iVar1 = -1;
  }
  return iVar1;
}



undefined8 FUN_00104f30(long param_1,char *param_2,int param_3)

{
  int iVar1;
  int iVar2;
  uint uVar3;
  void *__ptr;
  undefined8 uVar4;
  long lVar5;
  long lVar6;
  int *piVar7;
  ssize_t sVar8;
  ulong uVar9;
  char *pcVar10;
  size_t __nbytes;
  undefined8 *puVar11;
  undefined4 uVar12;
  __off_t __offset;
  long in_FS_OFFSET;
  bool bVar13;
  byte bVar14;
  int *local_108;
  undefined local_f8 [24];
  undefined8 local_e0;
  struct stat local_d8;
  long local_40;
  
  bVar14 = 0;
  local_40 = *(long *)(in_FS_OFFSET + 0x28);
  iVar1 = FUN_001157e0(0x02);
  if ((iVar1 == -1) || (__ptr = malloc(*(long *)(param_1 + 0xe0) + 0x61), __ptr == (void *)0x0))
  goto LAB_00105010;
  iVar1 = FUN_001145b0(param_1,param_2,&local_d8);
  if (iVar1 == -1) {
    free(__ptr);
    if ((1 < param_3 + 1U) && (param_2 != (char *)0x0)) {
LAB_00104ff7:
      iVar1 = -1;
      close(param_3);
      if ((*(byte *)(param_1 + 0x38) & 0x80) != 0) {
LAB_001051c0:
        *(undefined8 *)(local_f8 + 0) = local_d8.st_atim.tv_sec;
        local_e0 = 0;
        *(undefined8 *)(local_f8 + 16) = 0;
        *(undefined8 *)(local_f8 + 8)= local_d8.st_mtim.tv_sec;
        *(undefined8 *)(local_f8 + 8) = *(undefined8 *)(local_f8 + 8) << 0x40;
        utimes(param_2,(timeval *)local_f8);
LAB_001051f6:
        if (iVar1 == 0) goto LAB_00104fd4;
      }
    }
LAB_00105010:
    uVar4 = 0;
  }
  else {
    if (iVar1 == 0) {
      iVar1 = 0;
      if (param_2 == (char *)0x0) {
        iVar2 = __fxstat(1,param_3,&local_d8);
        if ((iVar2 == 0) && ((local_d8.st_mode & 0xf000) == 0x1000)) {
          __nbytes = *(size_t *)(param_1 + 0xe0);
LAB_0010526d:
          lVar5 = 0;
          while( true ) {
            puVar11 = (undefined8 *)((long)__ptr + lVar5);
            lVar6 = FUN_0010eeb0(param_3,puVar11,__nbytes - lVar5,1);
            if (lVar6 < 1) break;
            lVar5 = lVar5 + lVar6;
            if (lVar6 < 0x1000) {
              puVar11 = (undefined8 *)((long)__ptr + lVar5);
              __offset = -1;
              goto LAB_0010513a;
            }
            __nbytes = *(size_t *)(param_1 + 0xe0);
          }
          if ((lVar5 != 0) || (param_2 == (char *)0x0)) {
            __offset = -1;
LAB_0010513a:
            *puVar11 = 0;
            *(undefined8 *)((long)puVar11 + 0x59) = 0;
            uVar9 = (ulong)(((int)puVar11 -
                            (int)(undefined8 *)((ulong)(puVar11 + 1) & 0xfffffffffffffff8)) + 0x61U
                           >> 3);
            puVar11 = (undefined8 *)((ulong)(puVar11 + 1) & 0xfffffffffffffff8);
            for (; uVar9 != 0; uVar9 = uVar9 - 1) {
              *puVar11 = 0;
              puVar11 = puVar11 + (ulong)bVar14 * -2 + 1;
            }
            iVar2 = FUN_001152a0(param_1,param_3,param_2,__ptr,lVar5);
            if (iVar2 == -1) {
LAB_001053a7:
              free(__ptr);
              if (param_3 == -1) goto LAB_00105010;
              goto LAB_00105354;
            }
            free(__ptr);
            if (param_3 == -1) goto LAB_00104fd4;
            goto LAB_0010518b;
          }
          iVar1 = FUN_00104e70(param_1,local_d8.st_mode,param_2);
          iVar1 = -(uint)(iVar1 == -1);
          free(__ptr);
          if (param_3 != -1) goto LAB_0010519e;
        }
        else {
          __offset = lseek(param_3,0,1);
          lVar5 = read(param_3,__ptr,*(size_t *)(param_1 + 0xe0));
          puVar11 = (undefined8 *)((long)__ptr + lVar5);
          if (lVar5 != -1) goto LAB_0010513a;
          piVar7 = __errno_location();
          pcVar10 = "/dev/stdin";
          iVar1 = *piVar7;
          if (param_3 != 0) {
            FUN_00114dc0(param_1,iVar1,"cannot read fd %d");
            goto LAB_001053a7;
          }
LAB_0010533b:
          FUN_00114dc0(param_1,iVar1,"cannot read `%s\'");
          free(__ptr);
LAB_00105354:
          iVar1 = -1;
LAB_0010518b:
          if (__offset != -1) {
            lseek(param_3,__offset,0);
          }
LAB_0010519e:
          if ((param_3 != 0) && (param_2 != (char *)0x0)) {
LAB_001051a8:
            close(param_3);
            if ((*(byte *)(param_1 + 0x38) & 0x80) != 0) goto LAB_001051c0;
          }
        }
        goto LAB_001051f6;
      }
      iVar2 = __xstat(1,param_2,&local_d8);
      if (iVar2 == 0) {
        bVar13 = (local_d8.st_mode & 0xf000) == 0x1000;
        uVar12 = 0x800;
        if (!bVar13) {
          uVar12 = 0;
        }
        local_108 = __errno_location();
        *local_108 = 0;
        param_3 = __open_2(param_2,uVar12);
        if (-1 < param_3) {
          uVar3 = fcntl(param_3,3);
          if (uVar3 != 0xffffffff) {
LAB_00105249:
            fcntl(param_3,4,(ulong)(uVar3 & 0xfffff7ff));
          }
          __nbytes = *(size_t *)(param_1 + 0xe0);
          if (bVar13) goto LAB_0010526d;
LAB_001053c7:
          sVar8 = read(param_3,__ptr,__nbytes);
          if (sVar8 == -1) {
            iVar1 = *local_108;
            __offset = -1;
            pcVar10 = param_2;
            goto LAB_0010533b;
          }
          puVar11 = (undefined8 *)((long)__ptr + sVar8);
          *puVar11 = 0;
          *(undefined8 *)((long)puVar11 + 0x59) = 0;
          uVar9 = (ulong)(((int)puVar11 -
                          (int)(undefined8 *)((ulong)(puVar11 + 1) & 0xfffffffffffffff8)) + 0x61U >>
                         3);
          puVar11 = (undefined8 *)((ulong)(puVar11 + 1) & 0xfffffffffffffff8);
          for (; uVar9 != 0; uVar9 = uVar9 - 1) {
            *puVar11 = 0;
            puVar11 = puVar11 + (ulong)bVar14 * -2 + 1;
          }
          iVar2 = FUN_001152a0(param_1,param_3,param_2,__ptr,sVar8);
          if (iVar2 == -1) {
            iVar1 = -1;
            free(__ptr);
            if (param_3 == 0) goto LAB_00105010;
          }
          else {
            free(__ptr);
            if (param_3 == 0) goto LAB_00104fd4;
          }
          goto LAB_001051a8;
        }
        iVar1 = FUN_00104e70(param_1,local_d8.st_mode,param_2);
        if (iVar1 == -1) {
          free(__ptr);
          if (param_3 != -1) goto LAB_00104ff7;
          goto LAB_00105010;
        }
      }
      else {
        local_108 = __errno_location();
        *local_108 = 0;
        param_3 = __open_2(param_2,0);
        if (-1 < param_3) {
          uVar3 = fcntl(param_3,3);
          if (uVar3 != 0xffffffff) {
            bVar13 = false;
            goto LAB_00105249;
          }
          __nbytes = *(size_t *)(param_1 + 0xe0);
          goto LAB_001053c7;
        }
      }
      free(__ptr);
      if (param_3 != -1) goto LAB_00104fc0;
    }
    else {
      free(__ptr);
      if ((1 < param_3 + 1U) && (param_2 != (char *)0x0)) {
LAB_00104fc0:
        iVar1 = 0;
        close(param_3);
        if ((*(byte *)(param_1 + 0x38) & 0x80) != 0) goto LAB_001051c0;
      }
    }
LAB_00104fd4:
    uVar4 = FUN_00115840(param_1);
  }
  if (local_40 != *(long *)(in_FS_OFFSET + 0x28)) {
                    // WARNING: Subroutine does not return
    __stack_chk_fail();
  }
  return uVar4;
}



/* char * magic_getpath(char *param_1,int param_2)

{
  int iVar1;
  char *pcVar2;
  long in_FS_OFFSET;
  char *local_d0;
  stat local_c8;
  long local_30;
  
  local_30 = *(long *)(in_FS_OFFSET + 0x28);
  if (((param_1 != (char *)0x0) || (param_1 = getenv("MAGIC"), param_1 != (char *)0x0)) ||
     (param_1 = "/usr/local/share/misc/magic", param_2 != 0)) goto LAB_001054ac;
  if (DAT_001244e8 != (char *)0x0) {
    free(DAT_001244e8);
    DAT_001244e8 = (char *)0x0;
  }
  pcVar2 = getenv("HOME");
  if (pcVar2 != (char *)0x0) {
    iVar1 = __asprintf_chk(&local_d0,1,"%s/.magic.mgc",pcVar2);
    if (-1 < iVar1) {
      iVar1 = __xstat(1,local_d0,&local_c8);
      if (iVar1 == -1) {
        free(local_d0);
        iVar1 = __asprintf_chk(&local_d0,1,"%s/.magic",pcVar2);
        if (iVar1 < 0) goto LAB_00105668;
        iVar1 = __xstat(1,local_d0,&local_c8);
        if (iVar1 != -1) {
          if ((local_c8.st_mode & 0xf000) == 0x4000) {
            free(local_d0);
            iVar1 = __asprintf_chk(&local_d0,1,"%s/%s",pcVar2,"/.magic/magic.mgc");
            if (iVar1 < 0) goto LAB_00105668;
            iVar1 = access(local_d0,4);
            if (iVar1 == -1) goto LAB_0010564f;
          }
          goto LAB_00105571;
        }
      }
      else {
LAB_00105571:
        iVar1 = __asprintf_chk(&DAT_001244e8,1,"%s:%s",local_d0,"/usr/local/share/misc/magic");
        if (-1 < iVar1) {
          free(local_d0);
          param_1 = DAT_001244e8;
          goto LAB_001054ac;
        }
      }
LAB_0010564f:
      DAT_001244e8 = (char *)0x0;
      free(local_d0);
    }
  }
LAB_00105668:
  param_1 = "/usr/local/share/misc/magic";
LAB_001054ac:
  if (local_30 != *(long *)(in_FS_OFFSET + 0x28)) {
                    // WARNING: Subroutine does not return
    __stack_chk_fail();
  }
  return param_1;
}

 */

void magic_open(void)

{
  FUN_00107030(0x000000);
  return;
}



void magic_close(long param_1)

{
  if (param_1 != 0) {
    FUN_00106fe0();
    return;
  }
  return;
}



undefined8 magic_load(long param_1,undefined8 param_2)

{
  undefined8 uVar1;
  
  if (param_1 != 0) {
    uVar1 = FUN_00109b50(param_1,param_2,0);
    return uVar1;
  }
  return 0xffffffff;
}



undefined8 magic_load_buffers(long param_1)

{
  undefined8 uVar1;
  
  if (param_1 != 0) {
    uVar1 = FUN_00107140(0x00 ,0x00 ,0x00, 0xffffffff);
    return uVar1;
  }
  return 0xffffffff;
}



undefined8 magic_compile(long param_1,undefined8 param_2)

{
  undefined8 uVar1;
  
  if (param_1 != 0) {
    uVar1 = FUN_00109b50(param_1,param_2,2);
    return uVar1;
  }
  return 0xffffffff;
}



undefined8 magic_check(long param_1,undefined8 param_2)

{
  undefined8 uVar1;
  
  if (param_1 != 0) {
    uVar1 = FUN_00109b50(param_1,param_2,1);
    return uVar1;
  }
  return 0xffffffff;
}



undefined8 magic_list(long param_1,undefined8 param_2)

{
  undefined8 uVar1;
  
  if (param_1 != 0) {
    uVar1 = FUN_00109b50(param_1,param_2,3);
    return uVar1;
  }
  return 0xffffffff;
}



undefined8 magic_descriptor(long param_1,undefined4 param_2)

{
  undefined8 uVar1;
  
  if (param_1 != 0) {
    uVar1 = FUN_00104f30(param_1,0,param_2);
    return uVar1;
  }
  return 0;
}



/* undefined8 magic_file(long param_1,undefined8 param_2)

{
  undefined8 uVar1;
  
  if (param_1 != 0) {
    uVar1 = FUN_00104f30(param_1,param_2,0);
    return uVar1;
  }
  return 0;
} */



undefined8 magic_buffer(long param_1,undefined8 param_2,undefined8 param_3)

{
  int iVar1;
  undefined8 uVar2;
  
  if (param_1 == 0) {
    return 0;
  }
  iVar1 = FUN_001157e0(0x02);
  if (iVar1 != -1) {
    iVar1 = FUN_001152a0(param_1,0xffffffff,0,param_2,param_3);
    if (iVar1 != -1) {
      uVar2 = FUN_00115840(param_1);
      return uVar2;
    }
  }
  return 0;
}



char * magic_error(long param_1)

{
  char *pcVar1;
  
  pcVar1 = "Magic database is not open";
  if ((param_1 != 0) && (pcVar1 = (char *)0x0, (*(byte *)(param_1 + 0x3c) & 1) != 0)) {
    pcVar1 = *(char **)(param_1 + 0x20);
  }
  return pcVar1;
}



uint magic_errno(long param_1)

{
  uint uVar1;
  
  if (param_1 == 0) {
    uVar1 = 0x16;
  }
  else {
    uVar1 = *(uint *)(param_1 + 0x3c) & 1;
    if (uVar1 != 0) {
      return *(uint *)(param_1 + 0x34);
    }
  }
  return uVar1;
}



undefined8 magic_setflags(long param_1,undefined4 param_2)

{
  if (param_1 != 0) {
    *(undefined4 *)(param_1 + 0x38) = param_2;
    return 0;
  }
  return 0xffffffff;
}



undefined8 magic_version(void)

{
  return 0x210;
}



undefined4 magic_setparam(long param_1,undefined4 param_2,undefined8 *param_3)

{
  int *piVar1;
  
  switch(param_2) {
  case 0:
    *(short *)(param_1 + 0xd0) = (short)*param_3;
    return param_2;
  case 1:
    *(short *)(param_1 + 0xd2) = (short)*param_3;
    return 0;
  case 2:
    *(short *)(param_1 + 0xd6) = (short)*param_3;
    return 0;
  case 3:
    *(short *)(param_1 + 0xd4) = (short)*param_3;
    return 0;
  case 4:
  case 5:
    *(short *)(param_1 + 0xd8) = (short)*param_3;
    return 0;
  case 6:
    *(undefined8 *)(param_1 + 0xe0) = *param_3;
    return 0;
  default:
    piVar1 = __errno_location();
    *piVar1 = 0x16;
    return 0xffffffff;
  }
}



undefined4 magic_getparam(long param_1,undefined4 param_2,ulong *param_3)

{
  int *piVar1;
  
  switch(param_2) {
  case 0:
    *param_3 = (ulong)*(ushort *)(param_1 + 0xd0);
    return param_2;
  case 1:
    *param_3 = (ulong)*(ushort *)(param_1 + 0xd2);
    return 0;
  case 2:
    *param_3 = (ulong)*(ushort *)(param_1 + 0xd6);
    return 0;
  case 3:
    *param_3 = (ulong)*(ushort *)(param_1 + 0xd4);
    return 0;
  case 4:
    *param_3 = (ulong)*(ushort *)(param_1 + 0xd8);
    return 0;
  case 5:
    *param_3 = (ulong)*(ushort *)(param_1 + 0xda);
    return 0;
  case 6:
    *param_3 = *(ulong *)(param_1 + 0xe0);
    return 0;
  default:
    piVar1 = __errno_location();
    *piVar1 = 0x16;
    return 0xffffffff;
  }
}



int FUN_001059c0(char param_1)

{
  int iVar1;
  
  if (param_1 < '0') {
    iVar1 = -1;
    if ('$' < param_1) {
      if (true) {
        switch(param_1) {
        case '%':
          return 7;
        case '&':
          return 0;
        case '*':
          return 5;
        case '+':
          return 3;
        case '-':
          return 4;
        case '/':
          return 6;
        }
      }
      return -1;
    }
  }
  else {
    iVar1 = 2;
    if (param_1 != '^') {
      return ((param_1 == '|') - 1) + (uint)(param_1 == '|');
    }
  }
  return iVar1;
}



void FUN_00105a40(undefined8 *param_1)

{
  int iVar1;
  void *pvVar2;
  void *__ptr;
  
  if (param_1 == (undefined8 *)0x0) {
    return;
  }
  iVar1 = *(int *)(param_1 + 2);
  if (iVar1 != 1) {
    if (iVar1 == 2) {
      if ((long)*param_1 - 1U < 0xfffffffffffffffe) {
        munmap((void *)*param_1,param_1[1]);
      }
    }
    else if (iVar1 != 0) {
      entry();
      return;
    }
    free(param_1);
    return;
  }
  pvVar2 = (void *)param_1[3];
  __ptr = (void *)*param_1;
  if ((pvVar2 < __ptr) || ((void *)(param_1[1] + (long)__ptr) < pvVar2)) {
    free(pvVar2);
    __ptr = (void *)*param_1;
  }
  pvVar2 = (void *)param_1[4];
  if ((pvVar2 < __ptr) || ((void *)(param_1[1] + (long)__ptr) < pvVar2)) {
    free(pvVar2);
    __ptr = (void *)*param_1;
  }
  free(__ptr);
  free(param_1);
  return;
}



void FUN_00105af0(void *param_1)

{
  void *pvVar1;
  void *__ptr;
  bool bVar2;
  
  if (param_1 == (void *)0x0) {
    return;
  }
  __ptr = *(void **)((long)param_1 + 0x18);
  do {
    pvVar1 = *(void **)((long)__ptr + 0x18);
    if (pvVar1 == (void *)0x0) {
      return;
    }
    if (*(long *)((long)__ptr + 0x10) != 0) {
      FUN_00105a40(0x00);
    }
    free(__ptr);
    bVar2 = __ptr != param_1;
    __ptr = pvVar1;
  } while (bVar2);
  return;
}



undefined8 FUN_00105b40(long param_1,long param_2,long param_3)

{
  undefined8 *puVar1;
  undefined8 uVar2;
  long lVar3;
  
  *(undefined8 *)(param_1 + 0x10) = 0;
  puVar1 = (undefined8 *)malloc(0x28);
  if (puVar1 == (undefined8 *)0x0) {
    uVar2 = 0xffffffff;
  }
  else {
    lVar3 = 0;
    if (param_3 == 0) {
      lVar3 = param_2;
    }
    puVar1[2] = lVar3;
    *puVar1 = *(undefined8 *)(param_2 + 0x18 + param_3 * 8);
    *(undefined4 *)(puVar1 + 1) = *(undefined4 *)(param_2 + 0x28 + param_3 * 4);
    lVar3 = *(long *)(param_1 + 0x20);
    *(undefined8 **)(lVar3 + 0x18) = puVar1;
    puVar1[4] = lVar3;
    puVar1[3] = param_1;
    *(undefined8 **)(param_1 + 0x20) = puVar1;
    uVar2 = 0;
  }
  return uVar2;
}



undefined8 FUN_00105bb0(undefined8 param_1,undefined8 *param_2,undefined8 param_3)

{
  int iVar1;
  uint uVar2;
  undefined4 uVar3;
  int *piVar4;
  long lVar5;
  bool bVar6;
  ushort *puVar7;
  ushort *puVar8;
  ushort *puVar9;
  undefined8 uVar10;
  ulong uVar11;
  long lVar12;
  long lVar13;
  ulong uVar14;
  long in_FS_OFFSET;
  undefined8 local_18;
  
  piVar4 = (int *)*param_2;
  lVar5 = *(long *)(in_FS_OFFSET + 0x28);
  iVar1 = *piVar4;
  if (iVar1 == -0xee1fbe4) {
    iVar1 = piVar4[1];
    bVar6 = false;
  }
  else {
    *(undefined2 *)(local_18 + 0) = CONCAT11((char)((uint)iVar1 >> 0x10),(char)((uint)iVar1 >> 0x18));
    if (CONCAT22(CONCAT11((char)iVar1,(char)((uint)iVar1 >> 8)),(undefined2)local_18) != -0xee1fbe4)
    {
      FUN_00114dc0(param_1,0,"bad magic in `%s\'");
      uVar10 = 0xffffffff;
      goto LAB_00105df7;
    }
    iVar1 = piVar4[1];
    bVar6 = true;
    *(undefined2 *)(local_18 + 0) = CONCAT11((char)((uint)iVar1 >> 0x10),(char)((uint)iVar1 >> 0x18));
    iVar1 = CONCAT22(CONCAT11((char)iVar1,(char)((uint)iVar1 >> 8)),(undefined2)local_18);
  }
  if (iVar1 == 0xe) {
    uVar14 = param_2[1];
    uVar11 = uVar14 / 0x158;
    if (uVar14 == (uVar11 & 0xffffffff) * 0x158) {
      puVar7 = (ushort *)(piVar4 + 0x56);
      uVar2 = piVar4[2];
      param_2[3] = puVar7;
      if (bVar6) {
        *(undefined2 *)(local_18 + 0)= CONCAT11((char)(uVar2 >> 0x10),(char)(uVar2 >> 0x18));
        uVar2 = CONCAT22(CONCAT11((char)uVar2,(char)(uVar2 >> 8)),(undefined2)local_18);
        local_18 = (ulong)uVar2;
        uVar14 = local_18;
        *(uint *)(param_2 + 5) = uVar2;
        param_2[4] = puVar7 + local_18 * 0xac;
        iVar1 = piVar4[3];
        *(undefined2 *)(local_18 + 0)= CONCAT11((char)((uint)iVar1 >> 0x10),(char)((uint)iVar1 >> 0x18));
        iVar1 = CONCAT22(CONCAT11((char)iVar1,(char)((uint)iVar1 >> 8)),(undefined2)local_18);
        *(int *)((long)param_2 + 0x2c) = iVar1;
        if (uVar2 + 1 + iVar1 == (int)uVar11) {
          lVar12 = 0;
          do {
            if ((int)uVar14 != 0) {
              puVar9 = puVar7;
              do {
                while( true ) {
                  uVar2 = *(uint *)(puVar9 + 6);
                  *puVar9 = *puVar9 << 8 | *puVar9 >> 8;
                  *(uint *)(puVar9 + 6) =
                       uVar2 >> 0x18 | (uVar2 & 0xff0000) >> 8 | (uVar2 & 0xff00) << 8 |
                       uVar2 << 0x18;
                  uVar3 = *(undefined4 *)(puVar9 + 8);
                  *(undefined2 *)(local_18 + 0)= CONCAT11((char)((uint)uVar3 >> 0x10),(char)((uint)uVar3 >> 0x18))
                  ;
                  *(uint *)(puVar9 + 8) =
                       CONCAT22(CONCAT11((char)uVar3,(char)((uint)uVar3 >> 8)),(undefined2)local_18)
                  ;
                  uVar2 = *(uint *)(puVar9 + 10);
                  *(uint *)(puVar9 + 10) =
                       uVar2 >> 0x18 | (uVar2 & 0xff0000) >> 8 | (uVar2 & 0xff00) << 8 |
                       uVar2 << 0x18;
                  if ((0x2e < *(byte *)(puVar9 + 3)) ||
                     ((0x6200001e2020U >> ((ulong)*(byte *)(puVar9 + 3) & 0x3f) & 1) == 0)) break;
                  uVar2 = *(uint *)(puVar9 + 0xc);
                  puVar8 = puVar9 + 0xac;
                  *(uint *)(puVar9 + 0xc) =
                       uVar2 >> 0x18 | (uVar2 & 0xff0000) >> 8 | (uVar2 & 0xff00) << 8 |
                       uVar2 << 0x18;
                  uVar2 = *(uint *)(puVar9 + 0xe);
                  *(uint *)(puVar9 + 0xe) =
                       uVar2 >> 0x18 | (uVar2 & 0xff0000) >> 8 | (uVar2 & 0xff00) << 8 |
                       uVar2 << 0x18;
                  puVar9 = puVar8;
                  if (puVar8 == puVar7 + (ulong)((int)uVar14 - 1) * 0xac + 0xac) goto LAB_00105db5;
                }
                uVar11 = *(ulong *)(puVar9 + 0x10);
                puVar8 = puVar9 + 0xac;
                *(ulong *)(puVar9 + 0x10) =
                     uVar11 >> 0x38 | (uVar11 & 0xff000000000000) >> 0x28 |
                     (uVar11 & 0xff0000000000) >> 0x18 | (uVar11 & 0xff00000000) >> 8 |
                     (uVar11 & 0xff000000) << 8 | (uVar11 & 0xff0000) << 0x18 |
                     (uVar11 & 0xff00) << 0x28 | uVar11 << 0x38;
                uVar11 = *(ulong *)(puVar9 + 0xc);
                *(ulong *)(puVar9 + 0xc) =
                     uVar11 >> 0x38 | (uVar11 & 0xff000000000000) >> 0x28 |
                     (uVar11 & 0xff0000000000) >> 0x18 | (uVar11 & 0xff00000000) >> 8 |
                     (uVar11 & 0xff000000) << 8 | (uVar11 & 0xff0000) << 0x18 |
                     (uVar11 & 0xff00) << 0x28 | uVar11 << 0x38;
                puVar9 = puVar8;
              } while (puVar8 != puVar7 + (ulong)((int)uVar14 - 1) * 0xac + 0xac);
            }
LAB_00105db5:
            lVar13 = lVar12 + 4;
            if (lVar13 == 8) goto LAB_00105df5;
            uVar14 = (ulong)*(uint *)((long)param_2 + lVar12 + 0x2c);
            puVar7 = *(ushort **)((long)param_2 + lVar13 * 2 + 0x18);
            lVar12 = lVar13;
          } while( true );
        }
      }
      else {
        *(uint *)(param_2 + 5) = uVar2;
        param_2[4] = puVar7 + (ulong)uVar2 * 0xac;
        iVar1 = piVar4[3];
        *(int *)((long)param_2 + 0x2c) = iVar1;
        if ((int)uVar11 == uVar2 + 1 + iVar1) {
LAB_00105df5:
          uVar10 = 0;
          goto LAB_00105df7;
        }
      }
      FUN_00114dc0(param_1,0,"Inconsistent entries in `%s\' %u != %u");
      uVar10 = 0xffffffff;
    }
    else {
      FUN_00114dc0(param_1,0,"Size of `%s\' %zu is not a multiple of %zu");
      uVar10 = 0xffffffff;
    }
  }
  else {
    FUN_00114dc0(param_1,0,"File %s supports only version %d magic files. `%s\' is version %d");
    uVar10 = 0xffffffff;
  }
LAB_00105df7:
  if (lVar5 == *(long *)(in_FS_OFFSET + 0x28)) {
    return uVar10;
  }
                    // WARNING: Subroutine does not return
  __stack_chk_fail();
}

undefined8 FUN_00105ec0(undefined8 param_1,undefined (*param_2) [16],long param_3)

{
  uint uVar1;
  undefined8 uVar2;
  undefined8 uVar3;
  void *__ptr;
  long lVar4;
  undefined8 *puVar5;
  undefined8 *puVar6;
  byte bVar7;
  
  bVar7 = 0;
  puVar5 = (undefined8 *)((ulong)(*(char *)(*(long *)*param_2 + 6) == '-') * 0x10 + param_3);
  uVar1 = *(uint *)(puVar5 + 1);
  __ptr = (void *)*puVar5;
  if (uVar1 == *(uint *)((long)puVar5 + 0xc)) {
    *(uint *)((long)puVar5 + 0xc) = uVar1 + 200;
    __ptr = realloc(__ptr,(ulong)(uVar1 + 200) << 4);
    if (__ptr == (void *)0x0) {
      FUN_00115200(param_1,(ulong)*(uint *)((long)puVar5 + 0xc) << 4);
      return 0xffffffff;
    }
    puVar6 = (undefined8 *)((ulong)*(uint *)(puVar5 + 1) * 0x10 + (long)__ptr);
    for (lVar4 = 400; lVar4 != 0; lVar4 = lVar4 + -1) {
      *puVar6 = 0;
      puVar6 = puVar6 + (ulong)bVar7 * -2 + 1;
    }
    *puVar5 = __ptr;
    uVar1 = *(uint *)(puVar5 + 1);
  }
  uVar2 = *(undefined8 *)*param_2;
  uVar3 = *(undefined8 *)(*param_2 + 8);
  *(uint *)(puVar5 + 1) = uVar1 + 1;
  puVar5 = (undefined8 *)((long)__ptr + (ulong)uVar1 * 0x10);
  *puVar5 = uVar2;
  puVar5[1] = uVar3;
  *param_2 = (undefined  [16])0x0;
  return 0;
}



void FUN_00105f70(undefined8 *param_1,undefined8 *param_2)

{
  strcmp((char *)*param_1,(char *)*param_2);
  return;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

long FUN_00105f80(long param_1)

{
  char *pcVar1;
  byte bVar2;
  undefined auVar3 [16];
  int iVar4;
  ulong uVar5;
  long lVar6;
  char *pcVar7;
  char cVar8;
  
  if (false) {
switchD_00105fa2_caseD_0:
    __fprintf_chk(_stderr,1,"Bad type %d\n");
                    // WARNING: Subroutine does not return
    abort();
  }
  switch(*(undefined *)(param_1 + 6)) {
  default:
    goto switchD_00105fa2_caseD_0;
  case 1:
  case 0x30:
switchD_00105fa2_caseD_1:
    lVar6 = 0x1e;
    break;
  case 2:
  case 7:
  case 10:
    lVar6 = 0x28;
    break;
  case 3:
    if (*(char *)(param_1 + 0xb) != '\0') {
                    // WARNING: Subroutine does not return
      abort();
    }
    return 0;
  case 4:
  case 6:
  case 8:
  case 9:
  case 0xb:
  case 0xc:
  case 0xe:
  case 0xf:
  case 0x10:
  case 0x15:
  case 0x16:
  case 0x17:
  case 0x21:
  case 0x22:
  case 0x23:
    lVar6 = 0x3c;
    break;
  case 5:
  case 0xd:
    lVar6 = (long)(int)(((uint)*(byte *)(param_1 + 5) + (uint)*(byte *)(param_1 + 5) * 4) * 2) +
            0x14;
    break;
  case 0x11:
    cVar8 = *(char *)(param_1 + 0x20);
    pcVar7 = (char *)(param_1 + 0x20);
    if (cVar8 == '\0') goto switchD_00105fa2_caseD_1;
    uVar5 = 0;
    if ('^' < cVar8) goto LAB_0010611f;
LAB_001060f0:
    if (cVar8 < '$') goto switchD_00106107_caseD_25;
    if (false) goto switchD_00106107_caseD_25;
    switch(cVar8) {
    case '$':
    case '*':
    case '+':
    case '.':
    case '?':
    case '^':
switchD_00106107_caseD_24:
      cVar8 = pcVar7[1];
      pcVar7 = pcVar7 + 1;
LAB_00106116:
      do {
        if (cVar8 == '\0') break;
        if (cVar8 < '_') goto LAB_001060f0;
LAB_0010611f:
        if (cVar8 != '{') goto switchD_00106107_caseD_25;
        cVar8 = *pcVar7;
        if (cVar8 == '}') {
LAB_00106141:
          if (cVar8 != '\0') goto switchD_00106107_caseD_24;
        }
        else if (cVar8 != '\0') {
          do {
            cVar8 = pcVar7[1];
            pcVar7 = pcVar7 + 1;
            if (cVar8 == '\0') goto LAB_00106148;
          } while (cVar8 != '}');
          goto LAB_00106141;
        }
LAB_00106148:
        cVar8 = *pcVar7;
      } while( true );
    default:
      goto switchD_00106107_caseD_25;
    case '[':
      cVar8 = *pcVar7;
      if (cVar8 == ']') goto LAB_00106116;
      if (cVar8 != '\0') {
        while( true ) {
          pcVar1 = pcVar7 + 1;
          pcVar7 = pcVar7 + 1;
          if (*pcVar1 == '\0') break;
          if (*pcVar1 == ']') {
            cVar8 = ']';
            goto LAB_00106116;
          }
        }
      }
      break;
    case '\\':
      if (pcVar7[1] != '\0') {
        cVar8 = pcVar7[2];
        uVar5 = uVar5 + 1;
        pcVar7 = pcVar7 + 2;
        goto LAB_00106116;
      }
      uVar5 = uVar5 + 1;
    }
    if (uVar5 == 0) {
      uVar5 = 1;
    }
    *(undefined8 *)(auVar3 + 8) = 0;
    *(undefined8 *)(auVar3 + 0) = uVar5;
    lVar6 = SUB168((ZEXT816(0) << 0x40 | ZEXT816(10)) / auVar3,0);
    if (lVar6 == 0) {
      lVar6 = 1;
    }
    lVar6 = lVar6 * uVar5 + 0x14;
    break;
  case 0x12:
  case 0x13:
    lVar6 = (long)(int)((uint)*(byte *)(param_1 + 5) + (uint)*(byte *)(param_1 + 5) * 4) + 0x14;
    break;
  case 0x14:
    iVar4 = (int)(10 / (ulong)(long)(int)(uint)*(byte *)(param_1 + 5));
    if (iVar4 == 0) {
      iVar4 = 1;
    }
    lVar6 = (long)(int)(iVar4 * (uint)*(byte *)(param_1 + 5)) + 0x14;
    break;
  case 0x18:
  case 0x19:
  case 0x1a:
  case 0x1b:
  case 0x1c:
  case 0x1d:
  case 0x1e:
  case 0x1f:
  case 0x20:
  case 0x24:
  case 0x25:
  case 0x26:
  case 0x2a:
  case 0x2b:
  case 0x2c:
    lVar6 = 100;
    break;
  case 0x29:
  case 0x2d:
  case 0x2e:
    lVar6 = 0x14;
  }
  bVar2 = *(byte *)(param_1 + 4);
  if (bVar2 < 0x3f) {
    if ((bVar2 < 0x21) || (false)) {
switchD_00105fdc_caseD_22:
      __fprintf_chk(_stderr,1,"Bad relation %c\n",bVar2);
                    // WARNING: Subroutine does not return
      abort();
    }
    switch(bVar2) {
    case 0x21:
      goto switchD_00105fdc_caseD_21;
    default:
      goto switchD_00105fdc_caseD_22;
    case 0x26:
      goto switchD_00105fdc_caseD_26;
    case 0x3c:
    case 0x3e:
      uVar5 = lVar6 - 0x14;
      break;
    case 0x3d:
      uVar5 = lVar6 + 10;
    }
  }
  else {
    if (bVar2 != 0x5e) {
      if (bVar2 != 0x78) goto switchD_00105fdc_caseD_22;
switchD_00105fdc_caseD_21:
      bVar2 = *(byte *)(param_1 + 0xb);
      uVar5 = 1;
      goto joined_r0x00106047;
    }
switchD_00105fdc_caseD_26:
    uVar5 = lVar6 - 10;
  }
  if (uVar5 == 0) {
    uVar5 = 1;
  }
  bVar2 = *(byte *)(param_1 + 0xb);
joined_r0x00106047:
  if (bVar2 == 0x2b) {
    uVar5 = uVar5 + *(byte *)(param_1 + 3);
  }
  else if (bVar2 < 0x2c) {
    if (bVar2 != 0) {
      if (bVar2 != 0x2a) {
                    // WARNING: Subroutine does not return
        abort();
      }
      uVar5 = uVar5 * *(byte *)(param_1 + 3);
    }
  }
  else if (bVar2 == 0x2d) {
    uVar5 = uVar5 - *(byte *)(param_1 + 3);
  }
  else {
    if (bVar2 != 0x2f) {
                    // WARNING: Subroutine does not return
      abort();
    }
    uVar5 = uVar5 / *(byte *)(param_1 + 3);
  }
  return uVar5 + (*(char *)(param_1 + 0x80) == '\0');
switchD_00106107_caseD_25:
  uVar5 = uVar5 + 1;
  goto switchD_00106107_caseD_24;
}



uint FUN_00106290(undefined8 *param_1,undefined8 *param_2)

{
  ulong uVar1;
  ulong uVar2;
  uint uVar3;
  
  uVar1 = FUN_00105f80(*param_1);
  uVar2 = FUN_00105f80(*param_2);
  uVar3 = 0;
  if (uVar1 != uVar2) {
    uVar3 = -(uint)(uVar2 < uVar1) | 1;
  }
  return uVar3;
}



bool FUN_001062d0(ulong param_1,char *param_2)

{
  long *plVar1;
  char *pcVar2;
  
  if ((param_1 & 0x80) == 0) {
    plVar1 = (long *)FUN_00104d70();
    if ((*(byte *)(*plVar1 + (param_1 & 0xff) * 2) & 8) != 0) {
      return true;
    }
  }
  pcVar2 = strchr(param_2,(uint)param_1 & 0xff);
  return pcVar2 != (char *)0x0;
}



undefined8 FUN_00106320(long param_1,long *param_2)

{
  byte bVar1;
  ushort uVar2;
  long *plVar3;
  undefined8 uVar4;
  
  plVar3 = (long *)FUN_00104d70();
  bVar1 = *(byte *)(param_1 + 1);
  uVar2 = *(ushort *)(*plVar3 + (ulong)bVar1 * 2);
  if ((uVar2 & 0x400) == 0) {
    if ((uVar2 & 0x800) == 0) {
      param_1 = param_1 + 1;
      uVar4 = 4;
      goto LAB_0010636f;
    }
    if ((*(byte *)(*plVar3 + 1 + (ulong)*(byte *)(param_1 + 2) * 2) & 8) != 0) {
      return 0;
    }
    if (bVar1 == 0x34) {
switchD_00106398_caseD_49:
      uVar4 = 4;
    }
    else {
      if ('4' < (char)bVar1) {
        if (bVar1 != 0x38) {
          return 0;
        }
        goto switchD_00106398_caseD_51;
      }
      if (bVar1 == 0x31) goto switchD_00106398_caseD_43;
      if (bVar1 != 0x32) {
        return 0;
      }
switchD_00106398_caseD_53:
      uVar4 = 2;
    }
  }
  else {
    if (false) {
switchD_00106398_caseD_44:
      return 0;
    }
    switch(bVar1) {
    case 0x43:
switchD_00106398_caseD_43:
      uVar4 = 1;
      break;
    default:
      goto switchD_00106398_caseD_44;
    case 0x49:
    case 0x4c:
      goto switchD_00106398_caseD_49;
    case 0x51:
switchD_00106398_caseD_51:
      uVar4 = 0x18;
      break;
    case 0x53:
      goto switchD_00106398_caseD_53;
    }
  }
  param_1 = param_1 + 2;
LAB_0010636f:
  *param_2 = param_1;
  return uVar4;
}



undefined8 FUN_001063e0(undefined8 param_1,long *param_2,byte *param_3)

{
  byte *pbVar1;
  long lVar2;
  long *plVar3;
  undefined8 uVar4;
  ulong uVar5;
  byte bVar6;
  long in_FS_OFFSET;
  byte *local_48;
  long local_40;
  
  lVar2 = *param_2;
  local_40 = *(long *)(in_FS_OFFSET + 0x28);
  if (*(char *)(lVar2 + 0xb) != '\0') {
    FUN_00113c60(param_1,"Current entry already has a strength type: %c %d",*(char *)(lVar2 + 0xb),
                 *(undefined *)(lVar2 + 3));
    uVar4 = 0xffffffff;
    goto LAB_00106480;
  }
  if (*(char *)(lVar2 + 6) == '-') {
    FUN_00113c60(param_1,"%s: Strength setting is not supported in \"name\" magic entries",
                 lVar2 + 0x20);
    uVar4 = 0xffffffff;
    goto LAB_00106480;
  }
  uVar5 = (ulong)*param_3;
  if ((*param_3 & 0x80) == 0) {
    plVar3 = (long *)FUN_00104d70();
    do {
      if ((*(byte *)(*plVar3 + 1 + uVar5 * 2) & 0x20) == 0) break;
      pbVar1 = param_3 + 1;
      uVar5 = (ulong)*pbVar1;
      param_3 = param_3 + 1;
    } while ((*pbVar1 & 0x80) == 0);
  }
  bVar6 = (byte)uVar5;
  if ((0x2f < bVar6) || ((0xac0000000001U >> (uVar5 & 0x3f) & 1) == 0)) {
    FUN_00113c60(param_1,"Unknown factor op `%c\'",(int)(char)bVar6);
    uVar4 = 0xffffffff;
    goto LAB_00106480;
  }
  *(byte *)(lVar2 + 0xb) = bVar6;
  bVar6 = param_3[1];
  param_3 = param_3 + 1;
  if ((bVar6 & 0x80) == 0) {
    plVar3 = (long *)FUN_00104d70();
    do {
      if ((*(byte *)(*plVar3 + 1 + (ulong)bVar6 * 2) & 0x20) == 0) break;
      bVar6 = param_3[1];
      param_3 = param_3 + 1;
    } while ((bVar6 & 0x80) == 0);
  }
  uVar5 = strtoul((char *)param_3,(char **)&local_48,0);
  if (uVar5 < 0x100) {
    bVar6 = *local_48;
    if (bVar6 != 0) {
      plVar3 = (long *)FUN_00104d70();
      if ((*(byte *)(*plVar3 + 1 + (ulong)bVar6 * 2) & 0x20) == 0) {
        FUN_00113c60(param_1,"Bad factor `%s\'",param_3);
        goto LAB_0010654e;
      }
    }
    *(char *)(lVar2 + 3) = (char)uVar5;
    uVar4 = 0;
    if ((uVar5 != 0) || (*(char *)(lVar2 + 0xb) != '/')) goto LAB_00106480;
    FUN_00113c60(param_1,"Cannot have factor op `%c\' and factor %u",0x2f,0);
  }
  else {
    FUN_00113c60(param_1,"Too large factor `%lu\'",uVar5);
  }
LAB_0010654e:
  *(undefined *)(lVar2 + 0xb) = 0;
  uVar4 = 0xffffffff;
  *(undefined *)(lVar2 + 3) = 0;
LAB_00106480:
  if (local_40 == *(long *)(in_FS_OFFSET + 0x28)) {
    return uVar4;
  }
                    // WARNING: Subroutine does not return
  __stack_chk_fail();
}



undefined4 FUN_001065c0(char *param_1,char *param_2,long *param_3)

{
  size_t __n;
  int iVar1;
  
  __n = *(size_t *)(param_1 + 0x10);
  do {
    if (__n == 0) {
LAB_00106606:
      return *(undefined4 *)(param_1 + 0x18);
    }
    iVar1 = strncmp(param_2,param_1,__n);
    if (iVar1 == 0) {
      *param_3 = (long)(param_2 + __n);
      goto LAB_00106606;
    }
    __n = *(size_t *)(param_1 + 0x30);
    param_1 = param_1 + 0x20;
  } while( true );
}



void FUN_00106620(undefined8 *param_1)

{
  byte *pbVar1;
  long lVar2;
  long *plVar3;
  __int32_t **pp_Var4;
  byte bVar5;
  byte *pbVar7;
  int iVar6;
  
  pbVar1 = (byte *)*param_1;
  plVar3 = (long *)FUN_00104d70();
  lVar2 = *plVar3;
  bVar5 = *pbVar1;
  pbVar7 = pbVar1;
  if ((*(byte *)(lVar2 + 1 + (ulong)bVar5 * 2) & 1) == 0) {
    if (bVar5 == 0x75) goto LAB_00106691;
  }
  else {
    pp_Var4 = __ctype_tolower_loc();
    iVar6 = (*pp_Var4)[bVar5];
    if (iVar6 != 0x75) goto LAB_00106655;
LAB_00106691:
    pbVar7 = pbVar1 + 1;
    bVar5 = pbVar1[1];
    if ((*(byte *)(lVar2 + 1 + (ulong)bVar5 * 2) & 1) != 0) {
      pp_Var4 = __ctype_tolower_loc();
      iVar6 = (*pp_Var4)[bVar5];
      goto LAB_00106655;
    }
  }
  iVar6 = (int)(char)bVar5;
LAB_00106655:
  if (iVar6 - 0x62U < 0x12) {
    pbVar7 = pbVar7 + ((1L << ((byte)(iVar6 - 0x62U) & 0x3f) & 0x20443U) != 0);
  }
  *param_1 = pbVar7;
  return;
}



void FUN_001066c0(long *param_1,uint param_2)

{
  undefined4 uVar1;
  long *plVar2;
  long lVar3;
  ulong uVar4;
  short *psVar5;
  undefined8 uVar6;
  uint uVar7;
  long lVar8;
  uint uVar9;
  ulong uVar10;
  ulong uVar11;
  
  plVar2 = (long *)param_1[3];
  do {
    if (param_1 == plVar2) {
      return;
    }
    uVar7 = *(uint *)(plVar2 + 1);
    uVar10 = 0;
    if (uVar7 != 0) {
      do {
        while( true ) {
          lVar3 = *plVar2;
          uVar4 = (ulong)((int)uVar10 + 1);
          if ((*(byte *)(uVar10 * 0x158 + lVar3 + 2) & param_2) == param_2) break;
          psVar5 = (short *)(lVar3 + uVar4 * 0x158);
          while ((uVar9 = (uint)uVar4, uVar9 < uVar7 && (*psVar5 != 0))) {
            uVar4 = (ulong)(uVar9 + 1);
            psVar5 = psVar5 + 0xac;
          }
          uVar10 = uVar4;
          if (uVar7 <= uVar9) goto LAB_0010674f;
        }
        psVar5 = (short *)(uVar4 * 0x158 + lVar3);
        uVar11 = uVar10;
        while( true ) {
          uVar10 = uVar4;
          uVar9 = (uint)uVar10;
          lVar8 = uVar11 * 0x158 + lVar3;
          if ((((uVar7 <= uVar9) || (*psVar5 == 0)) || (*(char *)(lVar8 + 0x80) != '\0')) ||
             (psVar5 = psVar5 + 0xac, *(char *)(lVar8 + 0xc0) != '\0')) break;
          uVar4 = (ulong)(uVar9 + 1);
          uVar11 = uVar10;
        }
        uVar1 = *(undefined4 *)(lVar8 + 0x14);
        uVar6 = FUN_00105f80(*param_1);
        __printf_chk(1,"Strength = %3zu@%u: %s [%s]\n",uVar6,uVar1,lVar8 + 0x80,lVar8 + 0xc0);
        uVar7 = *(uint *)(plVar2 + 1);
      } while (uVar9 < uVar7);
    }
LAB_0010674f:
    plVar2 = (long *)plVar2[3];
  } while( true );
}



void FUN_00106800(void)

{
  long lVar1;
  long lVar2;
  char *pcVar3;
  undefined4 uVar4;
  
  lVar1 = (long)DAT_001244f4;
  if (DAT_001244f4 != 0) {
    return;
  }
  uVar4 = 0;
  lVar2 = 4;
  DAT_001244f4 = 1;
  pcVar3 = "invalid";
  while( true ) {
    *(char **)(&DAT_001245e0 + lVar1 * 8) = pcVar3;
    *(undefined4 *)(&DAT_00124500 + lVar1 * 4) = uVar4;
    if (lVar2 == 0) break;
    lVar1 = (long)*(int *)(pcVar3 + 0x38);
    if (0x30 < *(int *)(pcVar3 + 0x38)) {
                    // WARNING: Subroutine does not return
      __assert_fail("p->type < FILE_NAMES_SIZE","apprentice.c",399,"init_file_tables");
    }
    uVar4 = *(undefined4 *)(pcVar3 + 0x3c);
    lVar2 = *(long *)(pcVar3 + 0x50);
    pcVar3 = pcVar3 + 0x20;
  }
  if (pcVar3 + 0x20 == "") {
    return;
  }
                    // WARNING: Subroutine does not return
  __assert_fail("p - type_tbl == FILE_NAMES_SIZE","apprentice.c",0x193,"init_file_tables");
}



char * FUN_001068c0(uint *param_1,char *param_2,int param_3)

{
  int iVar1;
  char *pcVar2;
  char *pcVar3;
  char *pcVar4;
  char cVar5;
  long in_FS_OFFSET;
  char *local_38;
  long local_30;
  
  local_30 = *(long *)(in_FS_OFFSET + 0x28);
  if (param_3 != 0) {
    pcVar2 = strrchr(param_2,0x2f);
    if (pcVar2 != (char *)0x0) {
      param_2 = pcVar2 + 1;
    }
  }
  cVar5 = *param_2;
  pcVar2 = param_2;
  while ((pcVar3 = pcVar2, cVar5 != '\0' && (pcVar3 = pcVar2 + 1, *pcVar3 != '\0'))) {
    pcVar2 = pcVar2 + 2;
    cVar5 = *pcVar2;
  }
  cVar5 = '\0';
  pcVar4 = "";
  pcVar2 = pcVar3;
  while (param_2 <= pcVar2) {
    if (*pcVar4 != cVar5) {
      if (pcVar4 < ".mgc") goto LAB_00106950;
      break;
    }
    pcVar4 = pcVar4 + -1;
    if (pcVar3 + -5 == pcVar2 + -1) goto LAB_00106958;
    cVar5 = pcVar2[-1];
    pcVar2 = pcVar2 + -1;
  }
  if (cVar5 == '\0') {
LAB_00106950:
    pcVar2 = pcVar2 + 1;
  }
  else {
    do {
      pcVar3 = pcVar2;
      pcVar2 = pcVar3 + 1;
    } while (*pcVar2 != '\0');
    pcVar2 = pcVar3 + 2;
  }
LAB_00106958:
  if ((*param_1 & 0x410) == 0) {
LAB_001069d9:
    iVar1 = __asprintf_chk(&local_38,1,"%.*s%s",(long)pcVar2 - (long)param_2 & 0xffffffff,param_2,
                           &DAT_0011bcb1);
    if (iVar1 < 0) {
LAB_00106a80:
      local_38 = (char *)0x0;
      goto LAB_001069b1;
    }
    pcVar2 = strstr(param_2,".mime");
    if (pcVar2 == (char *)0x0) goto LAB_001069b1;
  }
  else {
    iVar1 = __asprintf_chk(&local_38,1,"%.*s.mime%s",(long)pcVar2 - (long)param_2 & 0xffffffff,
                           param_2,&DAT_0011bcb1);
    if (iVar1 < 0) goto LAB_00106a80;
    iVar1 = access(local_38,4);
    if (iVar1 == -1) {
      free(local_38);
      goto LAB_001069d9;
    }
  }
  *param_1 = *param_1 & 0x10;
LAB_001069b1:
  if (local_30 != *(long *)(in_FS_OFFSET + 0x28)) {
                    // WARNING: Subroutine does not return
    __stack_chk_fail();
  }
  return local_38;
}



undefined4 FUN_00106a90(long param_1,long param_2,undefined8 param_3)

{
  int __fd;
  char *__file;
  ssize_t sVar1;
  size_t sVar2;
  int *piVar3;
  long lVar4;
  size_t sVar5;
  undefined8 *puVar6;
  undefined4 uVar7;
  long in_FS_OFFSET;
  byte bVar8;
  undefined8 local_188;
  undefined8 local_180;
  long local_30;
  
  bVar8 = 0;
  local_30 = *(long *)(in_FS_OFFSET + 0x28);
  __file = (char *)FUN_001068c0(param_1 + 0x38,param_3,1);
  if (__file == (char *)0x0) {
    uVar7 = 0xffffffff;
  }
  else {
    __fd = open(__file,0x241,0x1a4);
    if (__fd == -1) {
      piVar3 = __errno_location();
      FUN_00114dc0(param_1,*piVar3,"cannot open `%s\'");
      uVar7 = 0xffffffff;
    }
    else {
      puVar6 = &local_188;
      for (lVar4 = 0x2b; lVar4 != 0; lVar4 = lVar4 + -1) {
        *puVar6 = 0;
        puVar6 = puVar6 + (ulong)bVar8 * -2 + 1;
      }
      local_188 = 0xef11e041c;
      local_180 = *(undefined8 *)(param_2 + 0x28);
      sVar1 = write(__fd,&local_188,0x158);
      if (sVar1 == 0x158) {
        sVar5 = (ulong)*(uint *)(param_2 + 0x28) * 0x158;
        sVar2 = write(__fd,*(void **)(param_2 + 0x18),sVar5);
        if (sVar2 == sVar5) {
          sVar5 = (ulong)*(uint *)(param_2 + 0x2c) * 0x158;
          sVar2 = write(__fd,*(void **)(param_2 + 0x20),sVar5);
          if (sVar2 == sVar5) {
            uVar7 = 0;
            close(__fd);
            goto LAB_00106b78;
          }
        }
      }
      piVar3 = __errno_location();
      uVar7 = 0xffffffff;
      FUN_00114dc0(param_1,*piVar3,"error writing `%s\'");
    }
  }
LAB_00106b78:
  FUN_00105a40(param_2);
  free(__file);
  if (local_30 == *(long *)(in_FS_OFFSET + 0x28)) {
    return uVar7;
  }
                    // WARNING: Subroutine does not return
  __stack_chk_fail();
}



int FUN_00106c00(uint param_1)

{
  int iVar1;
  long *plVar2;
  
  if ((param_1 & 0x80) != 0) {
    return -1;
  }
  plVar2 = (long *)FUN_00104d70();
  if ((*(byte *)(*plVar2 + 1 + (ulong)(param_1 & 0xff) * 2) & 8) == 0) {
    if (5 < param_1 - 0x61) {
      iVar1 = -1;
      if (param_1 - 0x41 < 6) {
        iVar1 = param_1 - 0x37;
      }
      return iVar1;
    }
    return param_1 - 0x57;
  }
  return param_1 - 0x30;
}



undefined8
FUN_00106c70(long param_1,long param_2,int param_3,byte *param_4,long param_5,ulong param_6,
            undefined8 param_7,undefined8 param_8,int param_9)

{
  char *__s;
  byte bVar1;
  int iVar2;
  long *plVar3;
  undefined8 *puVar4;
  undefined8 uVar5;
  ulong uVar6;
  ulong uVar7;
  ulong uVar8;
  byte *pbVar9;
  char cVar10;
  uint uVar11;
  ulong local_48;
  
  if (param_3 != 0) {
    param_2 = param_2 + (ulong)(param_3 - 1) * 0x158;
  }
  __s = (char *)(param_2 + param_5);
  if (*__s != '\0') {
    local_48 = param_6;
    if (param_9 != 0) {
      local_48 = strlen(__s);
    }
    FUN_00113c60(param_1,"Current entry already has a %s type `%.*s\', new type `%s\'",param_7,
                 local_48 & 0xffffffff,__s,param_4);
    return 0xffffffff;
  }
  if (*(char *)(param_2 + 0x80) == '\0') {
    FUN_00113c60(param_1,"Current entry does not yet have a description for adding a %s type",
                 param_7);
    return 0xffffffff;
  }
  bVar1 = *param_4;
  uVar6 = (ulong)bVar1;
  uVar11 = (uint)bVar1;
  pbVar9 = param_4;
  if ((bVar1 & 0x80) == 0) {
    plVar3 = (long *)FUN_00104d70();
    do {
      if ((*(byte *)(*plVar3 + 1 + uVar6 * 2) & 0x20) == 0) {
        bVar1 = *pbVar9;
        uVar6 = (ulong)bVar1;
        uVar8 = 0;
        uVar11 = (uint)bVar1;
        if (bVar1 == 0) goto LAB_00106d80;
        goto LAB_00106d09;
      }
      bVar1 = pbVar9[1];
      pbVar9 = pbVar9 + 1;
      uVar11 = (uint)bVar1;
      uVar6 = (ulong)bVar1;
    } while ((bVar1 & 0x80) == 0);
    uVar6 = (ulong)uVar11;
  }
LAB_00106d09:
  uVar7 = 0;
  while( true ) {
    cVar10 = (char)uVar11;
    iVar2 = FUN_001062d0(uVar6,param_8);
    if (iVar2 == 0) break;
    uVar8 = uVar7 + 1;
    __s[uVar7] = cVar10;
    uVar11 = (uint)pbVar9[uVar8];
    if (pbVar9[uVar8] == 0) goto LAB_00106d80;
    if (uVar8 == param_6) {
      if (param_9 != 0) {
        __s[param_6 - 1] = '\0';
      }
      if ((*(byte *)(param_1 + 0x38) & 0x40) != 0) {
        FUN_00113c60(param_1,"%s type `%s\' truncated %zu",param_7,param_4,param_6);
      }
      goto LAB_00106d42;
    }
    uVar6 = (ulong)uVar11;
    uVar7 = uVar8;
  }
  plVar3 = (long *)FUN_00104d70();
  uVar8 = uVar7;
  if ((*(byte *)(*plVar3 + 1 + (ulong)uVar11 * 2) & 0x20) != 0) goto LAB_00106d2d;
LAB_00106da8:
  FUN_00113c60(param_1,"%s type `%s\' has bad char \'%c\'",param_7,param_4,(int)cVar10);
LAB_00106d2d:
  if (param_9 != 0) {
    __s[uVar8] = '\0';
  }
  if (uVar8 == 0) {
    FUN_001150c0(param_1,"Bad magic entry \'%s\'");
    uVar5 = 0xffffffff;
  }
  else {
LAB_00106d42:
    uVar5 = 0;
  }
  return uVar5;
LAB_00106d80:
  puVar4 = (undefined8 *)FUN_00104d70();
  if (((*(ushort *)*puVar4 & 0x2000) != 0) || (iVar2 = FUN_001062d0(0,param_8), iVar2 != 0))
  goto LAB_00106d2d;
  cVar10 = '\0';
  goto LAB_00106da8;
}



void FUN_00106ea0(undefined8 param_1,undefined8 *param_2,undefined8 param_3)

{
  FUN_00106c70(param_1,*param_2,*(undefined4 *)(param_2 + 1),param_3,0x118,0x40,"EXTENSION",",!+-/",
               0);
  return;
}



void FUN_00106ee0(undefined8 param_1,undefined8 *param_2,undefined8 param_3)

{
  FUN_00106c70(param_1,*param_2,*(undefined4 *)(param_2 + 1),param_3,0x110,8,"APPLE","!+-./?",0);
  return;
}



void FUN_00106f20(undefined8 param_1,undefined8 *param_2,undefined8 param_3)

{
  FUN_00106c70(param_1,*param_2,*(undefined4 *)(param_2 + 1),param_3,0xc0,0x50,&DAT_0011c549,
               &DAT_0011c544,1);
  return;
}



long FUN_00106f60(long param_1,long param_2,long param_3)

{
  if (true) {
    switch(*(undefined *)(param_2 + 6)) {
    case 1:
      return (long)(char)param_3;
    case 2:
    case 7:
    case 10:
      return (long)(short)param_3;
    case 3:
    case 5:
    case 0xd:
    case 0x11:
    case 0x12:
    case 0x13:
    case 0x14:
    case 0x18:
    case 0x19:
    case 0x1a:
    case 0x1b:
    case 0x1c:
    case 0x1d:
    case 0x1e:
    case 0x1f:
    case 0x20:
    case 0x24:
    case 0x25:
    case 0x26:
    case 0x29:
    case 0x2a:
    case 0x2b:
    case 0x2c:
    case 0x2d:
    case 0x2e:
    case 0x2f:
    case 0x30:
      return param_3;
    case 4:
    case 6:
    case 8:
    case 9:
    case 0xb:
    case 0xc:
    case 0xe:
    case 0xf:
    case 0x10:
    case 0x15:
    case 0x16:
    case 0x17:
    case 0x21:
    case 0x22:
    case 0x23:
      return (long)(int)param_3;
    }
  }
  if ((*(byte *)(param_1 + 0x38) & 0x40) == 0) {
    return 0xffffffff;
  }
  FUN_00113c60(param_1,"cannot happen: m->type=%d\n");
  return 0xffffffff;
}



void FUN_00106fe0(undefined8 *param_1)

{
  if (param_1 != (undefined8 *)0x0) {
    FUN_00105af0(*param_1);
    FUN_00105af0(param_1[1]);
    free((void *)param_1[5]);
    free((void *)param_1[4]);
    free((void *)param_1[3]);
    free(param_1);
    return;
  }
  return;
}



undefined8 * FUN_00107030(undefined4 param_1)

{
  int iVar1;
  undefined8 *__ptr;
  void *pvVar2;
  int *piVar3;
  
  __ptr = (undefined8 *)calloc(1,0xe8);
  if (__ptr == (undefined8 *)0x0) {
    return (undefined8 *)0x0;
  }
  iVar1 = magic_setflags(__ptr,param_1);
  if (iVar1 == -1) {
    piVar3 = __errno_location();
    *piVar3 = 0x16;
  }
  else {
    __ptr[5] = 0;
    __ptr[4] = 0;
    __ptr[2] = 10;
    pvVar2 = malloc(0xa0);
    __ptr[3] = pvVar2;
    if (pvVar2 != (void *)0x0) {
      *__ptr = 0;
      __ptr[8] = "unknown";
      *(undefined4 *)((long)__ptr + 0x3c) = 0;
      *(undefined4 *)((long)__ptr + 0x34) = 0xffffffff;
      __ptr[1] = 0;
      __ptr[9] = 0;
      __ptr[0x1a] = 0x8008000001e0032;
      *(undefined4 *)(__ptr + 0x1b) = 0x20000100;
      __ptr[0x1c] = 0x100000;
      return __ptr;
    }
  }
  free(__ptr);
  return (undefined8 *)0x0;
}



undefined4 FUN_00107140(long *param_1,long param_2,long param_3,long param_4)

{
  undefined8 uVar1;
  undefined8 uVar2;
  int iVar3;
  void *pvVar4;
  undefined8 *puVar5;
  long lVar6;
  
  if (param_4 == 0) {
    return 0xffffffff;
  }
  if (*param_1 != 0) {
    FUN_001157e0(0x02);
  }
  FUN_00106800();
  FUN_00105af0(*param_1);
  pvVar4 = calloc(1,0x28);
  if (pvVar4 == (void *)0x0) {
    lVar6 = 0;
  }
  else {
    *(void **)((long)pvVar4 + 0x20) = pvVar4;
    lVar6 = param_1[1];
    *(void **)((long)pvVar4 + 0x18) = pvVar4;
    *param_1 = (long)pvVar4;
    FUN_00105af0(lVar6);
    pvVar4 = calloc(1,0x28);
    if (pvVar4 != (void *)0x0) {
      *(void **)((long)pvVar4 + 0x20) = pvVar4;
      lVar6 = 0;
      *(void **)((long)pvVar4 + 0x18) = pvVar4;
      param_1[1] = (long)pvVar4;
      while( true ) {
        uVar1 = *(undefined8 *)(param_3 + lVar6 * 8);
        uVar2 = *(undefined8 *)(param_2 + lVar6 * 8);
        puVar5 = (undefined8 *)calloc(1,0x30);
        if (puVar5 == (undefined8 *)0x0) {
          FUN_00115200(param_1,0x30);
          goto LAB_0010728d;
        }
        *puVar5 = uVar2;
        puVar5[1] = uVar1;
        *(undefined4 *)(puVar5 + 2) = 0;
        iVar3 = FUN_00105bb0(param_1,puVar5,"buffer");
        if (iVar3 != 0) break;
        iVar3 = FUN_00105b40(*param_1,puVar5,0);
        if ((iVar3 == -1) || (iVar3 = FUN_00105b40(param_1[1],puVar5,1), iVar3 == -1)) {
          FUN_00115200(param_1,0x28);
          goto LAB_0010728d;
        }
        lVar6 = lVar6 + 1;
        if (param_4 == lVar6) {
          return 0;
        }
      }
      FUN_00105a40(puVar5);
      goto LAB_0010728d;
    }
    lVar6 = 1;
  }
  param_1[lVar6] = 0;
  FUN_00115200(param_1,0x28);
LAB_0010728d:
  FUN_00105af0(*param_1);
  *param_1 = 0;
  FUN_00105af0(param_1[1]);
  param_1[1] = 0;
  return 0xffffffff;
}



undefined8 FUN_00107300(undefined8 param_1,long param_2,undefined8 param_3)

{
  undefined8 uVar1;
  
  if ((*(byte *)(param_2 + 2) & 8) == 0) {
    uVar1 = FUN_00106f60(param_1, param_2, param_3);
    return uVar1;
  }
  return param_3;
}



void FUN_00107320(FILE *param_1,long param_2,long param_3)

{
  char cVar1;
  
  param_2 = param_2 + 1;
  do {
    if (param_3 == 0xffffffff) {
      cVar1 = *(char *)(param_2 + -1);
      if (cVar1 == '\0') {
        return;
      }
    }
    else {
      if (param_3 == 0) {
        return;
      }
      cVar1 = *(char *)(param_2 + -1);
      param_3 = param_3 + -1;
    }
    if ((byte)(cVar1 - 0x20U) < 0x5f) {
      fputc((int)cVar1,param_1);
    }
    else {
      fputc(0x5c,param_1);
      switch(cVar1) {
      case '\a':
        fputc(0x61,param_1);
        break;
      case '\b':
        fputc(0x62,param_1);
        break;
      case '\t':
        fputc(0x74,param_1);
        break;
      case '\n':
        fputc(0x6e,param_1);
        break;
      case '\v':
        fputc(0x76,param_1);
        break;
      case '\f':
        fputc(0x66,param_1);
        break;
      case '\r':
        fputc(0x72,param_1);
        break;
      default:
        __fprintf_chk(param_1,1,&DAT_0011c570,cVar1);
      }
    }
    param_2 = param_2 + 1;
  } while( true );
}



undefined8 FUN_00107460(long param_1)

{
  uint uVar1;
  undefined8 uVar2;
  
  uVar1 = *(uint *)(param_1 + 0x1c) & 0xf80;
  if (uVar1 != 0x100) {
    if (uVar1 < 0x101) {
      if (uVar1 != 0x80) {
        return -1;
      }
      return 1;
    }
    if ((uVar1 - 0x400 & 0xfffffb80) == 0) {
      return 4;
    }
    if (uVar1 != 0x200) {
                    // WARNING: Subroutine does not return
      abort();
    }
  }
  return 2;
}



void FUN_001074d0(long param_1,int param_2,char *param_3,int *param_4,undefined8 param_5)

{
  uint uVar1;
  int iVar2;
  undefined8 uVar3;
  char cVar4;
  ushort uVar5;
  int iVar6;
  uint uVar7;
  int iVar8;
  FILE *__stream;
  __ssize_t _Var9;
  long *plVar10;
  ulonglong uVar11;
  undefined8 *puVar12;
  void *__ptr;
  long lVar13;
  ulong uVar14;
  int *piVar15;
  undefined8 *puVar16;
  byte *pbVar17;
  char cVar18;
  ulong uVar19;
  ulong uVar20;
  ulong uVar21;
  uint uVar22;
  long lVar23;
  byte bVar24;
  byte *pbVar25;
  undefined8 *puVar26;
  ulong uVar27;
  byte bVar28;
  byte *pbVar29;
  char *pcVar30;
  byte *pbVar31;
  undefined **ppuVar32;
  size_t sVar33;
  byte *pbVar34;
  byte *pbVar35;
  undefined *__n;
  long in_FS_OFFSET;
  bool bVar36;
  byte bVar37;
  float fVar38;
  double dVar39;
  byte *local_118;
  size_t local_e0;
  byte *local_d8;
  byte *local_d0;
  byte *local_c8;
  byte *local_c0;
  undefined local_b8 [16] = {0};
  byte *local_a8 [13];
  long local_40;
  
  bVar37 = 0;
  local_40 = *(long *)(in_FS_OFFSET + 0x28);
  *(char **)(param_1 + 0x40) = param_3;
  local_e0 = 0;
  local_d8 = (byte *)0x0;
  __stream = fopen(param_3,"r");
  if (__stream == (FILE *)0x0) {
    piVar15 = __errno_location();
    if (*piVar15 == 2) {
      *param_4 = *param_4 + 1;
    }
    else {
      FUN_00114dc0(param_1,*piVar15,"cannot read magic file `%s\'");
      *param_4 = *param_4 + 1;
    }
  }
  else {
    *(undefined8 *)(param_1 + 0x48) = 1;
    iVar2 = 0;
    while (_Var9 = __getdelim((char **)&local_d8,&local_e0,10,__stream), pbVar29 = local_d8,
          _Var9 != -1) {
      if (_Var9 != 0) {
        if (local_d8[_Var9 + -1] == 10) {
          iVar2 = iVar2 + 1;
          local_d8[_Var9 + -1] = 0;
        }
        bVar24 = *local_d8;
        if (bVar24 == 0x21) {
          if (local_d8[1] != 0x3a) goto LAB_001075e1;
          lVar23 = 0;
          pbVar35 = local_d8 + 2;
          __n = (undefined *)0x4;
          pbVar34 = &DAT_0011c4ce;
          ppuVar32 = &PTR_DAT_00123520;
          while( true ) {
            if ((__n < (undefined *)(_Var9 - 2U)) &&
               (iVar6 = memcmp(pbVar34,pbVar35,(size_t)__n), iVar6 == 0)) {
              if (*(undefined8 *)(local_b8 + 0) != 0) {
                iVar6 = (*(code *)(&PTR_FUN_00123530)[lVar23 * 3])() //TODO: Fix this.
                                  (param_1,local_b8,pbVar29 + (long)(__n + 2));
                if (iVar6 != 0) goto LAB_00107634;
                goto LAB_0010763c;
              }
              pcVar30 = "No current entry for :!%s type";
              goto LAB_001079e1;
            }
            pbVar34 = ppuVar32[3];
            lVar23 = lVar23 + 1;
            if (pbVar34 == (byte *)0x0) break;
            __n = ppuVar32[4];
            ppuVar32 = ppuVar32 + 3;
          }
          pcVar30 = "Unknown !: entry `%s\'";
          pbVar34 = pbVar29;
LAB_001079e1:
          FUN_00114dc0(param_1,0,pcVar30);
          *param_4 = *param_4 + 1;
        }
        else if ((bVar24 != 0x23) && (bVar24 != 0)) {
LAB_001075e1:
          local_d0 = local_d8;
          if (*local_d8 == 0x3e) {
            pbVar29 = local_d8 + 1;
            do {
              local_d0 = pbVar29;
              uVar22 = (1 - (int)(local_d8 + 1)) + (int)local_d0;
              uVar14 = (ulong)uVar22;
              pbVar29 = local_d0 + 1;
            } while (*local_d0 == 0x3e);
            if (uVar22 == 0) goto LAB_00107a00;
            if ((DAT_001244f0 < uVar22) && (iVar6 = FUN_00115ad0(param_1,uVar22), iVar6 == -1))
            goto LAB_00107634;
            DAT_001244f0 = uVar22;
            if ((void *)*(undefined8 *)(local_b8 + 0) == (void *)0x0) {
              FUN_001150c0(param_1,"No current entry for continuation");
              goto LAB_00107634;
            }
            if (*(undefined4 *)(local_b8 + 8) == 0) {
              FUN_001150c0(param_1,"Continuations present with 0 count");
              goto LAB_00107634;
            }
            __ptr = (void *)*(undefined8 *)(local_b8 + 0);
            uVar1 = *(undefined4 *)(local_b8 + 8);
            if (1 < (int)(uVar22 - *(ushort *)(*(undefined8 *)(local_b8 + 0) + (ulong)(*(undefined4 *)(local_b8 + 8) - 1) * 0x158)
                         )) {
              FUN_00113c60(param_1,
                           "New continuation level %u is more than one larger than current level %u"
                           ,uVar22);
              __ptr = (void *)*(undefined8 *)(local_b8 + 0);
              uVar1 = *(undefined4 *)(local_b8 + 8);
            }
            uVar19 = (ulong)uVar1;
            if (*(undefined4 *)(local_b8 + 12)  == uVar1) {
              sVar33 = (uVar19 + 10) * 0x158;
              __ptr = realloc(__ptr,sVar33);
              if (__ptr == (void *)0x0) {
                FUN_00115200(param_1,sVar33);
                goto LAB_00107634;
              }
              uVar3 = *(undefined8 *)(local_b8 + 8);
              *(undefined8 *)(local_b8 + 0) = __ptr;
              *(undefined4 *)(local_b8 + 12)  = uVar1 + 10;
              uVar19 = uVar3 & 0xffffffff;
            }
            *(undefined4 *)(local_b8 + 8) = (int)uVar19 + 1;
            puVar12 = (undefined8 *)((long)__ptr + uVar19 * 0x158);
            *puVar12 = 0;
            puVar12[0x2a] = 0;
            puVar26 = (undefined8 *)((ulong)(puVar12 + 1) & 0xfffffffffffffff8);
            for (uVar19 = (ulong)(((int)puVar12 -
                                  (int)(undefined8 *)((ulong)(puVar12 + 1) & 0xfffffffffffffff8)) +
                                  0x158U >> 3); uVar19 != 0; uVar19 = uVar19 - 1) {
              *puVar26 = 0;
              puVar26 = puVar26 + (ulong)bVar37 * -2 + 1;
            }
            *(short *)puVar12 = (short)uVar22;
            goto LAB_0010770c;
          }
LAB_00107a00:
          iVar6 = FUN_00115ad0(param_1,0);
          if (iVar6 == -1) goto LAB_00107634;
          DAT_001244f0 = 0;
          if (*(undefined8 *)(local_b8 + 0) != 0) goto code_r0x00107a2c;
          puVar12 = (undefined8 *)malloc(0xd70);
          if (puVar12 == (undefined8 *)0x0) {
            FUN_00115200(param_1,0xd70);
          }
          else {
            puVar26 = puVar12;
            for (lVar23 = 0x2b; lVar23 != 0; lVar23 = lVar23 + -1) {
              *puVar26 = 0;
              puVar26 = puVar26 + (ulong)bVar37 * -2 + 1;
            }
            uVar14 = 0;
            *(undefined8 *)(local_b8 + 8) = 0xa00000001;
            *(undefined8 *)(local_b8 + 0) = puVar12;
            uVar22 = 0;
LAB_0010770c:
            *(int *)((long)puVar12 + 0x14) = iVar2;
            bVar24 = *local_d0;
            if (bVar24 == 0x26) {
              *(byte *)((long)puVar12 + 2) = *(byte *)((long)puVar12 + 2) | 2;
              bVar24 = local_d0[1];
              local_d0 = local_d0 + 1;
            }
            pbVar29 = local_d0;
            if (bVar24 == 0x28) {
              bVar24 = *(byte *)((long)puVar12 + 2);
              bVar28 = bVar24 | 1;
              if ((bVar24 & 2) != 0) {
                bVar28 = bVar24 & 0xf9 | 5;
              }
              *(byte *)((long)puVar12 + 2) = bVar28;
              pbVar29 = local_d0 + 1;
              if (local_d0[1] == 0x26) {
                *(byte *)((long)puVar12 + 2) = *(byte *)((long)puVar12 + 2) | 2;
                pbVar29 = local_d0 + 2;
              }
            }
            local_d0 = pbVar29;
            if (((short)uVar22 == 0) && ((*(byte *)((long)puVar12 + 2) & 6) != 0)) {
              if ((*(byte *)(param_1 + 0x38) & 0x40) != 0) {
                FUN_00113c60(param_1,"relative offset at level 0");
              }
            }
            else {
              uVar19 = strtoul((char *)local_d0,(char **)&local_c8,0);
              *(int *)((long)puVar12 + 0xc) = (int)uVar19;
              if (local_d0 != local_c8) {
                local_d0 = local_c8;
                if ((*(byte *)((long)puVar12 + 2) & 1) != 0) {
                  *(undefined4 *)(puVar12 + 2) = 0;
                  *(undefined2 *)((long)puVar12 + 7) = 4;
                  bVar24 = *local_c8;
                  pbVar29 = local_c8;
                  if ((bVar24 & 0xfd) == 0x2c) {
                    if (bVar24 == 0x2c) {
                      *(undefined *)(puVar12 + 1) = 0x20;
                    }
                    local_d0 = local_c8 + 1;
                    if (false) {
switchD_00107b0c_caseD_44:
                      if ((*(byte *)(param_1 + 0x38) & 0x40) != 0) {
                        FUN_00113c60(param_1,"indirect offset type `%c\' invalid");
                      }
                      goto LAB_00107634;
                    }
                    switch(local_c8[1]) {
                    case 0x42:
                    case 0x43:
                    case 0x62:
                    case 99:
                      *(undefined *)((long)puVar12 + 7) = 1;
                      break;
                    default:
                      goto switchD_00107b0c_caseD_44;
                    case 0x45:
                    case 0x46:
                    case 0x47:
                      *(undefined *)((long)puVar12 + 7) = 0x25;
                      break;
                    case 0x48:
                    case 0x53:
                      *(undefined *)((long)puVar12 + 7) = 7;
                      break;
                    case 0x49:
                      *(undefined *)((long)puVar12 + 7) = 0x27;
                      break;
                    case 0x4c:
                      *(undefined *)((long)puVar12 + 7) = 8;
                      break;
                    case 0x65:
                    case 0x66:
                    case 0x67:
                      *(undefined *)((long)puVar12 + 7) = 0x26;
                      break;
                    case 0x68:
                    case 0x73:
                      *(undefined *)((long)puVar12 + 7) = 10;
                      break;
                    case 0x69:
                      *(undefined *)((long)puVar12 + 7) = 0x28;
                      break;
                    case 0x6c:
                      *(undefined *)((long)puVar12 + 7) = 0xb;
                      break;
                    case 0x6d:
                      *(undefined *)((long)puVar12 + 7) = 0x17;
                    }
                    pbVar29 = local_c8 + 2;
                    bVar24 = local_c8[2];
                  }
                  local_d0 = pbVar29;
                  if (bVar24 == 0x7e) {
                    local_d0 = pbVar29 + 1;
                    *(byte *)(puVar12 + 1) = *(byte *)(puVar12 + 1) | 0x40;
                    bVar24 = pbVar29[1];
                  }
                  pbVar35 = local_d0;
                  iVar6 = FUN_001059c0((int)(char)bVar24);
                  pbVar29 = pbVar35;
                  if (iVar6 != -1) {
                    *(byte *)(puVar12 + 1) = *(byte *)(puVar12 + 1) | (byte)iVar6;
                    pbVar29 = pbVar35 + 1;
                    bVar24 = pbVar35[1];
                    local_d0 = pbVar29;
                  }
                  pbVar35 = pbVar29;
                  if (bVar24 == 0x28) {
                    pbVar35 = pbVar29 + 1;
                    *(byte *)(puVar12 + 1) = *(byte *)(puVar12 + 1) | 0x80;
                    bVar24 = pbVar29[1];
                    local_d0 = pbVar35;
                  }
                  plVar10 = (long *)FUN_00104d70();
                  if (((*(byte *)(*plVar10 + 1 + (ulong)bVar24 * 2) & 8) != 0) || (bVar24 == 0x2d))
                  {
                    lVar23 = strtol((char *)pbVar35,(char **)&local_c8,0);
                    *(int *)(puVar12 + 2) = (int)lVar23;
                    pbVar35 = local_c8;
                    if (local_d0 == local_c8) {
                      if ((*(byte *)(param_1 + 0x38) & 0x40) != 0) {
                        FUN_00113c60(param_1,"in_offset `%s\' invalid",local_c8);
                      }
                      goto LAB_00107634;
                    }
                  }
                  local_d0 = pbVar35 + 1;
                  if ((*pbVar35 != 0x29) ||
                     ((*(char *)(puVar12 + 1) < '\0' && (local_d0 = pbVar35 + 2, pbVar35[1] != 0x29)
                      ))) {
                    if ((*(byte *)(param_1 + 0x38) & 0x40) != 0) {
                      FUN_00113c60(param_1,"missing \')\' in indirect offset");
                    }
                    goto LAB_00107634;
                  }
                }
                pbVar29 = local_d0;
                bVar24 = *local_d0;
                if ((bVar24 & 0x80) == 0) {
                  plVar10 = (long *)FUN_00104d70();
                  do {
                    if ((*(byte *)(*plVar10 + 1 + (ulong)bVar24 * 2) & 0x20) == 0) break;
                    pbVar29 = pbVar29 + 1;
                    bVar24 = *pbVar29;
                    local_d0 = pbVar29;
                  } while ((bVar24 & 0x80) == 0);
                }
                sVar33 = 2;
                pcVar30 = "if";
                do {
                  iVar6 = strncmp((char *)pbVar29,pcVar30,sVar33);
                  if (iVar6 == 0) {
                    plVar10 = (long *)FUN_00104d70();
                    pbVar35 = pbVar29 + sVar33;
                    if ((*(byte *)(*plVar10 + 1 + (ulong)pbVar29[sVar33] * 2) & 0x20) != 0) break;
                  }
                  sVar33 = *(size_t *)(pcVar30 + 0x20);
                  pcVar30 = pcVar30 + 0x18;
                  pbVar35 = local_d0;
                } while (sVar33 != 0);
                local_d0 = pbVar35;
                pbVar29 = local_d0;
                uVar22 = *(uint *)(pcVar30 + 0x10);
                *(char *)((long)puVar12 + 10) = (char)uVar22;
                uVar22 = uVar22 & 0xff;
                lVar23 = uVar14 * 0x10 + *(long *)(param_1 + 0x18);
                uVar1 = *(uint *)(lVar23 + 0xc);
                uVar7 = uVar22;
                if (uVar22 == 2) {
                  if (1 < uVar1 - 1) {
                    if ((*(byte *)(param_1 + 0x38) & 0x40) != 0) {
                      FUN_00113c60(param_1,"syntax error: `elif\'");
                    }
                    goto LAB_00107634;
                  }
                }
                else if (uVar22 < 3) {
                  if (((uVar22 != 0) && (uVar7 = uVar1, uVar22 == 1)) &&
                     (uVar7 = uVar22, (uVar1 & 0xfffffffd) != 0)) {
                    if ((*(byte *)(param_1 + 0x38) & 0x40) != 0) {
                      FUN_00113c60(param_1,"syntax error: `if\'");
                    }
                    goto LAB_00107634;
                  }
                }
                else {
                  uVar7 = uVar1;
                  if (uVar22 == 3) {
                    if (1 < uVar1 - 1) {
                      if ((*(byte *)(param_1 + 0x38) & 0x40) != 0) {
                        FUN_00113c60(param_1,"syntax error: `else\'");
                      }
                      goto LAB_00107634;
                    }
                    uVar7 = 0;
                  }
                }
                *(uint *)(lVar23 + 0xc) = uVar7;
                bVar24 = *local_d0;
                if ((bVar24 & 0x80) == 0) {
                  plVar10 = (long *)FUN_00104d70();
                  do {
                    if ((*(byte *)(*plVar10 + 1 + (ulong)bVar24 * 2) & 0x20) == 0) break;
                    pbVar29 = pbVar29 + 1;
                    bVar24 = *pbVar29;
                    local_d0 = pbVar29;
                  } while ((bVar24 & 0x80) == 0);
                }
                if (bVar24 == 0x75) {
                  uVar22 = FUN_001065c0("invalid",pbVar29 + 1,&local_d0);
                  *(char *)((long)puVar12 + 6) = (char)uVar22;
                  if ((char)uVar22 == '\0') {
                    uVar22 = FUN_00106320(local_d0,&local_d0);
                    *(char *)((long)puVar12 + 6) = (char)uVar22;
                    pbVar29 = local_d0;
                    if ((char)uVar22 == '\0') goto LAB_001078ed;
                  }
                  uVar14 = (ulong)uVar22;
                  *(byte *)((long)puVar12 + 2) = *(byte *)((long)puVar12 + 2) | 8;
LAB_00107b2f:
                  *(undefined *)((long)puVar12 + 9) = 0;
                  if (*local_d0 != 0x7e) goto LAB_00107b3c;
                  if (((byte)uVar14 < 0x2f) && ((0x6200001e2020U >> (uVar14 & 0x3f) & 1) != 0)) {
LAB_00108dc4:
                    if ((*(byte *)(param_1 + 0x38) & 0x40) != 0) {
                      FUN_00113c60(param_1,"\'~\' invalid for string types");
                    }
                  }
                  else {
                    *(undefined *)((long)puVar12 + 9) = 0x40;
                  }
                  local_d0 = local_d0 + 1;
                  *(undefined4 *)(puVar12 + 3) = 0;
                  bVar24 = *(byte *)((long)puVar12 + 6);
                  if (bVar24 != 0xd) goto LAB_00107b50;
LAB_00107fb8:
                  local_118 = local_d0;
                  *(undefined4 *)((long)puVar12 + 0x1c) = 0x80;
                  bVar24 = *local_d0;
                  iVar6 = FUN_001059c0((int)(char)bVar24);
                  uVar14 = (ulong)bVar24;
                  if (iVar6 != -1) {
                    if (iVar6 == 6) {
                      plVar10 = (long *)FUN_00104d70();
                      lVar23 = *plVar10;
LAB_00108187:
                      uVar14 = (ulong)local_118[1];
                      bVar36 = false;
                      uVar5 = *(ushort *)(lVar23 + uVar14 * 2);
                      do {
                        while( true ) {
                          pbVar29 = local_118;
                          cVar18 = (char)uVar14;
                          local_118 = pbVar29 + 1;
                          if ((uVar5 & 0x2000) != 0) goto LAB_00108961;
                          if (false) goto switchD_001081c2_caseD_a;
                          switch((int)uVar14 - 0x30U & 0xff) {
                          case 0:
                          case 1:
                          case 2:
                          case 3:
                          case 4:
                          case 5:
                          case 6:
                          case 7:
                          case 8:
                          case 9:
                            if ((bVar36) && ((*(byte *)(param_1 + 0x38) & 0x40) != 0)) {
                              FUN_00113c60(param_1,"multiple ranges");
                            }
                            uVar14 = strtoul((char *)local_118,(char **)local_a8,0);
                            *(int *)(puVar12 + 3) = (int)uVar14;
                            if ((int)uVar14 == 0) {
                              FUN_00113c60(param_1,"zero range");
                            }
                            lVar23 = *plVar10;
                            bVar36 = true;
                            pbVar29 = local_a8[0] + -1;
                            pbVar35 = local_a8[0];
                            break;
                          default:
                            goto switchD_001081c2_caseD_a;
                          case 0x12:
                            if (*(char *)((long)puVar12 + 6) != '\r') {
                              iVar6 = 0x42;
                              goto LAB_00108314;
                            }
                            *(uint *)((long)puVar12 + 0x1c) =
                                 *(uint *)((long)puVar12 + 0x1c) & 0xfffff07f | 0x80;
                            pbVar35 = pbVar29 + 2;
                            pbVar29 = local_118;
                            break;
                          case 0x13:
                            *(uint *)((long)puVar12 + 0x1c) = *(uint *)((long)puVar12 + 0x1c) | 8;
                            pbVar35 = pbVar29 + 2;
                            pbVar29 = local_118;
                            break;
                          case 0x18:
                            if (*(char *)((long)puVar12 + 6) != '\r') {
                              iVar6 = 0x48;
                              goto LAB_00108314;
                            }
                            *(uint *)((long)puVar12 + 0x1c) =
                                 *(uint *)((long)puVar12 + 0x1c) & 0xfffff07f | 0x100;
                            pbVar35 = pbVar29 + 2;
                            pbVar29 = local_118;
                            break;
                          case 0x1a:
                            if (*(char *)((long)puVar12 + 6) != '\r') {
                              iVar6 = 0x4a;
                              goto LAB_00108314;
                            }
                            *(uint *)((long)puVar12 + 0x1c) =
                                 *(uint *)((long)puVar12 + 0x1c) | 0x1000;
                            pbVar35 = pbVar29 + 2;
                            pbVar29 = local_118;
                            break;
                          case 0x1c:
                            if (*(char *)((long)puVar12 + 6) != '\r') {
                              iVar6 = 0x4c;
                              goto LAB_00108314;
                            }
                            *(uint *)((long)puVar12 + 0x1c) =
                                 *(uint *)((long)puVar12 + 0x1c) & 0xfffff07f | 0x400;
                            pbVar35 = pbVar29 + 2;
                            pbVar29 = local_118;
                            break;
                          case 0x24:
                            *(uint *)((long)puVar12 + 0x1c) =
                                 *(uint *)((long)puVar12 + 0x1c) | 0x2000;
                            pbVar35 = pbVar29 + 2;
                            pbVar29 = local_118;
                            break;
                          case 0x27:
                            *(uint *)((long)puVar12 + 0x1c) = *(uint *)((long)puVar12 + 0x1c) | 1;
                            pbVar35 = pbVar29 + 2;
                            pbVar29 = local_118;
                            break;
                          case 0x32:
                            *(uint *)((long)puVar12 + 0x1c) = *(uint *)((long)puVar12 + 0x1c) | 0x40
                            ;
                            pbVar35 = pbVar29 + 2;
                            pbVar29 = local_118;
                            break;
                          case 0x33:
                            *(uint *)((long)puVar12 + 0x1c) = *(uint *)((long)puVar12 + 0x1c) | 4;
                            pbVar35 = pbVar29 + 2;
                            pbVar29 = local_118;
                            break;
                          case 0x38:
                            if (*(char *)((long)puVar12 + 6) != '\r') {
                              iVar6 = 0x68;
                              goto LAB_00108314;
                            }
                            *(uint *)((long)puVar12 + 0x1c) =
                                 *(uint *)((long)puVar12 + 0x1c) & 0xfffff07f | 0x200;
                            pbVar35 = pbVar29 + 2;
                            pbVar29 = local_118;
                            break;
                          case 0x3c:
                            if ((*(char *)((long)puVar12 + 6) - 0xdU & 0xfb) != 0) {
                              iVar6 = 0x6c;
                              goto LAB_00108314;
                            }
                            *(uint *)((long)puVar12 + 0x1c) =
                                 *(uint *)((long)puVar12 + 0x1c) & 0xfffff07f | 0x800;
                            pbVar35 = pbVar29 + 2;
                            pbVar29 = local_118;
                            break;
                          case 0x43:
                            *(uint *)((long)puVar12 + 0x1c) = *(uint *)((long)puVar12 + 0x1c) | 0x10
                            ;
                            pbVar35 = pbVar29 + 2;
                            pbVar29 = local_118;
                            break;
                          case 0x44:
                            *(uint *)((long)puVar12 + 0x1c) = *(uint *)((long)puVar12 + 0x1c) | 0x20
                            ;
                            pbVar35 = pbVar29 + 2;
                            pbVar29 = local_118;
                            break;
                          case 0x47:
                            *(uint *)((long)puVar12 + 0x1c) = *(uint *)((long)puVar12 + 0x1c) | 2;
                            pbVar35 = pbVar29 + 2;
                            pbVar29 = local_118;
                          }
                          bVar24 = pbVar29[1];
                          uVar14 = (ulong)bVar24;
                          if (bVar24 == 0x2f) break;
                          uVar5 = *(ushort *)(lVar23 + (ulong)bVar24 * 2);
                          local_118 = pbVar29;
                        }
                        uVar14 = (ulong)pbVar29[2];
                        uVar5 = *(ushort *)(lVar23 + uVar14 * 2);
                        local_118 = pbVar35;
                      } while ((uVar5 & 0x2000) == 0);
                      local_118 = pbVar29 + 1;
                      cVar18 = '/';
                      if ((*(byte *)(lVar23 + 0x5f) & 0x20) == 0) {
switchD_001081c2_caseD_a:
                        iVar6 = (int)cVar18;
LAB_00108314:
                        if ((*(byte *)(param_1 + 0x38) & 0x40) != 0) {
                          FUN_00113c60(param_1,"string modifier `%c\' invalid",iVar6);
                        }
                      }
                      else {
LAB_00108961:
                        if ((*(byte *)(param_1 + 0x38) & 0x40) == 0) goto LAB_001089b7;
                        cVar18 = *(char *)((long)puVar12 + 6);
                        uVar22 = *(uint *)((long)puVar12 + 0x1c);
                        if (cVar18 == '\x11') {
                          if (((uVar22 & 0x800) == 0) && ((uVar22 & 0xf80) != 0)) {
LAB_00109071:
                            FUN_00113c60(param_1,
                                         "\'/BHhLl\' modifiers are only allowed for pascal strings\n"
                                        );
                          }
                          else {
switchD_001089a7_caseD_11:
                            if ((uVar22 & 1) == 0) {
                              if ((uVar22 & 2) == 0) goto LAB_001089b7;
                              FUN_00113c60(param_1,"\'/%c\' not allowed on regex\n",0x77);
                            }
                            else {
                              FUN_00113c60(param_1,"\'/%c\' not allowed on regex\n",0x57);
                            }
                          }
                        }
                        else if (cVar18 == '\r') {
switchD_001089a7_caseD_5:
                          if ((uVar22 & 0x10) == 0) goto LAB_001089b7;
                          FUN_00113c60(param_1,"\'/%c\' only allowed on regex and search\n",0x73);
                        }
                        else {
                          if ((uVar22 & 0xf80) != 0) goto LAB_00109071;
                          if (false) {
switchD_001089a7_caseD_6:
                            FUN_00113c60(param_1,"coding error: m->type=%d\n",cVar18);
                          }
                          else {
                            switch(cVar18) {
                            case '\x05':
                              goto switchD_001089a7_caseD_5;
                            default:
                              goto switchD_001089a7_caseD_6;
                            case '\x11':
                              goto switchD_001089a7_caseD_11;
                            case '\x12':
                            case '\x13':
                              if (uVar22 == 0) {
LAB_001089b7:
                                uVar14 = (ulong)pbVar29[1];
                                local_d0 = local_118;
                                goto LAB_00107bf0;
                              }
                              FUN_00113c60(param_1,"no modifiers allowed for 16-bit strings\n");
                              break;
                            case '\x14':
                              if (*(int *)(puVar12 + 3) != 0) goto LAB_001089b7;
                              FUN_00113c60(param_1,"missing range; defaulting to %d\n",100);
                              *(undefined4 *)(puVar12 + 3) = 100;
                            }
                          }
                        }
                      }
                    }
                    else {
LAB_00107ff2:
                      if ((*(byte *)(param_1 + 0x38) & 0x40) != 0) {
                        FUN_00113c60(param_1,"invalid string/indirect op: `%c\'",
                                     (int)(char)*local_c8);
                      }
                    }
                    goto LAB_00107634;
                  }
                }
                else {
                  uVar22 = FUN_001065c0("invalid",pbVar29,&local_d0);
                  pbVar29 = local_d0;
                  *(char *)((long)puVar12 + 6) = (char)uVar22;
                  uVar14 = (ulong)uVar22;
                  if ((char)uVar22 != '\0') goto LAB_00107b2f;
                  if (*local_d0 == 100) {
                    uVar22 = FUN_00106320(local_d0,&local_d0);
                    *(char *)((long)puVar12 + 6) = (char)uVar22;
                    uVar14 = (ulong)uVar22;
                    pbVar29 = local_d0;
                    if ((char)uVar22 == '\0') goto LAB_001078ed;
                    goto LAB_00107b2f;
                  }
                  if ((*local_d0 != 0x73) ||
                     (plVar10 = (long *)FUN_00104d70(),
                     (*(byte *)(*plVar10 + 1 + (ulong)pbVar29[1] * 2) & 4) != 0)) {
LAB_001078ed:
                    uVar22 = FUN_001065c0(&DAT_0011bcc0,pbVar29,&local_d0);
                    *(char *)((long)puVar12 + 6) = (char)uVar22;
                    uVar14 = (ulong)uVar22;
                    if ((char)uVar22 == '\0') {
                      if ((*(byte *)(param_1 + 0x38) & 0x40) != 0) {
                        FUN_00113c60(param_1,"type `%s\' invalid",local_d0);
                      }
                      goto LAB_00107634;
                    }
                    goto LAB_00107b2f;
                  }
                  local_d0 = pbVar29 + 1;
                  *(undefined *)((long)puVar12 + 6) = 5;
                  *(undefined *)((long)puVar12 + 9) = 0;
                  if (pbVar29[1] == 0x7e) goto LAB_00108dc4;
LAB_00107b3c:
                  bVar24 = *(byte *)((long)puVar12 + 6);
                  *(undefined4 *)(puVar12 + 3) = 0;
                  if (bVar24 == 0xd) goto LAB_00107fb8;
LAB_00107b50:
                  local_118 = local_d0;
                  *(undefined4 *)((long)puVar12 + 0x1c) = 0;
                  bVar28 = *local_d0;
                  iVar6 = FUN_001059c0((int)(char)bVar24);
                  uVar14 = (ulong)bVar28;
                  if (iVar6 != -1) {
                    if ((0x2e < bVar24) || ((0x6200001e0020U >> ((ulong)bVar24 & 0x3f) & 1) == 0)) {
                      *(byte *)((long)puVar12 + 9) = *(byte *)((long)puVar12 + 9) | (byte)iVar6;
                      local_c0 = local_118 + 1;
                      uVar11 = strtoull((char *)local_c0,(char **)local_a8,0);
                      local_c0 = local_a8[0];
                      if ((*(byte *)((long)puVar12 + 2) & 8) == 0) {
                        uVar11 = FUN_00106f60(param_1,puVar12, 0x00);
                      }
                      puVar12[3] = uVar11;
                      FUN_00106620(&local_c0);
                      local_d0 = local_c0;
                      uVar14 = (ulong)*local_c0;
                      local_118 = local_c0;
                      goto LAB_00107bf0;
                    }
                    if (iVar6 != 6) goto LAB_00107ff2;
                    plVar10 = (long *)FUN_00104d70();
                    lVar23 = *plVar10;
                    pbVar29 = local_118;
                    if (bVar24 == 0x29) {
                      while( true ) {
                        bVar24 = pbVar29[1];
                        local_118 = pbVar29 + 1;
                        if ((*(byte *)(lVar23 + 1 + (ulong)bVar24 * 2) & 0x20) != 0) break;
                        if (bVar24 != 0x72) {
                          if ((*(byte *)(param_1 + 0x38) & 0x40) != 0) {
                            FUN_00113c60(param_1,"indirect modifier `%c\' invalid",(int)(char)bVar24
                                        );
                          }
                          goto LAB_00107634;
                        }
                        *(uint *)((long)puVar12 + 0x1c) = *(uint *)((long)puVar12 + 0x1c) | 1;
                        pbVar29 = local_118;
                      }
                      uVar14 = (ulong)pbVar29[1];
                      local_d0 = local_118;
                      goto LAB_00107bf0;
                    }
                    goto LAB_00108187;
                  }
                }
LAB_00107bf0:
                if ((uVar14 & 0x80) == 0) {
                  plVar10 = (long *)FUN_00104d70();
                  do {
                    if ((*(byte *)(*plVar10 + 1 + uVar14 * 2) & 0x20) == 0) break;
                    local_118 = local_118 + 1;
                    uVar14 = (ulong)*local_118;
                    local_d0 = local_118;
                  } while ((*local_118 & 0x80) == 0);
                }
                cVar18 = (char)uVar14;
                if (cVar18 < '?') {
                  if ((cVar18 < '!') || (false)) goto switchD_00107c71_caseD_1;
                  switch((int)uVar14 - 0x21U & 0xff) {
                  case 0:
                    local_d0 = local_118 + 1;
                    *(char *)((long)puVar12 + 4) = cVar18;
                    break;
                  default:
                    goto switchD_00107c71_caseD_1;
                  case 5:
                  case 0x1c:
                    goto switchD_00107c71_caseD_5;
                  case 0x1b:
                  case 0x1d:
                    local_d0 = local_118 + 1;
                    *(char *)((long)puVar12 + 4) = cVar18;
                    if (local_118[1] == 0x3d) {
                      if ((*(byte *)(param_1 + 0x38) & 0x40) != 0) {
                        FUN_00113c60(param_1,"%c= not supported",uVar14);
                        goto LAB_00107634;
                      }
                      goto LAB_001082eb;
                    }
                  }
LAB_00108216:
                  if (cVar18 != 'x') goto LAB_001080eb;
                }
                else {
                  if (cVar18 == '^') {
switchD_00107c71_caseD_5:
                    local_d0 = local_118 + 1;
                    *(char *)((long)puVar12 + 4) = cVar18;
                    if (local_118[1] == 0x3d) {
LAB_001082eb:
                      local_d0 = local_118 + 2;
                    }
                    goto LAB_00108216;
                  }
switchD_00107c71_caseD_1:
                  *(undefined *)((long)puVar12 + 4) = 0x3d;
                  if (((*local_118 == 0x78) && (bVar24 = local_118[1], (bVar24 & 0x80) == 0)) &&
                     ((plVar10 = (long *)FUN_00104d70(),
                      (*(byte *)(*plVar10 + 1 + (ulong)bVar24 * 2) & 0x20) != 0 || (bVar24 == 0))))
                  {
                    *(undefined *)((long)puVar12 + 4) = 0x78;
                    local_d0 = local_118 + 1;
                  }
                  else {
LAB_001080eb:
                    pbVar29 = local_d0;
                    if (false) {
switchD_0010810b_caseD_6:
                      piVar15 = __errno_location();
                      *piVar15 = 0;
                      uVar11 = strtoull((char *)pbVar29,(char **)local_a8,0);
                      if ((*(byte *)((long)puVar12 + 2) & 8) == 0) {
                        uVar11 = FUN_00106f60(param_1,puVar12, 0x00);
                      }
                      puVar12[4] = uVar11;
                      if (*piVar15 == 0) {
                        local_d0 = local_a8[0];
                        FUN_00106620(&local_d0);
                      }
                    }
                    else {
                      switch(*(undefined *)((long)puVar12 + 6)) {
                      case 5:
                      case 0xd:
                      case 0x11:
                      case 0x12:
                      case 0x13:
                      case 0x14:
                      case 0x2d:
                      case 0x2e:
                      case 0x30:
                        bVar24 = *local_d0;
                        bVar36 = param_2 == 2;
                        pbVar35 = (byte *)(puVar12 + 4);
                        pbVar34 = pbVar35;
                        pbVar17 = local_d0;
                        if (bVar24 != 0) {
                          plVar10 = (long *)FUN_00104d70();
                          pbVar17 = pbVar29;
                          while( true ) {
                            pbVar25 = pbVar17 + 1;
                            if ((*(byte *)(*plVar10 + 1 + (ulong)bVar24 * 2) & 0x20) != 0) break;
                            if ((byte *)((long)puVar12 + 0x7f) == pbVar34) {
                              FUN_00114dc0(param_1,0,"string too long: `%s\'");
                              local_d0 = (byte *)0x0;
                              if ((*(byte *)(param_1 + 0x38) & 0x40) != 0) {
                                FUN_00113c60(param_1,"cannot get string from `%s\'",pbVar35);
                              }
                              goto LAB_00107634;
                            }
                            if (bVar24 != 0x5c) {
                              *pbVar34 = bVar24;
                              pbVar17 = pbVar25;
                              goto LAB_001085ba;
                            }
                            bVar24 = pbVar17[1];
                            iVar6 = (int)(char)bVar24;
                            pbVar31 = pbVar17 + 2;
                            if (false) {
switchD_0010861c_caseD_1:
                              if (bVar36) {
                                if ((*(byte *)(*plVar10 + 1 + (ulong)bVar24 * 2) & 0x40) == 0) {
                                  FUN_00113c60(param_1,"unknown escape sequence: \\%03o");
                                }
                                else {
                                  pcVar30 = strchr("<>&^=!",iVar6);
                                  if ((pcVar30 == (char *)0x0) &&
                                     ((*(char *)((long)puVar12 + 6) != '\x11' ||
                                      (pcVar30 = strchr("[]().*?^$|{}",iVar6),
                                      pcVar30 == (char *)0x0)))) {
                                    FUN_00113c60(param_1,"no need to escape `%c\'",iVar6);
                                  }
                                }
                              }
                              goto switchD_0010861c_caseD_20;
                            }
                            switch(bVar24) {
                            case 0:
                              pbVar17 = pbVar25;
                              if (bVar36) {
                                FUN_00113c60(param_1,"incomplete escape");
                              }
                              goto LAB_001088cb;
                            default:
                              goto switchD_0010861c_caseD_1;
                            case 9:
                              if (bVar36) {
                                FUN_00113c60(param_1,"escaped tab found, use \\t instead");
                                bVar36 = false;
                              }
                            case 0x20:
                            case 0x21:
                            case 0x26:
                            case 0x3c:
                            case 0x3d:
                            case 0x3e:
                            case 0x5c:
                            case 0x5e:
switchD_0010861c_caseD_20:
                              *pbVar34 = bVar24;
                              pbVar17 = pbVar31;
                              break;
                            case 0x30:
                            case 0x31:
                            case 0x32:
                            case 0x33:
                            case 0x34:
                            case 0x35:
                            case 0x36:
                            case 0x37:
                              bVar24 = (byte)(iVar6 + -0x30);
                              if ((int)(char)pbVar17[2] - 0x30U < 8) {
                                uVar22 = (iVar6 + -0x30) * 8 | (int)(char)pbVar17[2] - 0x30U;
                                bVar24 = (byte)uVar22;
                                if ((int)(char)pbVar17[3] - 0x30U < 8) {
                                  pbVar31 = pbVar17 + 4;
                                  bVar24 = (byte)(uVar22 << 3) |
                                           (byte)((int)(char)pbVar17[3] - 0x30U);
                                }
                                else {
                                  pbVar31 = pbVar17 + 3;
                                }
                              }
                              *pbVar34 = bVar24;
                              pbVar17 = pbVar31;
                              break;
                            case 0x61:
                              *pbVar34 = 7;
                              pbVar17 = pbVar31;
                              break;
                            case 0x62:
                              *pbVar34 = 8;
                              pbVar17 = pbVar31;
                              break;
                            case 0x66:
                              *pbVar34 = 0xc;
                              pbVar17 = pbVar31;
                              break;
                            case 0x6e:
                              *pbVar34 = 10;
                              pbVar17 = pbVar31;
                              break;
                            case 0x72:
                              *pbVar34 = 0xd;
                              pbVar17 = pbVar31;
                              break;
                            case 0x74:
                              *pbVar34 = 9;
                              pbVar17 = pbVar31;
                              break;
                            case 0x76:
                              *pbVar34 = 0xb;
                              pbVar17 = pbVar31;
                              break;
                            case 0x78:
                              iVar6 = FUN_00106c00((int)(char)pbVar17[2]);
                              if (-1 < iVar6) {
                                iVar8 = FUN_00106c00((int)(char)pbVar17[3]);
                                bVar24 = (byte)iVar6;
                                if (iVar8 < 0) {
                                  pbVar31 = pbVar17 + 3;
                                }
                                else {
                                  pbVar31 = pbVar17 + 4;
                                  bVar24 = bVar24 * '\x10' + (char)iVar8;
                                }
                              }
                              *pbVar34 = bVar24;
                              pbVar17 = pbVar31;
                            }
LAB_001085ba:
                            pbVar34 = pbVar34 + 1;
                            bVar24 = *pbVar17;
                            if (bVar24 == 0) break;
                          }
                        }
LAB_001088cb:
                        *pbVar34 = 0;
                        cVar18 = (char)pbVar34 - (char)pbVar35;
                        *(char *)((long)puVar12 + 5) = cVar18;
                        if (*(char *)((long)puVar12 + 6) == '\r') {
                          cVar4 = FUN_00107460(puVar12);
                          *(char *)((long)puVar12 + 5) = cVar18 + cVar4;
                          local_d0 = pbVar17;
                        }
                        else {
                          local_d0 = pbVar17;
                          if (*(char *)((long)puVar12 + 6) == '\x11') {
                            iVar6 = FUN_00115b70(local_a8,pbVar35,1);
                            if (iVar6 != 0) {
                              if ((*(byte *)(param_1 + 0x38) & 0x40) != 0) {
                                FUN_00115c70(local_a8,iVar6,param_1);
                              }
                              FUN_00115c30(local_a8);
                              goto LAB_00107634;
                            }
                            FUN_00115c30(local_a8,0);
                          }
                        }
                        goto LAB_0010821f;
                      default:
                        goto switchD_0010810b_caseD_6;
                      case 0x21:
                      case 0x22:
                      case 0x23:
                        piVar15 = __errno_location();
                        *piVar15 = 0;
                        fVar38 = strtof((char *)pbVar29,(char **)local_a8);
                        *(float *)(puVar12 + 4) = fVar38;
                        iVar6 = *piVar15;
                        break;
                      case 0x24:
                      case 0x25:
                      case 0x26:
                        piVar15 = __errno_location();
                        *piVar15 = 0;
                        dVar39 = strtod((char *)pbVar29,(char **)local_a8);
                        puVar12[4] = dVar39;
                        iVar6 = *piVar15;
                      }
                      if (iVar6 == 0) {
                        local_d0 = local_a8[0];
                      }
                    }
                  }
                }
LAB_0010821f:
                pbVar29 = local_d0;
                bVar24 = *local_d0;
                if ((bVar24 & 0x80) == 0) {
                  plVar10 = (long *)FUN_00104d70();
                  do {
                    if ((*(byte *)(*plVar10 + 1 + (ulong)bVar24 * 2) & 0x20) == 0) break;
                    pbVar29 = pbVar29 + 1;
                    bVar24 = *pbVar29;
                    local_d0 = pbVar29;
                  } while ((bVar24 & 0x80) == 0);
                }
                if (bVar24 == 8) {
                  *(byte *)((long)puVar12 + 2) = *(byte *)((long)puVar12 + 2) | 0x10;
                  local_d0 = pbVar29 + 1;
                }
                else if ((bVar24 == 0x5c) && (pbVar29[1] == 0x62)) {
                  *(byte *)((long)puVar12 + 2) = *(byte *)((long)puVar12 + 2) | 0x10;
                  local_d0 = pbVar29 + 2;
                }
                lVar23 = 0;
                pbVar29 = local_d0;
                do {
                  local_d0 = pbVar29 + 1;
                  bVar24 = *pbVar29;
                  lVar13 = lVar23 + 1;
                  *(byte *)((long)puVar12 + lVar23 + 0x80) = bVar24;
                  if (bVar24 == 0) {
                    if (lVar13 != 0x40) goto LAB_001082b0;
                    break;
                  }
                  lVar23 = lVar13;
                  pbVar29 = local_d0;
                } while (lVar13 != 0x40);
                *(undefined *)((long)puVar12 + 0xbf) = 0;
                if ((*(byte *)(param_1 + 0x38) & 0x40) != 0) {
                  FUN_00113c60(param_1,"description `%s\' truncated",puVar12 + 0x10);
LAB_001082b0:
                  if ((*(byte *)(param_1 + 0x38) & 0x40) != 0) {
                    cVar18 = *(char *)(puVar12 + 0x10);
                    puVar26 = puVar12 + 0x10;
                    puVar16 = puVar26;
                    if (cVar18 != '\0') {
LAB_00108ac0:
                      if (cVar18 != '%') goto LAB_00108ab0;
                      bVar24 = *(byte *)((long)puVar12 + 6);
                      if (bVar24 < 0x31) {
                        uVar14 = (ulong)bVar24;
                        iVar6 = *(int *)(&DAT_00124500 + uVar14 * 4);
                        if (iVar6 == 0) {
                          FUN_00113c60(param_1,"No format string for `%s\' with description `%s\'",
                                       puVar26,*(undefined8 *)(&DAT_001245e0 + uVar14 * 8));
                        }
                        else {
                          bVar28 = *(byte *)((long)puVar16 + 1);
                          uVar19 = (ulong)bVar28;
                          pbVar29 = (byte *)((long)puVar16 + 1);
                          if (bVar28 == 0) {
                            pcVar30 = "missing format spec";
                          }
                          else {
                            if (iVar6 == 3) {
                              bVar36 = true;
                              iVar6 = 0;
LAB_00108bdb:
                              pbVar35 = pbVar29;
                              bVar24 = bVar28;
                              if (bVar28 == 0x2d) {
                                bVar24 = *(byte *)((long)puVar16 + 2);
                                pbVar35 = (byte *)((long)puVar16 + 2);
                              }
                              if (bVar24 == 0x2e) {
                                bVar24 = pbVar35[1];
                                pbVar35 = pbVar35 + 1;
                              }
                              plVar10 = (long *)FUN_00104d70();
                              uVar27 = 0;
                              lVar23 = *plVar10;
                              uVar19 = 0;
                              while ((*(byte *)(lVar23 + 1 + (ulong)bVar24 * 2) & 8) != 0) {
                                iVar8 = (int)(char)bVar24;
                                bVar24 = pbVar35[1];
                                pbVar35 = pbVar35 + 1;
                                uVar27 = uVar27 + 1;
                                uVar19 = (long)(iVar8 + -0x30) + uVar19 * 10;
                              }
                              if ((5 < uVar27) || (0x400 < uVar19)) goto switchD_00108cbe_caseD_59;
                              pbVar34 = pbVar35;
                              if (bVar24 == 0x2e) {
                                bVar24 = pbVar35[1];
                                uVar19 = (ulong)bVar24;
                                pbVar34 = pbVar35 + 1;
                                if ((*(byte *)(lVar23 + 1 + uVar19 * 2) & 8) != 0) {
                                  uVar27 = 0;
                                  do {
                                    cVar18 = (char)uVar19;
                                    pbVar17 = pbVar34 + 1;
                                    bVar24 = *pbVar17;
                                    uVar19 = (ulong)bVar24;
                                    uVar20 = (long)pbVar34 - (long)pbVar35;
                                    uVar27 = (long)(cVar18 + -0x30) + uVar27 * 10;
                                    pbVar34 = pbVar17;
                                  } while ((*(byte *)(lVar23 + 1 + uVar19 * 2) & 8) != 0);
                                  if ((5 < uVar20) || (0x400 < uVar27))
                                  goto switchD_00108cbe_caseD_59;
                                }
                              }
                              if (((bVar36) &&
                                  ((bVar24 != 0x6c ||
                                   (pbVar35 = pbVar34 + 1, pbVar34 = pbVar34 + 2, *pbVar35 != 0x6c))
                                  )) || (false)) goto switchD_00108cbe_caseD_59;
                              switch(*pbVar34) {
                              case 0x58:
                              case 100:
                              case 0x69:
                              case 0x6f:
                              case 0x75:
                              case 0x78:
                                break;
                              default:
                                goto switchD_00108cbe_caseD_59;
                              case 99:
                                if (iVar6 != 2) goto switchD_00108cbe_caseD_59;
                              }
switchD_00108cbe_caseD_58:
                              do {
                                if (bVar28 == 0x25) {
                                  FUN_00113c60(param_1,
                                               "Too many format strings (should have at most one) for `%s\' with description `%s\'"
                                               ,*(undefined8 *)(&DAT_001245e0 + uVar14 * 8),puVar26)
                                  ;
                                  goto LAB_00107634;
                                }
                                bVar28 = pbVar29[1];
                                pbVar29 = pbVar29 + 1;
                              } while (bVar28 != 0);
                              goto LAB_001082bb;
                            }
                            if (iVar6 < 4) {
                              if (iVar6 != 1) {
                                if (iVar6 != 2) {
                                  abort_caseD_0();
                                  return;
                                }
                                pbVar35 = pbVar29;
                                if (bVar28 == 0x2d) {
                                  uVar19 = (ulong)*(byte *)((long)puVar16 + 2);
                                  pbVar35 = (byte *)((long)puVar16 + 2);
                                }
                                plVar10 = (long *)FUN_00104d70();
                                lVar23 = *plVar10;
                                while ((*(byte *)(lVar23 + 1 + uVar19 * 2) & 8) != 0) {
                                  uVar19 = (ulong)pbVar35[1];
                                  pbVar35 = pbVar35 + 1;
                                }
                                if ((char)uVar19 == '.') {
                                  uVar19 = (ulong)pbVar35[1];
                                  bVar24 = *(byte *)(lVar23 + 1 + uVar19 * 2);
                                  while ((bVar24 & 8) != 0) {
                                    uVar19 = (ulong)pbVar35[2];
                                    pbVar35 = pbVar35 + 1;
                                    bVar24 = *(byte *)(lVar23 + 1 + uVar19 * 2);
                                  }
                                }
                                if ((char)uVar19 != 's') goto switchD_00108cbe_caseD_59;
                                goto switchD_00108cbe_caseD_58;
                              }
                              if (false) {
code_r0x00104d94:
                    // WARNING: Subroutine does not return
                                abort();
                              }
                              switch(bVar24) {
                              default:
                                goto code_r0x00104d94;
                              case 1:
                                bVar36 = false;
                                iVar6 = 2;
                                break;
                              case 2:
                              case 7:
                              case 10:
                                bVar36 = false;
                                iVar6 = 1;
                                break;
                              case 4:
                              case 8:
                              case 0xb:
                              case 0x17:
                              case 0x27:
                              case 0x28:
                              case 0x29:
                                bVar36 = false;
                                iVar6 = 0;
                              }
                              goto LAB_00108bdb;
                            }
                            if (1 < iVar6 - 4U) {
                              abort_caseD_0();
                              return;
                            }
                            pbVar35 = pbVar29;
                            if (bVar28 == 0x2d) {
                              uVar19 = (ulong)*(byte *)((long)puVar16 + 2);
                              pbVar35 = (byte *)((long)puVar16 + 2);
                            }
                            if ((char)uVar19 == '.') {
                              uVar19 = (ulong)pbVar35[1];
                              pbVar35 = pbVar35 + 1;
                            }
                            plVar10 = (long *)FUN_00104d70();
                            uVar20 = 0;
                            lVar23 = *plVar10;
                            uVar27 = 0;
                            while (cVar18 = (char)uVar19,
                                  (*(byte *)(lVar23 + 1 + uVar19 * 2) & 8) != 0) {
                              uVar19 = (ulong)pbVar35[1];
                              pbVar35 = pbVar35 + 1;
                              uVar20 = uVar20 + 1;
                              uVar27 = (long)(cVar18 + -0x30) + uVar27 * 10;
                            }
                            if ((uVar20 < 6) && (uVar27 < 0x401)) {
                              if ((cVar18 == '.') &&
                                 (uVar19 = (ulong)pbVar35[1],
                                 (*(byte *)(lVar23 + 1 + uVar19 * 2) & 8) != 0)) {
                                uVar27 = 0;
                                uVar20 = 0;
                                do {
                                  uVar21 = uVar20 + 1;
                                  uVar27 = (long)((char)uVar19 + -0x30) + uVar27 * 10;
                                  uVar19 = (ulong)pbVar35[uVar20 + 2];
                                  uVar20 = uVar21;
                                } while ((*(byte *)(lVar23 + 1 + uVar19 * 2) & 8) != 0);
                                if ((5 < uVar21) || (0x400 < uVar27))
                                goto switchD_00108cbe_caseD_59;
                              }
                              cVar18 = (char)uVar19;
                              if (cVar18 < 'H') {
                                if (cVar18 < 'E') goto switchD_00108cbe_caseD_59;
                              }
                              else if (2 < (byte)(cVar18 + 0x9bU)) goto switchD_00108cbe_caseD_59;
                              goto switchD_00108cbe_caseD_58;
                            }
switchD_00108cbe_caseD_59:
                            pcVar30 = "too long";
                          }
                          FUN_00113c60(param_1,
                                       "Printf format is %s for type `%s\' in description `%s\'",
                                       pcVar30,*(undefined8 *)(&DAT_001245e0 + uVar14 * 8),puVar26);
                        }
                      }
                      else {
                        FUN_00113c60(param_1,
                                     "Internal error inconsistency between m->type and format strings"
                                    );
                      }
                      goto LAB_00107634;
                    }
                  }
                }
LAB_001082bb:
                if (param_2 == 1) {
                  FUN_00113e90(puVar12);
                }
                *(undefined *)(puVar12 + 0x18) = 0;
                goto LAB_0010763c;
              }
              if ((*(byte *)(param_1 + 0x38) & 0x40) != 0) {
                FUN_00113c60(param_1,"offset `%s\' invalid");
              }
            }
          }
LAB_00107634:
          *param_4 = *param_4 + 1;
        }
      }
LAB_0010763c:
      *(long *)(param_1 + 0x48) = *(long *)(param_1 + 0x48) + 1;
    }
    if (*(undefined8 *)(local_b8 + 0) != 0) {
      FUN_00105ec0(param_1,local_b8,param_5);
    }
    free(local_d8);
    fclose(__stream);
  }
  if (local_40 != *(long *)(in_FS_OFFSET + 0x28)) {
                    // WARNING: Subroutine does not return
    __stack_chk_fail();
  }
  return;
code_r0x00107a2c:
  FUN_00105ec0(param_1,local_b8,param_5);
  goto LAB_001075e1;
LAB_00108ab0:
  cVar18 = *(char *)((long)puVar16 + 1);
  puVar16 = (undefined8 *)((long)puVar16 + 1);
  if (cVar18 == '\0') goto LAB_001082bb;
  goto LAB_00108ac0;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

void * FUN_001092d0(long param_1,char *param_2,int param_3)

{
  long lVar1;
  byte bVar2;
  int iVar3;
  uint uVar4;
  short *psVar5;
  char *pcVar6;
  long *plVar7;
  undefined8 *puVar8;
  void *pvVar9;
  DIR *__dirp;
  dirent *pdVar10;
  ulong uVar11;
  long lVar12;
  size_t sVar13;
  uint *puVar14;
  ulong uVar15;
  undefined *puVar16;
  char *pcVar17;
  uint uVar18;
  uint uVar19;
  short *psVar20;
  size_t sVar21;
  ulong uVar22;
  undefined8 *puVar23;
  long in_FS_OFFSET;
  void *local_140;
  long *local_130;
  void *local_128;
  long local_120;
  long *local_110;
  int local_104;
  char *local_100;
  undefined local_f8 [16] = {0};
  undefined local_e8 [16] = {0};
  struct stat local_d8;
  long local_40;
  
  local_40 = *(long *)(in_FS_OFFSET + 0x28);
  *(uint *)(param_1 + 0x38) = *(uint *)(param_1 + 0x38) | 0x40;
  local_104 = 0;
  local_128 = calloc(1,0x30);
  if (local_128 == (void *)0x0) {
    FUN_00115200(param_1,0x30);
  }
  else {
    *(undefined4 *)((long)local_128 + 0x10) = 1;
    if (param_3 == 1) {
      __fprintf_chk(_stderr,1,"%s\n","cont\toffset\ttype\topcode\tmask\tvalue\tdesc");
    }
    iVar3 = __xstat(1,param_2,&local_d8);
    if ((iVar3 == 0) && ((local_d8.st_mode & 0xf000) == 0x4000)) {
      __dirp = opendir(param_2);
      if (__dirp != (DIR *)0x0) {
        local_140 = (void *)0x0;
        uVar15 = 0;
        local_130 = (long *)0x0;
        do {
          pdVar10 = readdir(__dirp);
          while( true ) {
            if (pdVar10 == (dirent *)0x0) {
              closedir(__dirp);
              qsort(local_140,uVar15,8,FUN_00105f70);
              if (uVar15 != 0) {
                uVar11 = 0;
                do {
                  puVar23 = (undefined8 *)((long)local_140 + uVar11 * 8);
                  FUN_001074d0(param_1,param_3,*puVar23,&local_104,local_f8);
                  free((void *)*puVar23);
                  uVar11 = (ulong)((int)uVar11 + 1);
                } while (uVar11 < uVar15);
              }
              free(local_140);
              goto LAB_001093a0;
            }
            iVar3 = __asprintf_chk(&local_100,1,"%s/%s",param_2,pdVar10->d_name);
            if (iVar3 < 0) {
              sVar21 = strlen(param_2);
              sVar13 = strlen(pdVar10->d_name);
              FUN_00115200(param_1,sVar21 + 2 + sVar13);
              local_104 = local_104 + 1;
              closedir(__dirp);
              goto LAB_0010977e;
            }
            iVar3 = __xstat(1,local_100,&local_d8);
            if ((iVar3 == -1) || ((local_d8.st_mode & 0xf000) != 0x8000)) break;
            if (local_130 <= uVar15) {
              lVar12 = (long)local_130 + 1;
              local_130 = (long *)(lVar12 * 2);
              sVar21 = lVar12 * 0x10;
              local_140 = realloc(local_140,sVar21);
              if (local_140 == (void *)0x0) {
                FUN_00115200(param_1,sVar21);
                free(local_100);
                closedir(__dirp);
                goto LAB_00109a97;
              }
            }
            *(char **)((long)local_140 + uVar15 * 8) = local_100;
            uVar15 = uVar15 + 1;
            pdVar10 = readdir(__dirp);
          }
          free(local_100);
        } while( true );
      }
LAB_00109a97:
      local_104 = local_104 + 1;
    }
    else {
      FUN_001074d0(param_1,param_3,param_2,&local_104,local_f8);
LAB_001093a0:
      local_110 = (long *)local_f8;
      if (local_104 == 0) {
        local_120 = 0;
        local_130 = local_110;
LAB_001093bf:
        uVar15 = 0;
        uVar18 = *(uint *)(local_130 + 1);
        puVar23 = (undefined8 *)*local_130;
        if (uVar18 != 0) {
LAB_001093f7:
          do {
            lVar12 = uVar15 * 2;
            psVar5 = (short *)puVar23[lVar12];
            if (*psVar5 == 0) {
              uVar11 = (ulong)((int)uVar15 + 1);
              puVar8 = puVar23 + uVar11 * 2;
              psVar20 = psVar5;
              uVar22 = uVar15;
              do {
                uVar15 = uVar11;
                if (true) {
                  switch(*(undefined *)(psVar5 + 3)) {
                  case 1:
                  case 2:
                  case 4:
                  case 6:
                  case 7:
                  case 8:
                  case 9:
                  case 10:
                  case 0xb:
                  case 0xc:
                  case 0xe:
                  case 0xf:
                  case 0x10:
                  case 0x15:
                  case 0x16:
                  case 0x17:
                  case 0x18:
                  case 0x19:
                  case 0x1a:
                  case 0x1b:
                  case 0x1c:
                  case 0x1d:
                  case 0x1e:
                  case 0x1f:
                  case 0x20:
                  case 0x21:
                  case 0x22:
                  case 0x23:
                  case 0x24:
                  case 0x25:
                  case 0x26:
                  case 0x2a:
                  case 0x2b:
                  case 0x2c:
                  case 0x30:
switchD_00109438_caseD_1:
                    *(byte *)(psVar20 + 1) = *(byte *)(psVar20 + 1) | 0x20;
                    break;
                  case 5:
                  case 0xd:
                  case 0x12:
                  case 0x13:
                    bVar2 = *(byte *)(psVar20 + 1) | 0x40;
                    if ((*(byte *)(psVar20 + 0xe) & 0x20) == 0) {
                      bVar2 = *(byte *)(psVar20 + 1) | 0x20;
                    }
                    *(byte *)(psVar20 + 1) = bVar2;
                    break;
                  case 0x11:
                  case 0x14:
                    bVar2 = *(byte *)(psVar20 + 1);
                    if ((*(uint *)(psVar20 + 0xe) & 0x40) != 0) {
                      bVar2 = bVar2 | 0x20;
                      *(byte *)(psVar20 + 1) = bVar2;
                    }
                    if ((*(uint *)(psVar20 + 0xe) & 0x20) != 0) {
                      bVar2 = bVar2 | 0x40;
                      *(byte *)(psVar20 + 1) = bVar2;
                    }
                    if ((bVar2 & 0x60) == 0) {
                      iVar3 = FUN_0010e410(psVar5 + 0x10,*(undefined *)((long)psVar5 + 5),0,0);
                      if (iVar3 < 1) goto switchD_00109438_caseD_1;
                      *(byte *)(psVar20 + 1) = *(byte *)(psVar20 + 1) | 0x40;
                    }
                  }
                }
                if ((*(byte *)(param_1 + 0x38) & 1) != 0) {
                  pcVar6 = "text";
                  pcVar17 = "(no description)";
                  lVar1 = puVar23[uVar22 * 2];
                  if ((*(byte *)(lVar1 + 2) & 0x20) != 0) {
                    pcVar6 = "binary";
                  }
                  if (*(char *)(lVar1 + 0x80) != '\0') {
                    pcVar17 = (char *)(lVar1 + 0x80);
                  }
                  puVar16 = &DAT_0011ddf7;
                  if (*(char *)(lVar1 + 0xc0) != '\0') {
                    puVar16 = &DAT_0011c77d;
                  }
                  __fprintf_chk(_stderr,1,"%s%s%s: %s\n",lVar1 + 0xc0,puVar16,pcVar17,pcVar6);
                  lVar1 = puVar23[uVar22 * 2];
                  if ((*(byte *)(lVar1 + 2) & 0x20) != 0) {
                    pcVar17 = (char *)(lVar1 + 0x80);
                    pcVar6 = strstr(pcVar17,"text");
                    if (((pcVar6 != (char *)0x0) &&
                        ((pcVar17 == pcVar6 ||
                         (plVar7 = (long *)FUN_00104d70(),
                         (*(byte *)(*plVar7 + 1 + (ulong)(byte)pcVar6[-1] * 2) & 0x20) != 0)))) &&
                       ((pcVar6 + -0x5b == pcVar17 ||
                        ((bVar2 = pcVar6[5], bVar2 == 0 ||
                         (plVar7 = (long *)FUN_00104d70(),
                         (*(byte *)(*plVar7 + 1 + (ulong)bVar2 * 2) & 0x20) != 0)))))) {
                      fwrite("*** Possible binary test for text type\n",1,0x27,_stderr);
                    }
                  }
                }
                uVar4 = (uint)uVar15;
                if (uVar18 <= uVar4) goto LAB_00109610;
                psVar5 = (short *)*puVar8;
                puVar8 = puVar8 + 2;
                if (*psVar5 == 0) goto LAB_00109610;
                psVar20 = (short *)puVar23[lVar12];
                uVar11 = (ulong)(uVar4 + 1);
                uVar22 = uVar15;
              } while( true );
            }
            uVar4 = (int)uVar15 + 1;
            uVar15 = (ulong)uVar4;
          } while (uVar4 < uVar18);
          goto LAB_0010962d;
        }
        uVar18 = 0;
        if (puVar23 != (undefined8 *)0x0) goto LAB_00109637;
        goto LAB_00109891;
      }
    }
LAB_0010977e:
    local_110 = (long *)local_f8;
    do {
      puVar23 = (undefined8 *)*local_110;
      if (puVar23 != (undefined8 *)0x0) {
        iVar3 = *(int *)(local_110 + 1);
        if (iVar3 != 0) {
          puVar8 = puVar23;
          do {
            pvVar9 = (void *)*puVar8;
            puVar8 = puVar8 + 2;
            free(pvVar9);
          } while (puVar23 + (ulong)(iVar3 - 1) * 2 + 2 != puVar8);
        }
        free(puVar23);
      }
      local_110 = local_110 + 2;
    } while (&local_d8 != (struct stat *)local_110);
    if (local_104 != 0) {
      FUN_00105a40(local_128);
      local_128 = (void *)0x0;
    }
  }
  if (local_40 == *(long *)(in_FS_OFFSET + 0x28)) {
    return local_128;
  }
                    // WARNING: Subroutine does not return
  __stack_chk_fail();
LAB_00109610:
  puVar23 = (undefined8 *)*local_130;
  uVar18 = *(uint *)(local_130 + 1);
  if (uVar18 <= uVar4) goto LAB_0010962d;
  goto LAB_001093f7;
LAB_0010962d:
  if (puVar23 != (undefined8 *)0x0) {
LAB_00109637:
    qsort(puVar23,(ulong)uVar18,0x10,FUN_00106290);
    puVar23 = (undefined8 *)*local_130;
    uVar18 = *(uint *)(local_130 + 1);
  }
  if (uVar18 != 0) {
    uVar15 = 0;
    puVar8 = puVar23;
    do {
      uVar4 = (int)uVar15 + 1;
      if ((*(ulong *)*puVar8 & 0xff00000000ffff) == 0x3000000000000) {
        puVar8 = puVar23 + (ulong)uVar4 * 2;
        goto LAB_001096c1;
      }
      puVar8 = puVar8 + 2;
      uVar15 = (ulong)uVar4;
    } while (uVar18 != uVar4);
    goto LAB_001096cf;
  }
LAB_00109891:
  pvVar9 = malloc(0);
  *(void **)((long)local_128 + local_120 * 2 + 0x18) = pvVar9;
  if (pvVar9 == (void *)0x0) {
    sVar21 = 0;
LAB_00109b13:
    FUN_00115200(param_1,sVar21);
    local_104 = local_104 + 1;
    goto LAB_0010977e;
  }
  uVar19 = 0;
LAB_00109756:
  local_130 = local_130 + 2;
  *(uint *)((long)local_128 + local_120 + 0x28) = uVar19;
  local_120 = local_120 + 4;
  if (local_120 == 8) goto LAB_0010977e;
  goto LAB_001093bf;
  while( true ) {
    psVar5 = (short *)*puVar8;
    puVar8 = puVar8 + 2;
    if (*psVar5 == 0) break;
LAB_001096c1:
    uVar4 = (int)uVar15 + 1;
    uVar15 = (ulong)uVar4;
    if (uVar18 <= uVar4) {
      if (uVar18 == uVar4) goto LAB_001096cf;
      psVar5 = (short *)puVar23[uVar15 * 2];
      break;
    }
  }
  *(ulong *)(param_1 + 0x48) = (ulong)*(uint *)(psVar5 + 10);
  FUN_00113c60(param_1,"level 0 \"default\" did not sort last");
  uVar18 = *(uint *)(local_130 + 1);
  if (uVar18 != 0) {
    puVar23 = (undefined8 *)*local_130;
LAB_001096cf:
    uVar15 = 0;
    uVar4 = 0;
    puVar14 = (uint *)(puVar23 + 1);
    do {
      uVar4 = uVar4 + 1;
      uVar15 = (ulong)((int)uVar15 + *puVar14);
      puVar14 = puVar14 + 4;
    } while (uVar4 < uVar18);
    sVar21 = uVar15 * 0x158;
    pvVar9 = malloc(sVar21);
    *(void **)((long)local_128 + local_120 * 2 + 0x18) = pvVar9;
    if (pvVar9 == (void *)0x0) goto LAB_00109b13;
    uVar15 = 0;
    uVar4 = 0;
    puVar14 = (uint *)(puVar23 + 1);
    while( true ) {
      uVar4 = uVar4 + 1;
      memcpy((void *)(uVar15 * 0x158 + (long)pvVar9),*(void **)(puVar14 + -2),
             (ulong)*puVar14 * 0x158);
      uVar19 = (int)uVar15 + *puVar14;
      uVar15 = (ulong)uVar19;
      if (uVar18 <= uVar4) break;
      pvVar9 = *(void **)((long)local_128 + local_120 * 2 + 0x18);
      puVar14 = puVar14 + 4;
    }
    goto LAB_00109756;
  }
  goto LAB_00109891;
}



undefined4 FUN_00109b50(long *param_1,undefined8 param_2,uint param_3)

{
  char cVar1;
  int iVar2;
  int iVar3;
  char *pcVar4;
  char *__ptr;
  void *pvVar5;
  char *pcVar6;
  undefined8 *puVar7;
  long lVar8;
  int *piVar9;
  ulong uVar10;
  char *pcVar11;
  char *pcVar12;
  int iVar13;
  undefined4 uVar14;
  long in_FS_OFFSET;
  byte bVar15;
  struct stat local_d8;
  long local_40;
  
  bVar15 = 0;
  local_40 = *(long *)(in_FS_OFFSET + 0x28);
  if (*param_1 != 0) {
    FUN_001157e0(0x02);
  }
  pcVar4 = (char *)magic_getpath(param_2,param_3);
  if (pcVar4 == (char *)0x0) {
    uVar14 = 0xffffffff;
  }
  else {
    FUN_00106800();
    __ptr = strdup(pcVar4);
    if (__ptr == (char *)0x0) {
      uVar10 = 0xffffffffffffffff;
      uVar14 = 0xffffffff;
      do {
        if (uVar10 == 0) break;
        uVar10 = uVar10 - 1;
        cVar1 = *pcVar4;
        pcVar4 = pcVar4 + (ulong)bVar15 * -2 + 1;
      } while (cVar1 != '\0');
      FUN_00115200(param_1,~uVar10 - 1);
    }
    else {
      FUN_00105af0(*param_1);
      pvVar5 = calloc(1,0x28);
      if (pvVar5 == (void *)0x0) {
        *param_1 = 0;
        FUN_00115200(param_1,0x28);
      }
      else {
        *(void **)((long)pvVar5 + 0x20) = pvVar5;
        lVar8 = param_1[1];
        *(void **)((long)pvVar5 + 0x18) = pvVar5;
        *param_1 = (long)pvVar5;
        FUN_00105af0(lVar8);
        pvVar5 = calloc(1,0x28);
        if (pvVar5 != (void *)0x0) {
          *(void **)((long)pvVar5 + 0x20) = pvVar5;
          iVar13 = -1;
          *(void **)((long)pvVar5 + 0x18) = pvVar5;
          param_1[1] = (long)pvVar5;
          pcVar4 = __ptr;
          do {
            pcVar12 = (char *)0x0;
            pcVar6 = strchr(pcVar4,0x3a);
            if (pcVar6 != (char *)0x0) {
              *pcVar6 = '\0';
              pcVar12 = pcVar6 + 1;
            }
            if (*pcVar4 == '\0') break;
            if (param_3 == 2) {
              lVar8 = FUN_001092d0(param_1,pcVar4,2);
              if (lVar8 == 0) {
LAB_0010a05b:
                iVar2 = -1;
                goto LAB_00109e03;
              }
              iVar2 = FUN_00106a90(param_1,lVar8,pcVar4);
              if (iVar13 < iVar2) {
                iVar13 = iVar2;
              }
            }
            else {
              puVar7 = (undefined8 *)calloc(1,0x30);
              if (puVar7 == (undefined8 *)0x0) {
                FUN_00115200(param_1,0x30);
                FUN_00105a40(0);
LAB_00109d9f:
                bVar15 = *(byte *)(param_1 + 7);
joined_r0x00109f3c:
                if ((bVar15 & 0x40) != 0) {
                  FUN_00113c60(param_1,"using regular magic file `%s\'",pcVar4);
                }
                puVar7 = (undefined8 *)FUN_001092d0(param_1,pcVar4,param_3);
                if (puVar7 == (undefined8 *)0x0) goto LAB_0010a05b;
LAB_00109dca:
                iVar2 = FUN_00105b40(*param_1,puVar7,0);
                if ((iVar2 != -1) && (iVar2 = FUN_00105b40(param_1[1],puVar7,1), iVar2 != -1)) {
                  if (param_3 == 3) {
                    __printf_chk(1,"Set %zu:\nBinary patterns:\n",0);
                    FUN_001066c0(*param_1,0x20);
                    puts("Text patterns:");
                    FUN_001066c0(*param_1,0x40);
                    __printf_chk(1,"Set %zu:\nBinary patterns:\n",1);
                    FUN_001066c0(param_1[1],0x20);
                    puts("Text patterns:");
                    FUN_001066c0(param_1[1],0x40);
                  }
                  iVar2 = 0;
                  goto LAB_00109e03;
                }
                FUN_00115200(param_1,0x28);
              }
              else {
                *(undefined4 *)(puVar7 + 2) = 0;
                pcVar6 = (char *)FUN_001068c0(param_1 + 7,pcVar4,0);
                if (pcVar6 == (char *)0x0) {
                  FUN_00105a40(puVar7);
                  bVar15 = *(byte *)(param_1 + 7);
                  goto joined_r0x00109f3c;
                }
                iVar2 = open(pcVar6,0);
                if (iVar2 == -1) {
LAB_00109d8f:
                  FUN_00105a40(puVar7);
                  free(pcVar6);
                  goto LAB_00109d9f;
                }
                iVar3 = __fxstat(1,iVar2,&local_d8);
                if (iVar3 == -1) {
                  piVar9 = __errno_location();
                  pcVar11 = "cannot stat `%s\'";
LAB_00109fbf:
                  FUN_00114dc0(param_1,*piVar9,pcVar11);
LAB_00109d87:
                  close(iVar2);
                  goto LAB_00109d8f;
                }
                if (local_d8.st_size < 8) {
                  FUN_00114dc0(param_1,0,"file `%s\' is too %s");
                  goto LAB_00109d87;
                }
                puVar7[1] = local_d8.st_size;
                *(undefined4 *)(puVar7 + 2) = 2;
                pvVar5 = mmap((void *)0x0,local_d8.st_size,3,2,iVar2,0);
                *puVar7 = pvVar5;
                if (pvVar5 == (void *)0xffffffffffffffff) {
                  piVar9 = __errno_location();
                  pcVar11 = "cannot map `%s\'";
                  goto LAB_00109fbf;
                }
                close(iVar2);
                iVar2 = FUN_00105bb0(param_1,puVar7,pcVar6);
                if (iVar2 == 0) {
                  iVar2 = mprotect((void *)*puVar7,local_d8.st_size,1);
                  if (iVar2 == -1) {
                    piVar9 = __errno_location();
                    FUN_00114dc0(param_1,*piVar9,"cannot mprotect `%s\'");
                    FUN_00105a40(puVar7);
                    free(pcVar6);
                    goto LAB_00109d9f;
                  }
                  free(pcVar6);
                  goto LAB_00109dca;
                }
                FUN_00105a40(puVar7);
                free(pcVar6);
              }
              FUN_00105af0(*param_1);
              *param_1 = 0;
              FUN_00105af0(param_1[1]);
              param_1[1] = 0;
              iVar2 = -1;
LAB_00109e03:
              if (iVar13 < iVar2) {
                iVar13 = iVar2;
              }
            }
            pcVar4 = pcVar12;
          } while (pcVar12 != (char *)0x0);
          free(__ptr);
          if (iVar13 == -1) {
            FUN_00105af0(*param_1);
            *param_1 = 0;
            FUN_00105af0(param_1[1]);
            param_1[1] = 0;
            FUN_00114dc0(param_1,0,"could not find any valid magic files!");
            uVar14 = 0xffffffff;
          }
          else if (param_3 < 4) {
            uVar14 = 0;
          }
          else {
            uVar14 = 0xffffffff;
            FUN_00114dc0(param_1,0,"Invalid action %d");
          }
          goto LAB_00109f01;
        }
        param_1[1] = 0;
        FUN_00115200(param_1,0x28);
        FUN_00105af0(*param_1);
        *param_1 = 0;
      }
      uVar14 = 0xffffffff;
      free(__ptr);
    }
  }
LAB_00109f01:
  if (local_40 == *(long *)(in_FS_OFFSET + 0x28)) {
    return uVar14;
  }
                    // WARNING: Subroutine does not return
  __stack_chk_fail();
}



ulong FUN_0010a130(long param_1,uint *param_2)

{
  uint uVar1;
  long lVar2;
  ulong uVar3;
  
  uVar1 = *(uint *)(param_1 + 0x1c) & 0xf80;
  if (uVar1 == 0x200) {
    uVar3 = (ulong)*(ushort *)param_2;
  }
  else if (uVar1 < 0x201) {
    if (uVar1 == 0x80) {
      uVar3 = (ulong)*(byte *)param_2;
    }
    else {
      if (uVar1 != 0x100) {
        return -1;
      }
      uVar3 = (ulong)(ushort)(*(ushort *)param_2 << 8 | *(ushort *)param_2 >> 8);
    }
  }
  else if (uVar1 == 0x400) {
    uVar1 = *param_2;
    uVar3 = (ulong)(int)(uVar1 >> 0x18 | (uVar1 & 0xff0000) >> 8 | (uVar1 & 0xff00) << 8 |
                        uVar1 << 0x18);
  }
  else {
    if (uVar1 != 0x800) {
      return -1;
    }
    uVar3 = (ulong)(int)*param_2;
  }
  if ((*(uint *)(param_1 + 0x1c) & 0x1000) != 0) {
    lVar2 = FUN_00107460();
    return uVar3 - lVar2;
  }
  return uVar3;
}



int FUN_0010a1c0(long param_1,char *param_2,long *param_3)

{
  uint uVar1;
  long *plVar2;
  long *plVar3;
  long lVar4;
  int iVar5;
  long lVar6;
  short *psVar7;
  uint uVar8;
  int iVar9;
  uint uVar10;
  
  plVar2 = *(long **)(param_1 + 8);
  plVar3 = (long *)plVar2[3];
  do {
    if (plVar2 == plVar3) {
      return -1;
    }
    uVar1 = *(uint *)(plVar3 + 1);
    lVar4 = *plVar3;
    if (uVar1 != 0) {
      uVar10 = 0;
      lVar6 = lVar4;
      do {
        if (*(char *)(lVar6 + 6) == '-') {
          iVar5 = strcmp((char *)(lVar6 + 0x20),param_2);
          if (iVar5 == 0) {
            uVar8 = uVar10 + 1;
            *param_3 = lVar6;
            if (uVar8 < uVar1) {
              psVar7 = (short *)(lVar4 + (ulong)uVar8 * 0x158);
              goto LAB_0010a27f;
            }
            iVar9 = 1;
            goto LAB_0010a289;
          }
        }
        uVar10 = uVar10 + 1;
        lVar6 = lVar6 + 0x158;
      } while (uVar1 != uVar10);
    }
    plVar3 = (long *)plVar3[3];
  } while( true );
  while( true ) {
    uVar8 = uVar8 + 1;
    psVar7 = psVar7 + 0xac;
    if (uVar1 <= uVar8) break;
LAB_0010a27f:
    if (*psVar7 == 0) break;
  }
  iVar9 = uVar8 - uVar10;
LAB_0010a289:
  *(int *)(param_3 + 1) = iVar9;
  return iVar5;
}



undefined4 FUN_0010a2b0(long param_1,long param_2,int param_3)

{
  uint uVar1;
  int iVar2;
  
  uVar1 = *(uint *)(param_1 + 0x38);
  if (((uVar1 & 0x800) == 0) || (*(char *)(param_2 + 0x110) == '\0')) {
    if (((uVar1 & 0x1000000) == 0) || (*(char *)(param_2 + 0x118) == '\0')) {
      if ((uVar1 & 0x10) == 0) {
        return 0;
      }
      if (*(char *)(param_2 + 0xc0) == '\0') {
        return 0;
      }
      if ((param_3 == 0) && (iVar2 = FUN_00114fd0(param_1, "", &DAT_0011ce1b), iVar2 == -1)) {
        return 0xffffffff;
      }
      param_2 = param_2 + 0xc0;
    }
    else {
      if ((param_3 == 0) && (iVar2 = FUN_00114fd0(param_1, "", &DAT_0011ce1b), iVar2 == -1)) {
        return 0xffffffff;
      }
      param_2 = param_2 + 0x118;
    }
    iVar2 = FUN_00114fd0(param_1,"%s",param_2);
  }
  else {
    if ((param_3 == 0) && (iVar2 = FUN_00114fd0(param_1, "", &DAT_0011ce1b), iVar2 == -1)) {
      return 0xffffffff;
    }
    iVar2 = FUN_00114fd0(param_1,&DAT_0011ce16,param_2 + 0x110);
  }
  if (iVar2 == -1) {
    return 0xffffffff;
  }
  return 1;
}



ulong FUN_0010a3b0(undefined8 param_1,long param_2)

{
  int iVar1;
  char *pcVar2;
  ulong uVar3;
  long in_FS_OFFSET;
  undefined auStack_98 [104];
  long local_30;
  
  uVar3 = 0;
  local_30 = *(long *)(in_FS_OFFSET + 0x28);
  pcVar2 = strchr((char *)(param_2 + 0x80),0x25);
  if (pcVar2 != (char *)0x0) {
    iVar1 = FUN_00115b70(auStack_98,"%[-0-9\\.]*s",9);
    if (iVar1 == 0) {
      iVar1 = FUN_00115c10(auStack_98,(char *)(param_2 + 0x80),0,0,0);
      uVar3 = (ulong)(iVar1 == 0);
    }
    else {
      uVar3 = 0xffffffff;
      FUN_00115c70(auStack_98,iVar1,param_1);
    }
    FUN_00115c30(auStack_98);
  }
  if (local_30 == *(long *)(in_FS_OFFSET + 0x28)) {
    return uVar3;
  }
                    // WARNING: Subroutine does not return
  __stack_chk_fail();
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

undefined8 FUN_0010a470(long param_1,long param_2,ulong param_3,int *param_4)

{
  int iVar1;
  int iVar2;
  size_t sVar3;
  ulong uVar4;
  
  if (false) {
switchD_0010a4a6_caseD_0:
    iVar1 = 0;
  }
  else {
    switch(*(undefined *)(param_2 + 6)) {
    default:
      goto switchD_0010a4a6_caseD_0;
    case 1:
      iVar1 = *(int *)(param_1 + 0x30) + 1;
      uVar4 = (ulong)iVar1;
      break;
    case 2:
    case 7:
    case 10:
      iVar1 = *(int *)(param_1 + 0x30) + 2;
      uVar4 = (ulong)iVar1;
      break;
    case 3:
    case 0x29:
    case 0x2f:
      iVar1 = *(int *)(param_1 + 0x30);
      uVar4 = (ulong)iVar1;
      break;
    case 4:
    case 6:
    case 8:
    case 9:
    case 0xb:
    case 0xc:
    case 0xe:
    case 0xf:
    case 0x10:
    case 0x15:
    case 0x16:
    case 0x17:
    case 0x21:
    case 0x22:
    case 0x23:
      iVar1 = *(int *)(param_1 + 0x30) + 4;
      uVar4 = (ulong)iVar1;
      break;
    case 5:
    case 0xd:
    case 0x12:
    case 0x13:
      iVar1 = *(int *)(param_1 + 0x30);
      if ((*(char *)(param_2 + 4) == '=') || (*(char *)(param_2 + 4) == '!')) {
        iVar1 = iVar1 + (uint)*(byte *)(param_2 + 5);
        uVar4 = (ulong)iVar1;
      }
      else {
        if (*(char *)(param_2 + 0x20) == '\0') {
          sVar3 = strcspn((char *)(param_1 + 0x70),"\r\n");
          *(undefined *)(param_1 + 0x70 + sVar3) = 0;
        }
        sVar3 = strlen((char *)(param_1 + 0x70));
        iVar1 = iVar1 + (int)sVar3;
        if (*(char *)(param_2 + 6) == '\r') {
          iVar2 = FUN_00107460(param_2);
          iVar1 = iVar1 + iVar2;
        }
        uVar4 = (ulong)iVar1;
      }
      break;
    case 0x11:
      iVar1 = (int)*(undefined8 *)(param_1 + 0x60);
      if ((*(byte *)(param_2 + 0x1c) & 0x10) == 0) {
        iVar1 = iVar1 + *(int *)(param_1 + 0x68);
        uVar4 = (ulong)iVar1;
      }
      else {
LAB_0010a5ad:
        uVar4 = (ulong)iVar1;
      }
      break;
    case 0x14:
      iVar1 = (int)*(undefined8 *)(param_1 + 0x60);
      if ((*(byte *)(param_2 + 0x1c) & 0x10) != 0) goto LAB_0010a5ad;
      iVar1 = (uint)*(byte *)(param_2 + 5) + iVar1;
      uVar4 = (ulong)iVar1;
      break;
    case 0x18:
    case 0x19:
    case 0x1a:
    case 0x1b:
    case 0x1c:
    case 0x1d:
    case 0x1e:
    case 0x1f:
    case 0x20:
    case 0x24:
    case 0x25:
    case 0x26:
      iVar1 = *(int *)(param_1 + 0x30) + 8;
      uVar4 = (ulong)iVar1;
      break;
    case 0x30:
      iVar1 = FUN_001160a0(param_1,param_2,param_3);
      if ((iVar1 == -1) || (param_3 < (ulong)(long)iVar1)) {
        if ((*(byte *)(param_1 + 0x38) & 1) != 0) {
          __fprintf_chk(_stderr,1,"Bad DER offset %d nbytes=%zu",iVar1,param_3);
        }
        *param_4 = 0;
        return 0;
      }
      goto LAB_0010a4c5;
    }
    if (param_3 < uVar4) {
      return 0xffffffff;
    }
  }
LAB_0010a4c5:
  *param_4 = iVar1;
  return 1;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

uint FUN_0010a650(uint param_1,uint param_2)

{
  uint uVar1;
  
  uVar1 = param_2 >> 1 & 0x3f80 | param_2 >> 2 & 0x1fc000 | param_2 & 0x7f |
          param_2 >> 3 & 0xfe00000;
  if ((param_1 & 1) == 0) {
    return uVar1;
  }
  __fprintf_chk(_stderr,1,"id3 offs=%u\n",uVar1);
  return uVar1;
}



undefined4 FUN_0010a6c0(undefined4 param_1)

{
  if (true) {
    switch(param_1) {
    case 7:
      return 10;
    case 8:
      return 0xb;
    case 9:
      return 0xc;
    case 10:
      return 7;
    case 0xb:
      return 8;
    case 0xc:
      return 9;
    case 0xf:
      return 0x10;
    case 0x10:
      return 0xf;
    case 0x19:
      return 0x1a;
    case 0x1a:
      return 0x19;
    case 0x1c:
      return 0x1d;
    case 0x1d:
      return 0x1c;
    case 0x1f:
      return 0x20;
    case 0x20:
      return 0x1f;
    case 0x22:
      return 0x23;
    case 0x23:
      return 0x22;
    case 0x25:
      return 0x26;
    case 0x26:
      return 0x25;
    case 0x2b:
      return 0x2c;
    case 0x2c:
      return 0x2b;
    }
  }
  return param_1;
}



undefined8 FUN_0010a820(ushort *param_1,byte *param_2,long param_3)

{
  ushort uVar1;
  byte bVar2;
  
  bVar2 = *param_2;
  if (param_3 != 0) {
    uVar1 = (ushort)param_3;
    switch(bVar2 & 7) {
    case 0:
      *param_1 = *param_1 & uVar1;
      bVar2 = *param_2;
      break;
    case 1:
      *param_1 = *param_1 | uVar1;
      bVar2 = *param_2;
      break;
    case 2:
      *param_1 = *param_1 ^ uVar1;
      bVar2 = *param_2;
      break;
    case 3:
      *param_1 = *param_1 + uVar1;
      bVar2 = *param_2;
      break;
    case 4:
      *param_1 = *param_1 - uVar1;
      bVar2 = *param_2;
      break;
    case 5:
      *param_1 = uVar1 * *param_1;
      bVar2 = *param_2;
      break;
    case 6:
      if (uVar1 == 0) {
        return 0xffffffff;
      }
      *param_1 = *param_1 / uVar1;
      bVar2 = *param_2;
      break;
    case 7:
      if (uVar1 == 0) {
        return 0xffffffff;
      }
      *param_1 = *param_1 % uVar1;
      bVar2 = *param_2;
    }
  }
  if ((bVar2 & 0x40) != 0) {
    *param_1 = ~*param_1;
  }
  return 0;
}



undefined  FUN_0010a8f0(uint *param_1,byte *param_2,ulong param_3)
{
  byte bVar1;
  uint uVar2;
  ulong uVar3;
  undefined8 uVar4;
  undefined auVar5 [16];
  
  bVar1 = *param_2;
  if (param_3 != 0) {
    uVar2 = (uint)param_3;
    uVar3 = param_3 & 0xffffffff;
    switch(bVar1 & 7) {
    case 0:
      *param_1 = *param_1 & uVar2;
      bVar1 = *param_2;
      break;
    case 1:
      *param_1 = *param_1 | uVar2;
      bVar1 = *param_2;
      break;
    case 2:
      *param_1 = *param_1 ^ uVar2;
      bVar1 = *param_2;
      break;
    case 3:
      *param_1 = *param_1 + uVar2;
      bVar1 = *param_2;
      break;
    case 4:
      *param_1 = *param_1 - uVar2;
      bVar1 = *param_2;
      break;
    case 5:
      param_3 = (ulong)(uVar2 * *param_1);
      *param_1 = uVar2 * *param_1;
      bVar1 = *param_2;
      break;
    case 6:
      if (uVar2 == 0) {
LAB_0010a999:
        uVar4 = 0xffffffff;
        goto LAB_0010a931;
      }
      param_3 = (ulong)*param_1 % uVar3;
      *param_1 = (uint)(*param_1 / uVar3);
      bVar1 = *param_2;
      break;
    case 7:
      if (uVar2 == 0) goto LAB_0010a999;
      param_3 = (ulong)*param_1 % uVar3;
      *param_1 = (uint)param_3;
      bVar1 = *param_2;
    }
  }
  uVar4 = 0;
  if ((bVar1 & 0x40) != 0) {
    *param_1 = ~*param_1;
  }
LAB_0010a931:
  *(undefined8 *)(auVar5 + 8)= param_3;
  *(undefined8 *)(auVar5 + 0) = uVar4;
  return auVar5;
}



undefined8 FUN_0010a9b0(ulong *param_1,byte *param_2,ulong param_3)

{
  ulong uVar1;
  byte bVar2;
  
  bVar2 = *param_2;
  if (param_3 != 0) {
    uVar1 = *param_1;
    switch(bVar2 & 7) {
    case 0:
      *param_1 = param_3 & uVar1;
      bVar2 = *param_2;
      break;
    case 1:
      *param_1 = param_3 | uVar1;
      bVar2 = *param_2;
      break;
    case 2:
      *param_1 = param_3 ^ uVar1;
      bVar2 = *param_2;
      break;
    case 3:
      *param_1 = param_3 + uVar1;
      bVar2 = *param_2;
      break;
    case 4:
      *param_1 = uVar1 - param_3;
      bVar2 = *param_2;
      break;
    case 5:
      *param_1 = param_3 * uVar1;
      bVar2 = *param_2;
      break;
    case 6:
      *param_1 = uVar1 / param_3;
      bVar2 = *param_2;
      break;
    case 7:
      *param_1 = uVar1 % param_3;
      bVar2 = *param_2;
    }
  }
  if ((bVar2 & 0x40) != 0) {
    *param_1 = ~*param_1;
  }
  return 0;
}



undefined8 FUN_0010aa60(float *param_1,byte param_2,ulong param_3)

{
  if (param_3 != 0) {
    param_2 = param_2 & 7;
    if (param_2 == 5) {
      *param_1 = (float)param_3 * *param_1;
      return 0;
    }
    if (param_2 < 6) {
      if (param_2 == 3) {
        *param_1 = (float)param_3 + *param_1;
        return 0;
      }
      if (param_2 == 4) {
        *param_1 = *param_1 - (float)param_3;
        return 0;
      }
      return 0;
    }
    if (param_2 != 6) {
      return 0;
    }
    if ((true) && ((float)param_3 == 0.0)) {
      return 0xffffffff;
    }
    *param_1 = *param_1 / (float)param_3;
  }
  return 0;
}



undefined8 FUN_0010abc0(double *param_1,byte param_2,ulong param_3)

{
  if (param_3 != 0) {
    param_2 = param_2 & 7;
    if (param_2 == 5) {
      *param_1 = (double)param_3 * *param_1;
      return 0;
    }
    if (param_2 < 6) {
      if (param_2 == 3) {
        *param_1 = (double)param_3 + *param_1;
        return 0;
      }
      if (param_2 == 4) {
        *param_1 = *param_1 - (double)param_3;
        return 0;
      }
      return 0;
    }
    if (param_2 != 6) {
      return 0;
    }
    if ((true) && ((double)param_3 == 0.0)) {
      return 0xffffffff;
    }
    *param_1 = *param_1 / (double)param_3;
  }
  return 0;
}



ulong FUN_0010ad20(uint param_1,ulong param_2,ulong param_3)

{
  if (param_3 != 0) {
    switch(param_1 & 7) {
    case 0:
      param_2 = param_2 & param_3;
      break;
    case 1:
      param_2 = param_2 | param_3;
      break;
    case 2:
      param_2 = param_2 ^ param_3;
      break;
    case 3:
      param_2 = param_2 + param_3;
      break;
    case 4:
      param_2 = param_2 - param_3;
      break;
    case 5:
      param_2 = param_2 * param_3;
      break;
    case 6:
      param_2 = (long)param_2 / (long)param_3;
      break;
    case 7:
      param_2 = (long)param_2 % (long)param_3;
    }
  }
  if ((param_1 & 0x40) != 0) {
    param_2 = ~param_2;
  }
  return param_2 & 0xffffffff;
}



undefined8
FUN_0010adb0(long param_1,char *param_2,int param_3,int param_4,long param_5,uint param_6,
            ulong param_7,uint *param_8,uint *param_9)

{
  char cVar1;
  undefined8 uVar2;
  uint uVar3;
  char *pcVar4;
  void *pvVar5;
  ulong uVar6;
  ulong uVar7;
  undefined8 *puVar8;
  ulong uVar9;
  char *pcVar10;
  char *__s;
  bool bVar11;
  byte bVar12;
  ulong local_50;
  char *local_48;
  
  bVar12 = 0;
  if (param_4 == 0) {
    if (param_3 < 0x14) {
      if (0x11 < param_3) {
        pcVar4 = (char *)(param_5 + (ulong)param_6 + (ulong)(param_3 == 0x12));
        if (param_6 < param_7) {
          pcVar10 = param_2;
          do {
            if ((char *)(param_5 + param_7) <= pcVar4) break;
            cVar1 = *pcVar4;
            *pcVar10 = cVar1;
            if (cVar1 == '\0') {
              if (param_3 == 0x12) {
                cVar1 = pcVar4[-1];
              }
              else {
                cVar1 = pcVar4[1];
              }
              if (cVar1 != '\0') {
                *pcVar10 = ' ';
              }
            }
            pcVar10 = pcVar10 + 1;
            pcVar4 = pcVar4 + 2;
          } while (pcVar10 < param_2 + 0x5f);
          param_2[0x5f] = '\0';
          return 0;
        }
        goto LAB_0010afcb;
      }
      if (param_3 != 0x11) goto LAB_0010af10;
      if (param_5 == 0) {
        *(undefined8 *)(param_1 + 0x58) = 0;
        *(undefined8 *)(param_1 + 0x50) = 0;
        return 0;
      }
      uVar7 = (ulong)*param_8;
      if ((*param_9 & 0x800) == 0) {
        uVar9 = (ulong)param_6;
        param_7 = param_7 - uVar9;
        if (uVar7 == 0) {
          local_48 = (char *)(param_5 + uVar9);
          uVar7 = (ulong)*(ushort *)(param_1 + 0xda);
          if (param_7 < *(ushort *)(param_1 + 0xda)) {
            uVar7 = param_7;
          }
          pcVar4 = (char *)(uVar7 + uVar9 + param_5);
          goto LAB_0010b089;
        }
        bVar11 = false;
        uVar9 = 0;
        uVar6 = uVar7;
LAB_0010ae25:
        if (uVar6 < param_7) {
          param_7 = uVar6;
        }
      }
      else {
        bVar11 = uVar7 != 0;
        param_7 = param_7 - param_6;
        uVar6 = uVar7 * 0x50;
        uVar9 = uVar7;
        if (uVar7 * 5 != 0) goto LAB_0010ae25;
      }
      local_50 = (ulong)param_6;
      local_48 = (char *)(param_5 + local_50);
      if (*(ushort *)(param_1 + 0xda) <= param_7) {
        param_7 = (ulong)*(ushort *)(param_1 + 0xda);
      }
      pcVar10 = (char *)(param_7 + local_50 + param_5);
      pcVar4 = pcVar10;
      if ((local_48 < pcVar10) && (__s = local_48, bVar11)) {
        do {
          pcVar4 = (char *)memchr(__s,10,(long)pcVar10 - (long)__s);
          if ((pcVar4 == (char *)0x0) &&
             (pcVar4 = (char *)memchr(__s,0xd,(long)pcVar10 - (long)__s), pcVar4 == (char *)0x0))
          goto LAB_0010b081;
          __s = pcVar4 + 1;
          if ((*pcVar4 == '\r') && (pcVar4[1] == '\n')) {
            __s = pcVar4 + 2;
          }
          uVar9 = uVar9 - 1;
          if (uVar9 == 0) goto LAB_0010b089;
        } while (__s < pcVar10);
      }
      if (uVar9 != 0) {
LAB_0010b081:
        pcVar4 = (char *)(param_7 + param_5);
      }
LAB_0010b089:
      local_50 = (ulong)param_6;
      *(undefined8 *)(param_1 + 0x68) = 0;
      *(char **)(param_1 + 0x50) = local_48;
      *(long *)(param_1 + 0x58) = (long)pcVar4 - (long)local_48;
      *(ulong *)(param_1 + 0x60) = local_50;
      return 0;
    }
    if ((param_3 == 0x14) || (param_3 == 0x30)) {
      uVar7 = (ulong)param_6;
      if (param_7 < param_6) {
        uVar7 = param_7 & 0xffffffff;
      }
      *(ulong *)(param_1 + 0x60) = uVar7;
      *(ulong *)(param_1 + 0x50) = param_5 + uVar7;
      *(ulong *)(param_1 + 0x58) = param_7 - uVar7;
      return 0;
    }
  }
LAB_0010af10:
  uVar7 = (ulong)param_6;
  if (uVar7 < param_7) {
    puVar8 = (undefined8 *)(param_5 + uVar7);
    uVar9 = param_7 - uVar7;
    if (0x5f < uVar9) {
      uVar2 = puVar8[1];
      *(undefined8 *)param_2 = *puVar8;
      *(undefined8 *)(param_2 + 8) = uVar2;
      uVar2 = puVar8[3];
      *(undefined8 *)(param_2 + 0x10) = puVar8[2];
      *(undefined8 *)(param_2 + 0x18) = uVar2;
      uVar2 = puVar8[5];
      *(undefined8 *)(param_2 + 0x20) = puVar8[4];
      *(undefined8 *)(param_2 + 0x28) = uVar2;
      uVar2 = puVar8[7];
      *(undefined8 *)(param_2 + 0x30) = puVar8[6];
      *(undefined8 *)(param_2 + 0x38) = uVar2;
      uVar2 = puVar8[9];
      *(undefined8 *)(param_2 + 0x40) = puVar8[8];
      *(undefined8 *)(param_2 + 0x48) = uVar2;
      uVar2 = puVar8[0xb];
      *(undefined8 *)(param_2 + 0x50) = puVar8[10];
      *(undefined8 *)(param_2 + 0x58) = uVar2;
      return 0;
    }
    pvVar5 = memcpy(param_2,puVar8,uVar9);
    uVar7 = (uVar7 - param_7) + 0x60;
    puVar8 = (undefined8 *)((long)pvVar5 + uVar9);
    uVar3 = (uint)uVar7;
    if (7 < uVar3) {
      *puVar8 = 0;
      *(undefined8 *)((long)puVar8 + ((uVar7 & 0xffffffff) - 8)) = 0;
      uVar7 = (ulong)(((int)puVar8 - (int)(undefined8 *)((ulong)(puVar8 + 1) & 0xfffffffffffffff8))
                      + uVar3 >> 3);
      puVar8 = (undefined8 *)((ulong)(puVar8 + 1) & 0xfffffffffffffff8);
      for (; uVar7 != 0; uVar7 = uVar7 - 1) {
        *puVar8 = 0;
        puVar8 = puVar8 + (ulong)bVar12 * -2 + 1;
      }
      return 0;
    }
    if ((uVar7 & 4) != 0) {
      *(undefined4 *)puVar8 = 0;
      *(undefined4 *)((long)puVar8 + ((uVar7 & 0xffffffff) - 4)) = 0;
      return 0;
    }
    if (uVar3 == 0) {
      return 0;
    }
    *(undefined *)puVar8 = 0;
    if ((uVar7 & 2) == 0) {
      return 0;
    }
    *(undefined2 *)((long)puVar8 + ((uVar7 & 0xffffffff) - 2)) = 0;
    return 0;
  }
LAB_0010afcb:
  param_2[0] = '\0';
  param_2[1] = '\0';
  param_2[2] = '\0';
  param_2[3] = '\0';
  param_2[4] = '\0';
  param_2[5] = '\0';
  param_2[6] = '\0';
  param_2[7] = '\0';
  param_2[0x58] = '\0';
  param_2[0x59] = '\0';
  param_2[0x5a] = '\0';
  param_2[0x5b] = '\0';
  param_2[0x5c] = '\0';
  param_2[0x5d] = '\0';
  param_2[0x5e] = '\0';
  param_2[0x5f] = '\0';
  puVar8 = (undefined8 *)((ulong)(param_2 + 8) & 0xfffffffffffffff8);
  for (uVar7 = (ulong)(((int)param_2 -
                       (int)(undefined8 *)((ulong)(param_2 + 8) & 0xfffffffffffffff8)) + 0x60U >> 3)
      ; uVar7 != 0; uVar7 = uVar7 - 1) {
    *puVar8 = 0;
    puVar8 = puVar8 + 1;
  }
  return 0;
}



long FUN_0010b180(byte *param_1,byte *param_2,long param_3,uint param_4)

{
  byte *pbVar1;
  byte *pbVar2;
  byte bVar3;
  byte bVar4;
  int iVar5;
  long *plVar6;
  __int32_t **pp_Var7;
  long lVar8;
  long lVar9;
  ulong uVar10;
  byte *pbVar11;
  
  if (param_4 == 0) {
    lVar9 = 0;
    do {
      if (param_3 == lVar9) goto LAB_0010b1c8;
      pbVar2 = param_2 + lVar9;
      pbVar11 = param_1 + lVar9;
      lVar9 = lVar9 + 1;
      lVar8 = (long)(int)((uint)*pbVar2 - (uint)*pbVar11);
    } while (lVar8 == 0);
  }
  else {
    pbVar2 = param_1 + param_3;
    if (param_3 != 0) {
      do {
        bVar3 = *param_1;
        bVar4 = *param_2;
        uVar10 = (ulong)bVar4;
        param_1 = param_1 + 1;
        if (((param_4 & 4) == 0) ||
           (plVar6 = (long *)FUN_00104d70(), (*(byte *)(*plVar6 + 1 + (ulong)bVar3 * 2) & 2) == 0))
        {
          if (((param_4 & 8) != 0) &&
             (plVar6 = (long *)FUN_00104d70(), (*(byte *)(*plVar6 + 1 + (ulong)bVar3 * 2) & 1) != 0)
             ) {
            pp_Var7 = __ctype_toupper_loc();
            goto LAB_0010b1fb;
          }
          if ((param_4 & 1) == 0) {
LAB_0010b290:
            if ((param_4 & 2) != 0) {
              plVar6 = (long *)FUN_00104d70();
              lVar9 = *plVar6;
              if ((*(byte *)(lVar9 + 1 + (ulong)bVar3 * 2) & 0x20) != 0) {
                bVar3 = *(byte *)(lVar9 + 1 + uVar10 * 2);
                pbVar11 = param_2;
                while ((bVar3 & 0x20) != 0) {
                  pbVar1 = pbVar11 + 1;
                  pbVar11 = pbVar11 + 1;
                  bVar3 = *(byte *)(lVar9 + 1 + (ulong)*pbVar1 * 2);
                }
                goto LAB_0010b20e;
              }
            }
            iVar5 = (uint)bVar4 - (uint)bVar3;
            goto joined_r0x0010b20c;
          }
          plVar6 = (long *)FUN_00104d70();
          lVar9 = *plVar6;
          if ((*(byte *)(lVar9 + 1 + (ulong)bVar3 * 2) & 0x20) == 0) goto LAB_0010b290;
          pbVar11 = param_2 + 1;
          if ((*(byte *)(lVar9 + 1 + uVar10 * 2) & 0x20) == 0) {
            return 1;
          }
          if ((*(byte *)(lVar9 + 1 + (ulong)*param_1 * 2) & 0x20) == 0) {
            bVar3 = *(byte *)(lVar9 + 1 + (ulong)param_2[1] * 2);
            while ((bVar3 & 0x20) != 0) {
              pbVar1 = pbVar11 + 1;
              pbVar11 = pbVar11 + 1;
              bVar3 = *(byte *)(lVar9 + 1 + (ulong)*pbVar1 * 2);
            }
          }
        }
        else {
          pp_Var7 = __ctype_tolower_loc();
LAB_0010b1fb:
          iVar5 = (*pp_Var7)[uVar10] - (uint)bVar3;
joined_r0x0010b20c:
          pbVar11 = param_2 + 1;
          if ((long)iVar5 != 0) {
            return (long)iVar5;
          }
        }
LAB_0010b20e:
        param_2 = pbVar11;
      } while (pbVar2 != param_1);
    }
LAB_0010b1c8:
    lVar8 = 0;
  }
  return lVar8;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

uint FUN_0010b360(long param_1,long param_2)

{
  float fVar1;
  float fVar2;
  byte bVar3;
  size_t __size;
  long lVar4;
  uint uVar5;
  int iVar6;
  uint uVar7;
  double dVar8;
  ulong uVar9;
  void *pvVar10;
  int *piVar11;
  char *pcVar12;
  ulong uVar13;
  double dVar14;
  long lVar15;
  void *__ptr;
  ulong uVar16;
  long in_FS_OFFSET;
  bool bVar17;
  int local_b0;
  int local_ac;
  undefined local_a8 [104];
  long local_40;
  
  dVar14 = *(double *)(param_2 + 0x20);
  local_40 = *(long *)(in_FS_OFFSET + 0x28);
  if (false) {
switchD_0010b3ac_caseD_0:
    uVar7 = 0xffffffff;
    FUN_001150c0(param_1,"invalid type %d in magiccheck()");
    goto LAB_0010b3e2;
  }
  switch(*(undefined *)(param_2 + 6)) {
  default:
    goto switchD_0010b3ac_caseD_0;
  case 1:
    uVar9 = (ulong)*(byte *)(param_1 + 0x70);
    break;
  case 2:
  case 7:
  case 10:
    uVar9 = (ulong)*(ushort *)(param_1 + 0x70);
    break;
  case 3:
  case 0x2f:
    uVar9 = 0;
    dVar14 = 0.0;
    break;
  case 4:
  case 6:
  case 8:
  case 9:
  case 0xb:
  case 0xc:
  case 0xe:
  case 0xf:
  case 0x10:
  case 0x15:
  case 0x16:
  case 0x17:
    uVar9 = (ulong)*(uint *)(param_1 + 0x70);
    break;
  case 5:
  case 0xd:
    dVar14 = 0.0;
    uVar9 = FUN_0010b180(param_2 + 0x20,param_1 + 0x70,*(undefined *)(param_2 + 5),
                         *(undefined4 *)(param_2 + 0x1c));
    break;
  case 0x11:
    if (*(long *)(param_1 + 0x50) == 0) goto LAB_0010b800;
    iVar6 = FUN_00115b70(local_a8,param_2 + 0x20,
                         (-(uint)((*(uint *)(param_2 + 0x1c) & 0xc) == 0) & 0xfffffffe) + 7);
    if (iVar6 != 0) {
LAB_0010b738:
      FUN_00115c70(local_a8,iVar6,param_1);
      uVar7 = 0xffffffff;
      FUN_00115c30(local_a8);
      goto LAB_0010b3e2;
    }
    __size = *(size_t *)(param_1 + 0x58);
    if (__size == 0) {
      pvVar10 = *(void **)(param_1 + 0x50);
      __ptr = (void *)0x0;
    }
    else {
      pvVar10 = malloc(__size);
      if (pvVar10 == (void *)0x0) {
        uVar7 = 0xffffffff;
        FUN_00115c30(local_a8);
        piVar11 = __errno_location();
        FUN_00114dc0(param_1,*piVar11,"can\'t allocate %zu bytes");
        goto LAB_0010b3e2;
      }
      pvVar10 = memcpy(pvVar10,*(void **)(param_1 + 0x50),__size);
      *(undefined *)((long)pvVar10 + (__size - 1)) = 0;
      __ptr = pvVar10;
    }
    iVar6 = FUN_00115c10(local_a8,pvVar10,1,&local_b0,0);
    free(__ptr);
    if (iVar6 == 0) {
      *(long *)(param_1 + 0x50) = *(long *)(param_1 + 0x50) + (long)local_b0;
      *(long *)(param_1 + 0x60) = *(long *)(param_1 + 0x60) + (long)local_b0;
      dVar14 = 0.0;
      *(long *)(param_1 + 0x68) = (long)(local_ac - local_b0);
      FUN_00115c30(local_a8);
      uVar9 = 0;
    }
    else {
      if (iVar6 != 1) goto LAB_0010b738;
      dVar14 = 0.0;
      FUN_00115c30(local_a8);
      uVar9 = 1;
    }
    break;
  case 0x12:
  case 0x13:
    dVar14 = 0.0;
    uVar9 = FUN_0010b180(param_2 + 0x20,param_1 + 0x70,*(undefined *)(param_2 + 5),0);
    break;
  case 0x14:
    lVar4 = *(long *)(param_1 + 0x50);
    if (lVar4 == 0) goto LAB_0010b800;
    uVar13 = (ulong)*(byte *)(param_2 + 5);
    if (0x60 < *(byte *)(param_2 + 5)) {
      uVar13 = 0x60;
    }
    uVar7 = *(uint *)(param_2 + 0x18);
    uVar16 = 0;
    uVar9 = 0;
    lVar15 = lVar4;
    while( true ) {
      if (((uVar7 != 0) && (uVar7 <= uVar16)) ||
         (*(ulong *)(param_1 + 0x58) < (uVar13 - lVar4) + lVar15)) {
        dVar14 = 0.0;
        goto LAB_0010b418;
      }
      uVar9 = FUN_0010b180(param_2 + 0x20,lVar15,uVar13,*(undefined4 *)(param_2 + 0x1c));
      if (uVar9 == 0) break;
      uVar16 = uVar16 + 1;
      lVar15 = lVar15 + 1;
    }
    *(long *)(param_1 + 0x60) = *(long *)(param_1 + 0x60) + uVar16;
    dVar14 = 0.0;
    *(ulong *)(param_1 + 0x68) = uVar7 - uVar16;
    break;
  case 0x18:
  case 0x19:
  case 0x1a:
  case 0x1b:
  case 0x1c:
  case 0x1d:
  case 0x1e:
  case 0x1f:
  case 0x20:
  case 0x2a:
  case 0x2b:
  case 0x2c:
    uVar9 = *(ulong *)(param_1 + 0x70);
    break;
  case 0x21:
  case 0x22:
  case 0x23:
    bVar3 = *(byte *)(param_2 + 4);
    fVar1 = *(float *)(param_2 + 0x20);
    fVar2 = *(float *)(param_1 + 0x70);
    if (bVar3 == 0x3d) {
      uVar7 = (uint)(!NAN(fVar1) && !NAN(fVar2));
      if (fVar1 != fVar2) {
        uVar7 = 0;
      }
      goto LAB_0010b3e2;
    }
    if (bVar3 < 0x3e) {
      if (bVar3 == 0x21) {
        uVar7 = (uint)(NAN(fVar1) || NAN(fVar2));
        if (fVar1 != fVar2) {
          uVar7 = 1;
        }
        goto LAB_0010b3e2;
      }
      if (bVar3 == 0x3c) {
        uVar7 = (uint)(fVar2 < fVar1);
        goto LAB_0010b3e2;
      }
    }
    else {
      if (bVar3 == 0x3e) {
        uVar7 = (uint)(fVar1 < fVar2);
        goto LAB_0010b3e2;
      }
      if (bVar3 == 0x78) goto switchD_0010b3ac_caseD_29;
    }
    FUN_001150c0(param_1,"cannot happen with float: invalid relation `%c\'");
    uVar7 = 0xffffffff;
    goto LAB_0010b3e2;
  case 0x24:
  case 0x25:
  case 0x26:
    bVar3 = *(byte *)(param_2 + 4);
    dVar8 = *(double *)(param_1 + 0x70);
    if (bVar3 == 0x3d) {
      uVar7 = (uint)(!NAN(dVar8) && !NAN(dVar14));
      if (dVar8 != dVar14) {
        uVar7 = 0;
      }
      goto LAB_0010b3e2;
    }
    if (bVar3 < 0x3e) {
      if (bVar3 == 0x21) {
        uVar7 = (uint)(NAN(dVar8) || NAN(dVar14));
        if (dVar8 != dVar14) {
          uVar7 = 1;
        }
        goto LAB_0010b3e2;
      }
      if (bVar3 == 0x3c) {
        uVar7 = (uint)(dVar8 < dVar14);
        goto LAB_0010b3e2;
      }
    }
    else {
      if (bVar3 == 0x3e) {
        uVar7 = (uint)(dVar14 < dVar8);
        goto LAB_0010b3e2;
      }
      if (bVar3 == 0x78) goto switchD_0010b3ac_caseD_29;
    }
    FUN_001150c0(param_1,"cannot happen with double: invalid relation `%c\'");
    uVar7 = 0xffffffff;
    goto LAB_0010b3e2;
  case 0x29:
  case 0x2d:
  case 0x2e:
    goto switchD_0010b3ac_caseD_29;
  case 0x30:
    uVar7 = FUN_00116150(param_1,param_2);
    if (uVar7 != 0xffffffff) goto LAB_0010b3e2;
    if ((*(byte *)(param_1 + 0x38) & 1) != 0) {
      fwrite("EOF comparing DER entries",1,0x19,_stderr);
    }
LAB_0010b800:
    uVar7 = 0;
    goto LAB_0010b3e2;
  }
LAB_0010b418:
  dVar8 = (double)FUN_00107300(param_1,param_2,uVar9);
  bVar3 = *(byte *)(param_2 + 4);
  if (0x3e < bVar3) {
    if (bVar3 == 0x5e) {
      uVar7 = (uint)((double)((ulong)dVar14 & (ulong)dVar8) != dVar14);
      if ((*(byte *)(param_1 + 0x38) & 1) == 0) goto LAB_0010b3e2;
      pcVar12 = "((%llx & %llx) != %llx) = %d\n";
LAB_0010b532:
      __fprintf_chk(_stderr,1,pcVar12,dVar8,dVar14,dVar14,uVar7);
      goto LAB_0010b3e2;
    }
    if (bVar3 == 0x78) {
      uVar7 = *(uint *)(param_1 + 0x38) & 1;
      if (uVar7 == 0) {
switchD_0010b3ac_caseD_29:
        uVar7 = 1;
      }
      else {
        __fprintf_chk(_stderr,1,"%llu == *any* = 1\n");
      }
      goto LAB_0010b3e2;
    }
switchD_0010b45b_caseD_22:
    uVar7 = 0xffffffff;
    FUN_001150c0(param_1,"cannot happen: invalid relation `%c\'");
    goto LAB_0010b3e2;
  }
  if ((bVar3 < 0x21) || (false)) goto switchD_0010b45b_caseD_22;
  switch(bVar3) {
  case 0x21:
    bVar17 = dVar14 != dVar8;
    pcVar12 = "%llu != %llu = %d\n";
    bVar3 = *(byte *)(param_1 + 0x38);
    goto joined_r0x0010b4c8;
  default:
    goto switchD_0010b45b_caseD_22;
  case 0x26:
    uVar7 = (uint)((double)((ulong)dVar14 & (ulong)dVar8) == dVar14);
    if ((*(byte *)(param_1 + 0x38) & 1) == 0) goto LAB_0010b3e2;
    pcVar12 = "((%llx & %llx) == %llx) = %d\n";
    goto LAB_0010b532;
  case 0x3c:
    uVar5 = *(uint *)(param_1 + 0x38) & 1;
    if ((*(byte *)(param_2 + 2) & 8) != 0) {
      pcVar12 = "%llu < %llu = %d\n";
      bVar17 = (ulong)dVar8 < (ulong)dVar14;
      goto joined_r0x0010b8d9;
    }
    uVar7 = (uint)((long)dVar8 < (long)dVar14);
    if (uVar5 == 0) goto LAB_0010b3e2;
    pcVar12 = "%lld < %lld = %d\n";
    break;
  case 0x3d:
    bVar17 = dVar14 == dVar8;
    pcVar12 = "%llu == %llu = %d\n";
    bVar3 = *(byte *)(param_1 + 0x38);
joined_r0x0010b4c8:
    uVar7 = (uint)bVar17;
    if ((bVar3 & 1) == 0) goto LAB_0010b3e2;
    break;
  case 0x3e:
    uVar5 = *(uint *)(param_1 + 0x38) & 1;
    if ((*(byte *)(param_2 + 2) & 8) == 0) {
      pcVar12 = "%lld > %lld = %d\n";
      bVar17 = (long)dVar14 < (long)dVar8;
    }
    else {
      bVar17 = (ulong)dVar14 < (ulong)dVar8;
      pcVar12 = "%llu > %llu = %d\n";
    }
joined_r0x0010b8d9:
    uVar7 = (uint)bVar17;
    if (uVar5 == 0) goto LAB_0010b3e2;
  }
  __fprintf_chk(_stderr,1,pcVar12,dVar8,dVar14,uVar7);
LAB_0010b3e2:
  if (local_40 == *(long *)(in_FS_OFFSET + 0x28)) {
    return uVar7;
  }
                    // WARNING: Subroutine does not return
  __stack_chk_fail();
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

void FUN_0010baa0(undefined4 param_1,undefined8 param_2)

{
  __fprintf_chk(_stderr,1,"mget/%zu @%d: ",0x60,param_1);
  FUN_00107320(_stderr,param_2,0x60);
  fputc(10,_stderr);
  fputc(10,_stderr);
  return;
}



long FUN_0010bb00(undefined8 param_1,long param_2,long param_3,undefined8 param_4,undefined8 param_5
                 )

{
  long lVar1;
  
  lVar1 = FUN_0011a440(param_2 + 0x80,param_3);
  if (param_3 != lVar1) {
    return lVar1;
  }
  FUN_001150c0(param_1,"%s, %zu: format `%s\' does not match with `%s\'");
  return lVar1;
}



ulong FUN_0010bb70(long param_1,long param_2)

{
  float fVar1;
  byte bVar2;
  undefined uVar3;
  undefined2 uVar4;
  undefined4 uVar5;
  int iVar6;
  size_t sVar7;
  long *plVar8;
  byte *pbVar9;
  undefined8 uVar10;
  undefined *puVar11;
  undefined *puVar12;
  long lVar13;
  char *pcVar14;
  ulong uVar15;
  byte *pbVar16;
  undefined8 uVar17;
  byte *__s;
  long in_FS_OFFSET;
  undefined local_2d8 [32];
  undefined local_2b8 [128];
  undefined local_238 [520];
  long local_30;
  
  local_30 = *(long *)(in_FS_OFFSET + 0x28);
  if (false) {
switchD_0010bbb6_caseD_0:
    FUN_001150c0(param_1,"invalid m->type (%d) in mprint()");
    uVar15 = 0xffffffff;
    goto LAB_0010bc16;
  }
  switch(*(undefined *)(param_2 + 6)) {
  default:
    goto switchD_0010bbb6_caseD_0;
  case 1:
    uVar3 = FUN_00107300(param_1,param_2,*(undefined *)(param_1 + 0x70));
    iVar6 = FUN_0010a3b0(param_1,param_2);
    if (iVar6 != -1) {
      if (iVar6 == 1) {
        __snprintf_chk(local_2b8,0x80,1,0x80,"%d",uVar3);
        uVar17 = FUN_0010bb00(param_1,param_2,"%s","softmagic.c",0x1ce);
        iVar6 = FUN_00114fd0(param_1,uVar17,local_2b8);
      }
      else {
        uVar17 = FUN_0010bb00(param_1,param_2,"%d","softmagic.c",0x1d2);
        iVar6 = FUN_00114fd0(param_1,uVar17,uVar3);
      }
      if (iVar6 != -1) {
        uVar15 = (ulong)*(uint *)(param_1 + 0x30) + 1;
        goto LAB_0010bc14;
      }
    }
    break;
  case 2:
  case 7:
  case 10:
    uVar4 = FUN_00107300(param_1,param_2,*(undefined2 *)(param_1 + 0x70));
    iVar6 = FUN_0010a3b0(param_1,param_2);
    if (iVar6 != -1) {
      if (iVar6 == 1) {
        __snprintf_chk(local_2b8,0x80,1,0x80,"%u",uVar4);
        uVar17 = FUN_0010bb00(param_1,param_2,"%s","softmagic.c",0x1e4);
        iVar6 = FUN_00114fd0(param_1,uVar17,local_2b8);
      }
      else {
        uVar17 = FUN_0010bb00(param_1,param_2,"%u","softmagic.c",0x1e8);
        iVar6 = FUN_00114fd0(param_1,uVar17,uVar4);
      }
      if (iVar6 != -1) {
        uVar15 = (ulong)*(uint *)(param_1 + 0x30) + 2;
        goto LAB_0010bc14;
      }
    }
    break;
  case 3:
  case 0x2f:
    lVar13 = param_2 + 0x80;
    pcVar14 = "%s";
    goto LAB_0010be07;
  case 4:
  case 8:
  case 0xb:
  case 0x17:
    uVar5 = FUN_00107300(param_1,param_2,*(undefined4 *)(param_1 + 0x70));
    iVar6 = FUN_0010a3b0(param_1,param_2);
    if (iVar6 == -1) break;
    if (iVar6 == 1) {
      puVar11 = local_2b8;
      __snprintf_chk(puVar11,0x80,1,0x80,"%u",uVar5);
      uVar17 = 0x1fa;
      goto LAB_0010bbdb;
    }
    uVar17 = FUN_0010bb00(param_1,param_2,"%u","softmagic.c",0x1fe);
    iVar6 = FUN_00114fd0(param_1,uVar17,uVar5);
    goto joined_r0x0010be89;
  case 5:
  case 0xd:
  case 0x12:
  case 0x13:
    if ((*(char *)(param_2 + 4) == '=') || (*(char *)(param_2 + 4) == '!')) {
      uVar17 = FUN_00115ef0(local_238,0x200,param_2 + 0x20);
      uVar10 = FUN_0010bb00(param_1,param_2,"%s","softmagic.c",0x220);
      iVar6 = FUN_00114fd0(param_1,uVar10,uVar17);
      if (iVar6 != -1) {
        uVar15 = (ulong)((uint)*(byte *)(param_2 + 5) + *(int *)(param_1 + 0x30));
        goto LAB_0010bc14;
      }
      break;
    }
    __s = (byte *)(param_1 + 0x70);
    sVar7 = strlen((char *)__s);
    uVar15 = *(uint *)(param_1 + 0x30) + sVar7;
    if (*(char *)(param_2 + 0x20) == '\0') {
      sVar7 = strcspn((char *)__s,"\r\n");
      *(undefined *)(param_1 + 0x70 + sVar7) = 0;
    }
    if ((*(byte *)(param_2 + 0x1d) & 0x20) != 0) {
      plVar8 = (long *)FUN_00104d70();
      lVar13 = *plVar8;
      while ((*(byte *)(lVar13 + 1 + (ulong)*__s * 2) & 0x20) != 0) {
        __s = __s + 1;
      }
      pbVar9 = __s;
      if (*__s == 0) {
        pbVar16 = __s + -1;
      }
      else {
        do {
          pbVar16 = pbVar9;
          pbVar9 = pbVar16 + 1;
        } while (*pbVar9 != 0);
      }
      bVar2 = *(byte *)(lVar13 + 1 + (ulong)pbVar9[-1] * 2);
      while ((bVar2 & 0x20) != 0) {
        pbVar9 = pbVar16 + -1;
        pbVar16 = pbVar16 + -1;
        bVar2 = *(byte *)(lVar13 + 1 + (ulong)*pbVar9 * 2);
      }
      pbVar16[1] = 0;
    }
    uVar17 = FUN_00115ef0(local_238,0x200,__s);
    uVar10 = FUN_0010bb00(param_1,param_2,"%s","softmagic.c",0x23c);
    iVar6 = FUN_00114fd0(param_1,uVar10,uVar17);
    if (iVar6 == -1) break;
    if (*(char *)(param_2 + 6) == '\r') {
      lVar13 = FUN_00107460(param_2);
      uVar15 = uVar15 + lVar13;
    }
    goto LAB_0010bc14;
  case 6:
  case 9:
  case 0xc:
  case 0x15:
    puVar11 = (undefined *)FUN_00113da0(*(undefined4 *)(param_1 + 0x70),0,local_2d8);
    uVar17 = 0x249;
    goto LAB_0010bbdb;
  case 0xe:
  case 0xf:
  case 0x10:
  case 0x16:
    puVar11 = (undefined *)FUN_00113da0(*(undefined4 *)(param_1 + 0x70),1,local_2d8);
    uVar17 = 0x253;
LAB_0010bbdb:
    uVar17 = FUN_0010bb00(param_1,param_2,"%s","softmagic.c",uVar17);
    iVar6 = FUN_00114fd0(param_1,uVar17,puVar11);
joined_r0x0010be89:
    if (iVar6 == -1) break;
    uVar15 = (ulong)*(uint *)(param_1 + 0x30) + 4;
    goto LAB_0010bc14;
  case 0x11:
  case 0x14:
    sVar7 = *(size_t *)(param_1 + 0x68);
    pcVar14 = strndup(*(char **)(param_1 + 0x50),sVar7);
    if (pcVar14 == (char *)0x0) {
      FUN_00115200(param_1,sVar7);
    }
    else {
      uVar17 = FUN_00115ef0(local_238,0x200,pcVar14);
      uVar10 = FUN_0010bb00(param_1,param_2,"%s","softmagic.c",0x2a6);
      iVar6 = FUN_00114fd0(param_1,uVar10,uVar17);
      free(pcVar14);
      if (iVar6 != -1) {
        uVar15 = *(ulong *)(param_1 + 0x60);
        if ((*(byte *)(param_2 + 0x1c) & 0x10) == 0) {
          uVar15 = uVar15 + *(long *)(param_1 + 0x68);
        }
        goto LAB_0010bc14;
      }
    }
    break;
  case 0x18:
  case 0x19:
  case 0x1a:
    puVar12 = (undefined *)FUN_00107300(param_1,param_2,*(undefined8 *)(param_1 + 0x70));
    iVar6 = FUN_0010a3b0(param_1,param_2);
    if (iVar6 == -1) break;
    if (iVar6 != 1) {
      uVar17 = 0x213;
      pcVar14 = "%llu";
      puVar11 = puVar12;
      goto LAB_0010bf2a;
    }
    puVar11 = local_2b8;
    __snprintf_chk(puVar11,0x80,1,0x80,&DAT_0011cf63,puVar12);
    uVar17 = FUN_0010bb00(param_1,param_2,"%s","softmagic.c",0x20f);
    goto LAB_0010bf3b;
  case 0x1b:
  case 0x1c:
  case 0x1d:
    puVar11 = (undefined *)FUN_00113da0(*(undefined8 *)(param_1 + 0x70),0,local_2d8);
    uVar17 = 0x25c;
    goto LAB_0010bf1c;
  case 0x1e:
  case 0x1f:
  case 0x20:
    puVar11 = (undefined *)FUN_00113da0(*(undefined8 *)(param_1 + 0x70),1,local_2d8);
    uVar17 = 0x265;
    goto LAB_0010bf1c;
  case 0x21:
  case 0x22:
  case 0x23:
    fVar1 = *(float *)(param_1 + 0x70);
    iVar6 = FUN_0010a3b0(param_1,param_2);
    if (iVar6 != -1) {
      if (iVar6 != 1) {
        uVar17 = FUN_0010bb00(param_1,param_2,"%g","softmagic.c",0x281);
        iVar6 = FUN_00114fd0((double)fVar1,param_1,uVar17);
        goto joined_r0x0010be89;
      }
      puVar11 = local_2b8;
      __snprintf_chk((char *)fVar1,puVar11,0x80,1,0x80,"%g");
      uVar17 = 0x27d;
      goto LAB_0010bbdb;
    }
    break;
  case 0x24:
  case 0x25:
  case 0x26:
    uVar17 = *(undefined8 *)(param_1 + 0x70);
    iVar6 = FUN_0010a3b0(param_1,param_2);
    if (iVar6 == -1) break;
    if (iVar6 == 1) {
      puVar11 = local_2b8;
      __snprintf_chk(uVar17,puVar11,0x80,1,0x80,"%g");
      uVar17 = 0x291;
      goto LAB_0010bf1c;
    }
    uVar10 = FUN_0010bb00(param_1,param_2,"%g","softmagic.c",0x295);
    iVar6 = FUN_00114fd0(uVar17,param_1,uVar10);
    if (iVar6 == -1) break;
    goto LAB_0010bf4e;
  case 0x29:
  case 0x2d:
  case 0x2e:
    goto switchD_0010bbb6_caseD_29;
  case 0x2a:
  case 0x2b:
  case 0x2c:
    puVar11 = (undefined *)FUN_00113da0(*(undefined8 *)(param_1 + 0x70),2,local_2d8);
    uVar17 = 0x26e;
LAB_0010bf1c:
    pcVar14 = "%s";
LAB_0010bf2a:
    uVar17 = FUN_0010bb00(param_1,param_2,pcVar14,"softmagic.c",uVar17);
LAB_0010bf3b:
    iVar6 = FUN_00114fd0(param_1,uVar17,puVar11);
    if (iVar6 != -1) {
LAB_0010bf4e:
      uVar15 = (ulong)*(uint *)(param_1 + 0x30) + 8;
LAB_0010bc14:
      uVar15 = uVar15 & 0xffffffff;
      goto LAB_0010bc16;
    }
    break;
  case 0x30:
    lVar13 = FUN_00115ef0(local_238,0x200,param_1 + 0x70);
    pcVar14 = (char *)FUN_0010bb00(param_1,param_2,"%s","softmagic.c",0x2c1);
LAB_0010be07:
    iVar6 = FUN_00114fd0(param_1,pcVar14,lVar13);
    if (iVar6 == -1) break;
switchD_0010bbb6_caseD_29:
    uVar15 = (ulong)*(uint *)(param_1 + 0x30);
    goto LAB_0010bc14;
  }
  uVar15 = 0xffffffff;
LAB_0010bc16:
  if (local_30 == *(long *)(in_FS_OFFSET + 0x28)) {
    return uVar15;
  }
                    // WARNING: Subroutine does not return
  __stack_chk_fail();
}



undefined8
FUN_0010c460(long *param_1,undefined8 param_2,undefined8 param_3,undefined2 *param_4,
            undefined2 *param_5,undefined4 param_6,undefined4 param_7)

{
  undefined8 uVar1;
  undefined8 *puVar2;
  long in_FS_OFFSET;
  undefined2 local_4c;
  undefined2 local_4a;
  undefined4 local_48;
  undefined4 local_44;
  long local_40;
  
  local_40 = *(long *)(in_FS_OFFSET + 0x28);
  local_48 = 0;
  local_44 = 0;
  if (param_5 == (undefined2 *)0x0) {
    param_5 = &local_4c;
    local_4c = 0;
  }
  if (param_4 == (undefined2 *)0x0) {
    param_4 = &local_4a;
    local_4a = 0;
  }
  puVar2 = (undefined8 *)((undefined8 *)*param_1)[3];
  if ((undefined8 *)*param_1 != puVar2) {
    do {
      uVar1 = FUN_0010d250(param_1,*puVar2,*(undefined4 *)(puVar2 + 1),param_2,param_3,0,param_6,
                           param_7,0,param_4,param_5,&local_48,&local_44,0);
      if ((int)uVar1 != 0) goto LAB_0010c535;
      puVar2 = (undefined8 *)puVar2[3];
    } while ((undefined8 *)*param_1 != puVar2);
  }
  uVar1 = 0;
LAB_0010c535:
  if (local_40 == *(long *)(in_FS_OFFSET + 0x28)) {
    return uVar1;
  }
                    // WARNING: Subroutine does not return
  __stack_chk_fail();
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

int FUN_0010c590(long param_1,long param_2,long param_3,ulong param_4,long param_5,int param_6,
                undefined4 param_7,undefined4 param_8,uint param_9,ushort *param_10,ushort *param_11
                ,undefined8 param_12,undefined4 *param_13,undefined8 param_14)

{
  byte bVar1;
  ushort uVar2;
  undefined4 uVar3;
  byte bVar4;
  int iVar5;
  uint uVar6;
  int iVar7;
  ulong uVar8;
  long lVar9;
  void *__ptr;
  undefined8 uVar10;
  uint *puVar11;
  byte bVar12;
  char *pcVar13;
  ulong uVar14;
  ulong uVar15;
  ulong uVar16;
  undefined *puVar17;
  uint uVar18;
  long in_FS_OFFSET;
  undefined8 local_68;
  undefined4 local_60;
  long local_40;
  
  uVar6 = *(uint *)(param_1 + 0x30);
  uVar15 = (ulong)uVar6;
  uVar2 = *param_10;
  local_40 = *(long *)(in_FS_OFFSET + 0x28);
  if (*(ushort *)(param_1 + 0xd0) <= uVar2) {
    pcVar13 = "indirect count (%hu) exceeded";
LAB_0010d1a2:
    FUN_00114dc0(param_1,0,pcVar13);
    goto LAB_0010cbe0;
  }
  uVar2 = *param_11;
  if (*(ushort *)(param_1 + 0xd2) <= uVar2) {
    pcVar13 = "name use count (%hu) exceeded";
    goto LAB_0010d1a2;
  }
  puVar17 = (undefined *)(param_1 + 0x70);
  iVar5 = FUN_0010adb0(param_1,puVar17,*(undefined *)(param_3 + 6),*(byte *)(param_3 + 2) & 1,
                       param_2,uVar6 + (int)param_5,param_4 & 0xffffffff,param_3 + 0x18,
                       param_3 + 0x1c);
  if (iVar5 == -1) goto LAB_0010c918;
  bVar4 = *(byte *)(param_3 + 2);
  if ((*(byte *)(param_1 + 0x38) & 1) != 0) {
    __fprintf_chk(_stderr,1,"mget(type=%d, flag=%x, offset=%u, o=%zu, nbytes=%zu, il=%hu, nc=%hu)\n"
                  ,*(undefined *)(param_3 + 6),bVar4,uVar15,param_5,param_4,*param_10,*param_11);
    FUN_0010baa0(uVar15,puVar17);
    FUN_00113e90(param_3);
    bVar4 = *(byte *)(param_3 + 2);
  }
  if ((bVar4 & 1) == 0) goto LAB_0010c7c0;
  uVar16 = (ulong)*(int *)(param_3 + 0x10);
  bVar4 = *(byte *)(param_3 + 8) & 0x20;
  if (-1 < (char)*(byte *)(param_3 + 8)) {
    uVar6 = (uint)*(byte *)(param_3 + 7);
    goto LAB_0010c6bb;
  }
  if ((param_4 < *(int *)(param_3 + 0x10) + uVar6) || (param_4 - (uVar15 + uVar16) < 0x60))
  goto LAB_0010ca50;
  bVar12 = *(byte *)(param_3 + 7);
  uVar6 = (uint)bVar12;
  uVar18 = (uint)bVar12;
  uVar8 = uVar16;
  uVar14 = uVar15;
  if (param_9 != 0) {
    uVar6 = (uint)bVar12;
    uVar18 = FUN_0010a6c0(uVar18);
  }
  puVar11 = (uint *)(uVar8 + uVar14 + param_2);
  if (false) goto switchD_0010ca0d_caseD_0;
  switch(uVar18) {
  case 1:
    uVar16 = (long)(char)*(byte *)puVar11;
    if (bVar4 == 0) {
      uVar16 = (ulong)*(byte *)puVar11;
    }
    break;
  case 2:
    uVar16 = (long)(short)*(ushort *)puVar11;
    if (bVar4 == 0) {
      uVar16 = (ulong)*(ushort *)puVar11;
    }
    break;
  case 4:
  case 0xb:
  case 0x28:
    uVar16 = (long)(int)*puVar11;
    if (bVar4 == 0) {
      uVar16 = (ulong)*puVar11;
    }
    break;
  case 7:
    bVar12 = *(byte *)puVar11;
    bVar1 = *(byte *)((long)puVar11 + 1);
    goto LAB_0010cb57;
  case 8:
  case 0x27:
    uVar18 = *puVar11;
    uVar18 = uVar18 >> 0x18 | (uVar18 & 0xff0000) >> 8 | (uVar18 & 0xff00) << 8 | uVar18 << 0x18;
    uVar16 = (long)(int)uVar18;
    if (bVar4 == 0) {
      uVar16 = (ulong)uVar18;
    }
    break;
  case 10:
    bVar12 = *(byte *)((long)puVar11 + 1);
    bVar1 = *(byte *)puVar11;
LAB_0010cb57:
    uVar16 = (long)(short)((ushort)bVar1 | (ushort)((ulong)bVar12 << 8));
    if (bVar4 == 0) {
      uVar16 = (ulong)((uint)bVar1 | (uint)((ulong)bVar12 << 8));
    }
    break;
  case 0x17:
    uVar18 = (uint)*(byte *)((long)puVar11 + 1) << 0x18 | (uint)*(byte *)puVar11 << 0x10 |
             (uint)*(byte *)((long)puVar11 + 2) | (uint)*(byte *)((long)puVar11 + 3) << 8;
    uVar16 = (long)(int)uVar18;
    if (bVar4 == 0) {
      uVar16 = (ulong)uVar18;
    }
  }
switchD_0010ca0d_caseD_0:
  if ((*(byte *)(param_1 + 0x38) & 1) != 0) {
    __fprintf_chk(_stderr,1,"indirect offs=%jd\n",uVar16);
    uVar6 = (uint)*(byte *)(param_3 + 7);
  }
LAB_0010c6bb:
  if (param_9 != 0) {
    uVar6 = FUN_0010a6c0(uVar6);
  }
  if (true) {
    switch(uVar6) {
    default:
      goto switchD_0010c6ee_caseD_0;
    case 1:
      if (uVar15 < param_4) {
        uVar15 = (ulong)(char)*(byte *)(param_1 + 0x70);
        uVar8 = (ulong)*(byte *)(param_1 + 0x70);
LAB_0010c728:
        if (bVar4 == 0) {
          uVar15 = uVar8;
        }
        uVar6 = FUN_0010ad20(*(undefined *)(param_3 + 8),uVar15,uVar16);
        uVar15 = (ulong)uVar6;
        goto switchD_0010c6ee_caseD_0;
      }
      break;
    case 2:
      if ((uVar15 <= param_4) && (1 < param_4 - uVar15)) {
        uVar15 = (ulong)(short)*(ushort *)(param_1 + 0x70);
        uVar8 = (ulong)*(ushort *)(param_1 + 0x70);
        goto LAB_0010c728;
      }
      break;
    case 4:
      if ((uVar15 <= param_4) && (3 < param_4 - uVar15)) {
        uVar15 = (ulong)(int)*(uint *)(param_1 + 0x70);
        uVar8 = (ulong)*(uint *)(param_1 + 0x70);
        goto LAB_0010c728;
      }
      break;
    case 7:
      if ((uVar15 <= param_4) && (1 < param_4 - uVar15)) {
        lVar9 = (ulong)*(byte *)(param_1 + 0x70) << 8;
        uVar15 = (ulong)(short)((ushort)*(byte *)(param_1 + 0x71) | (ushort)lVar9);
        uVar8 = (ulong)((uint)*(byte *)(param_1 + 0x71) | (uint)lVar9);
        goto LAB_0010c728;
      }
      break;
    case 8:
    case 0x27:
      if ((uVar15 <= param_4) && (3 < param_4 - uVar15)) {
        uVar18 = *(uint *)(param_1 + 0x70);
        uVar15 = (ulong)(uVar18 >> 0x18 | (uVar18 & 0xff0000) >> 8 | (uVar18 & 0xff00) << 8 |
                        uVar18 << 0x18);
        if (uVar6 == 0x27) {
LAB_0010ce10:
          uVar6 = FUN_0010a650(*(undefined4 *)(param_1 + 0x38),uVar15);
          uVar15 = (ulong)uVar6;
        }
LAB_0010cdc3:
        if (bVar4 != 0) {
          uVar15 = (long)(int)uVar15;
        }
        uVar6 = FUN_0010ad20(*(undefined *)(param_3 + 8),uVar15,uVar16);
        uVar15 = (ulong)uVar6;
        goto switchD_0010c6ee_caseD_0;
      }
      break;
    case 10:
      if ((uVar15 <= param_4) && (1 < param_4 - uVar15)) {
        lVar9 = (ulong)*(byte *)(param_1 + 0x71) << 8;
        uVar15 = (ulong)(short)((ushort)*(byte *)(param_1 + 0x70) | (ushort)lVar9);
        uVar8 = (ulong)((uint)*(byte *)(param_1 + 0x70) | (uint)lVar9);
        goto LAB_0010c728;
      }
      break;
    case 0xb:
    case 0x28:
      if ((uVar15 <= param_4) && (3 < param_4 - uVar15)) {
        uVar15 = (ulong)*(uint *)(param_1 + 0x70);
        if (uVar6 == 0x28) goto LAB_0010ce10;
        goto LAB_0010cdc3;
      }
      break;
    case 0x17:
      if ((uVar15 <= param_4) && (3 < param_4 - uVar15)) {
        uVar6 = (uint)*(byte *)(param_1 + 0x71) << 0x18 | (uint)*(byte *)(param_1 + 0x70) << 0x10 |
                (uint)*(byte *)(param_1 + 0x72) | (uint)*(byte *)(param_1 + 0x73) << 8;
        uVar15 = (ulong)(int)uVar6;
        uVar8 = (ulong)uVar6;
        goto LAB_0010c728;
      }
    }
    goto LAB_0010ca50;
  }
switchD_0010c6ee_caseD_0:
  if ((*(byte *)(param_3 + 2) & 4) != 0) {
    uVar6 = *(uint *)(param_1 + 0x38) & 1;
    uVar18 = (int)uVar15 + *(int *)((ulong)(param_6 - 1) * 0x10 + *(long *)(param_1 + 0x18));
    uVar15 = (ulong)uVar18;
    if (uVar18 == 0) {
      if (uVar6 != 0) {
        fwrite("indirect *zero* offset\n",1,0x17,_stderr);
        iVar5 = 0;
        goto LAB_0010c918;
      }
      goto LAB_0010ca50;
    }
    if (uVar6 != 0) {
      __fprintf_chk(_stderr,1,"indirect +offs=%u\n",uVar18);
    }
  }
  iVar5 = FUN_0010adb0(param_1,puVar17,*(undefined *)(param_3 + 6),0,param_2,uVar15,param_4,
                       param_3 + 0x18,param_3 + 0x1c);
  if (iVar5 == -1) goto LAB_0010c918;
  *(int *)(param_1 + 0x30) = (int)uVar15;
  if ((*(byte *)(param_1 + 0x38) & 1) != 0) {
    FUN_0010baa0(uVar15,puVar17);
    FUN_00113e90(param_3);
  }
LAB_0010c7c0:
  if (false) goto switchD_0010c7e0_caseD_0;
  switch(*(byte *)(param_3 + 6)) {
  case 1:
    if (uVar15 < param_4) {
      uVar15 = 1;
      if (param_9 != 0) goto LAB_0010ca8a;
      goto switchD_0010caac_caseD_1;
    }
    goto LAB_0010ca50;
  case 2:
  case 7:
  case 10:
    if ((param_4 < uVar15) || (param_4 - uVar15 < 2)) goto LAB_0010ca50;
    break;
  case 4:
  case 6:
  case 8:
  case 9:
  case 0xb:
  case 0xc:
  case 0xe:
  case 0xf:
  case 0x10:
  case 0x15:
  case 0x16:
  case 0x17:
  case 0x21:
  case 0x22:
  case 0x23:
    if ((param_4 < uVar15) || (param_4 - uVar15 < 4)) goto LAB_0010ca50;
    break;
  case 5:
  case 0xd:
  case 0x14:
    if ((param_4 < uVar15) || (param_4 - uVar15 < (ulong)*(byte *)(param_3 + 5))) goto LAB_0010ca50;
    break;
  case 0x11:
    if (param_4 < uVar15) goto LAB_0010ca50;
    uVar15 = 0x11;
    if (param_9 != 0) goto LAB_0010ca8a;
    goto switchD_0010caac_caseD_3;
  case 0x24:
  case 0x25:
  case 0x26:
    if ((param_4 < uVar15) || (param_4 - uVar15 < 8)) goto LAB_0010ca50;
    break;
  case 0x29:
    uVar6 = (uint)uVar15;
    if ((*(byte *)(param_3 + 0x1c) & 1) != 0) {
      uVar6 = (int)param_5 + (uint)uVar15;
    }
    if ((uVar6 == 0) || (uVar15 = (ulong)uVar6, param_4 < uVar15)) goto LAB_0010ca50;
    lVar9 = FUN_00115e40(param_1);
    if (lVar9 != 0) {
      *param_10 = *param_10 + 1;
      iVar5 = FUN_0010c460(param_1,uVar15 + param_2,param_4 - uVar15,param_10,param_11,0x20,param_8)
      ;
      if ((*(byte *)(param_1 + 0x38) & 1) != 0) {
        __fprintf_chk(_stderr,1,"indirect @offs=%u[%d]\n",uVar6,iVar5);
      }
      __ptr = (void *)FUN_00115e90(param_1,lVar9);
      if ((__ptr != (void *)0x0) || ((*(byte *)(param_1 + 0x3c) & 1) == 0)) {
        if (iVar5 == 1) {
          if ((*(uint *)(param_1 + 0x38) & 0x1000c10) == 0) {
            uVar10 = FUN_0010bb00(param_1,param_3,"%u","softmagic.c",0x624);
            iVar7 = FUN_00114fd0(param_1,uVar10,uVar6);
            if (iVar7 != -1) goto LAB_0010c8dc;
          }
          else {
LAB_0010c8dc:
            iVar7 = FUN_00114fd0(param_1,"%s",__ptr);
            if (iVar7 != -1) goto LAB_0010c901;
          }
          free(__ptr);
          iVar5 = -1;
        }
        else {
LAB_0010c901:
          free(__ptr);
        }
        goto LAB_0010c918;
      }
    }
LAB_0010cbe0:
    iVar5 = -1;
    goto LAB_0010c918;
  case 0x2d:
    if (((*(uint *)(param_1 + 0x38) & 0x1000c10) == 0) &&
       (iVar5 = FUN_00114fd0(param_1,"%s",param_3 + 0x80), iVar5 == -1)) goto LAB_0010cbe0;
    goto switchD_0010caac_caseD_3;
  case 0x2e:
    if (param_4 < uVar15) goto LAB_0010ca50;
    lVar9 = param_3 + 0x20;
    if (*(char *)(param_3 + 0x20) == '^') {
      lVar9 = param_3 + 0x21;
      param_9 = (uint)(param_9 == 0);
    }
    iVar5 = FUN_0010a1c0(param_1,lVar9,&local_68);
    if (iVar5 == -1) {
      FUN_00114dc0(param_1,0,"cannot find entry `%s\'");
      iVar5 = -1;
      goto LAB_0010c918;
    }
    *param_11 = *param_11 + 1;
    uVar3 = *param_13;
    if ((*(byte *)(param_3 + 2) & 0x10) != 0) {
      *param_13 = 0;
    }
    iVar5 = FUN_0010d250(param_1,local_68,local_60,param_2,param_4,uVar15 + param_5,param_7,param_8,
                         param_9,param_10,param_11,param_12,param_13,param_14);
    if (iVar5 != 1) {
      iVar5 = 1;
      *param_13 = uVar3;
      goto LAB_0010c918;
    }
    goto switchD_0010caac_caseD_3;
  }
switchD_0010c7e0_caseD_0:
  uVar16 = (ulong)*(byte *)(param_3 + 6);
  uVar15 = uVar16;
  if (param_9 != 0) {
LAB_0010ca8a:
    bVar4 = FUN_0010a6c0(uVar15);
    uVar16 = (ulong)bVar4;
  }
  if (false) {
switchD_0010caac_caseD_0:
    FUN_001150c0(param_1,"invalid type %d in mconvert()");
    iVar5 = 0;
    goto LAB_0010c918;
  }
  switch(uVar16) {
  default:
    goto switchD_0010caac_caseD_0;
  case 1:
switchD_0010caac_caseD_1:
    bVar4 = *(byte *)(param_3 + 9);
    if (*(long *)(param_3 + 0x18) == 0) goto LAB_0010d0c8;
    bVar12 = (byte)*(long *)(param_3 + 0x18);
    switch(bVar4 & 7) {
    case 0:
      *(byte *)(param_1 + 0x70) = *(byte *)(param_1 + 0x70) & bVar12;
      bVar4 = *(byte *)(param_3 + 9);
      break;
    case 1:
      *(byte *)(param_1 + 0x70) = *(byte *)(param_1 + 0x70) | bVar12;
      bVar4 = *(byte *)(param_3 + 9);
      break;
    case 2:
      *(byte *)(param_1 + 0x70) = *(byte *)(param_1 + 0x70) ^ bVar12;
      bVar4 = *(byte *)(param_3 + 9);
      break;
    case 3:
      *(char *)(param_1 + 0x70) = *(char *)(param_1 + 0x70) + bVar12;
      bVar4 = *(byte *)(param_3 + 9);
      break;
    case 4:
      *(char *)(param_1 + 0x70) = *(char *)(param_1 + 0x70) - bVar12;
      bVar4 = *(byte *)(param_3 + 9);
      break;
    case 5:
      *(byte *)(param_1 + 0x70) = *(char *)(param_1 + 0x70) * bVar12;
      bVar4 = *(byte *)(param_3 + 9);
      break;
    case 6:
      if (bVar12 != 0) {
        *(byte *)(param_1 + 0x70) = *(byte *)(param_1 + 0x70) / bVar12;
        bVar4 = *(byte *)(param_3 + 9);
        break;
      }
      goto LAB_0010ca38;
    case 7:
      if (bVar12 == 0) goto LAB_0010ca38;
      *(byte *)(param_1 + 0x70) = *(byte *)(param_1 + 0x70) % bVar12;
      bVar4 = *(byte *)(param_3 + 9);
    }
LAB_0010d0c8:
    if ((bVar4 & 0x40) != 0) {
      *(byte *)(param_1 + 0x70) = ~*(byte *)(param_1 + 0x70);
      iVar5 = 1;
      goto LAB_0010c918;
    }
    goto switchD_0010caac_caseD_3;
  case 2:
  case 10:
    goto switchD_0010caac_caseD_2;
  case 3:
  case 0x11:
  case 0x14:
  case 0x2d:
  case 0x2e:
  case 0x2f:
  case 0x30:
    goto switchD_0010caac_caseD_3;
  case 4:
  case 6:
  case 0xb:
  case 0xc:
  case 0xe:
  case 0x10:
    break;
  case 5:
  case 0x12:
  case 0x13:
    *(undefined *)(param_1 + 0xcf) = 0;
    iVar5 = 1;
    goto LAB_0010c918;
  case 7:
    *(ushort *)(param_1 + 0x70) =
         CONCAT11(*(undefined *)(param_1 + 0x70),*(undefined *)(param_1 + 0x71));
switchD_0010caac_caseD_2:
    iVar5 = FUN_0010a820(puVar17,param_3 + 9,*(undefined8 *)(param_3 + 0x18));
joined_r0x0010ce99:
    if (iVar5 != -1) goto switchD_0010caac_caseD_3;
    goto LAB_0010ca38;
  case 8:
  case 9:
  case 0xf:
    uVar6 = *(uint *)(param_1 + 0x70);
    *(uint *)(param_1 + 0x70) =
         uVar6 >> 0x18 | (uVar6 & 0xff0000) >> 8 | (uVar6 & 0xff00) << 8 | uVar6 << 0x18;
    break;
  case 0xd:
    lVar9 = FUN_00107460(param_3);
    uVar16 = FUN_0010a130(param_3,puVar17);
    uVar15 = 0x60U - lVar9;
    if (uVar16 < 0x60U - lVar9) {
      uVar15 = uVar16;
    }
    if (uVar15 != 0) {
      uVar16 = 0;
      do {
        *(undefined *)(param_1 + 0x70 + uVar16) = puVar17[uVar16 + lVar9];
        uVar16 = uVar16 + 1;
      } while (uVar16 != uVar15);
      puVar17 = puVar17 + uVar16;
    }
    *puVar17 = 0;
    iVar5 = 1;
    goto LAB_0010c918;
  case 0x15:
  case 0x16:
  case 0x17:
    *(uint *)(param_1 + 0x70) =
         (uint)*(byte *)(param_1 + 0x71) << 0x18 | (uint)*(byte *)(param_1 + 0x70) << 0x10 |
         (uint)*(byte *)(param_1 + 0x72) | (uint)*(byte *)(param_1 + 0x73) << 8;
    break;
  case 0x18:
  case 0x19:
  case 0x1b:
  case 0x1c:
  case 0x1e:
  case 0x1f:
  case 0x2a:
  case 0x2b:
    goto switchD_0010caac_caseD_18;
  case 0x1a:
  case 0x1d:
  case 0x20:
  case 0x2c:
    uVar15 = *(ulong *)(param_1 + 0x70);
    *(ulong *)(param_1 + 0x70) =
         uVar15 >> 0x38 | (uVar15 & 0xff000000000000) >> 0x28 | (uVar15 & 0xff0000000000) >> 0x18 |
         (uVar15 & 0xff00000000) >> 8 | (uVar15 & 0xff000000) << 8 | (uVar15 & 0xff0000) << 0x18 |
         (uVar15 & 0xff00) << 0x28 | uVar15 << 0x38;
switchD_0010caac_caseD_18:
    iVar5 = FUN_0010a9b0(puVar17,param_3 + 9,*(undefined8 *)(param_3 + 0x18));
    goto joined_r0x0010ce99;
  case 0x21:
  case 0x23:
    goto switchD_0010caac_caseD_21;
  case 0x22:
    uVar6 = *(uint *)(param_1 + 0x70);
    *(uint *)(param_1 + 0x70) =
         uVar6 >> 0x18 | (uVar6 & 0xff0000) >> 8 | (uVar6 & 0xff00) << 8 | uVar6 << 0x18;
switchD_0010caac_caseD_21:
    iVar5 = FUN_0010aa60(puVar17,*(undefined *)(param_3 + 9),*(undefined8 *)(param_3 + 0x18));
    goto joined_r0x0010ce99;
  case 0x24:
  case 0x26:
    goto switchD_0010caac_caseD_24;
  case 0x25:
    uVar15 = *(ulong *)(param_1 + 0x70);
    *(ulong *)(param_1 + 0x70) =
         uVar15 >> 0x38 | (uVar15 & 0xff000000000000) >> 0x28 | (uVar15 & 0xff0000000000) >> 0x18 |
         (uVar15 & 0xff00000000) >> 8 | (uVar15 & 0xff000000) << 8 | (uVar15 & 0xff0000) << 0x18 |
         (uVar15 & 0xff00) << 0x28 | uVar15 << 0x38;
switchD_0010caac_caseD_24:
    iVar5 = FUN_0010abc0(puVar17,*(undefined *)(param_3 + 9),*(undefined8 *)(param_3 + 0x18));
    goto joined_r0x0010ce99;
  }
  iVar5 = FUN_0010a8f0(puVar17,param_3 + 9,*(undefined8 *)(param_3 + 0x18));
  if (iVar5 == -1) {
LAB_0010ca38:
    FUN_001150c0(param_1,"zerodivide in mconvert()");
LAB_0010ca50:
    iVar5 = 0;
  }
  else {
switchD_0010caac_caseD_3:
    iVar5 = 1;
  }
LAB_0010c918:
  if (local_40 != *(long *)(in_FS_OFFSET + 0x28)) {
                    // WARNING: Subroutine does not return
    __stack_chk_fail();
  }
  return iVar5;
}



ulong FUN_0010d250(long param_1,long param_2,uint param_3,undefined8 param_4,undefined8 param_5,
                  undefined8 param_6,uint param_7,int param_8,undefined4 param_9,undefined8 param_10
                  ,undefined8 param_11,int *param_12,int *param_13,uint *param_14)

{
  byte bVar1;
  ushort uVar2;
  uint uVar3;
  int iVar4;
  uint uVar5;
  ulong uVar6;
  long lVar7;
  uint uVar8;
  ushort *puVar9;
  uint uVar10;
  ulong uVar11;
  uint uVar12;
  long in_FS_OFFSET;
  int local_60;
  uint local_44;
  long local_40;
  
  local_40 = *(long *)(in_FS_OFFSET + 0x28);
  local_44 = 0;
  uVar3 = *(uint *)(param_1 + 0x38) & 0x1000c10;
  if (param_14 == (uint *)0x0) {
    param_14 = &local_44;
  }
  iVar4 = FUN_00115ad0(param_1,0);
  if (iVar4 == -1) {
LAB_0010d618:
    uVar6 = 0xffffffff;
  }
  else {
    if (param_3 != 0) {
      local_60 = 1;
      uVar11 = 0;
      do {
        lVar7 = param_2 + uVar11 * 0x158;
        bVar1 = *(byte *)(lVar7 + 6);
        if (bVar1 == 0x2d) {
LAB_0010d36b:
          *(undefined4 *)(param_1 + 0x30) = *(undefined4 *)(lVar7 + 0xc);
          *(ulong *)(param_1 + 0x48) = (ulong)*(uint *)(lVar7 + 0x14);
          iVar4 = FUN_0010c590(param_1,param_4,lVar7,param_5,param_6,0,param_7,param_8,param_9,
                               param_10,param_11,param_12,param_13,param_14);
          if (iVar4 == -1) goto LAB_0010d618;
          if (iVar4 == 0) {
            if (*(char *)(lVar7 + 4) == '!') goto LAB_0010d3fb;
            goto LAB_0010d650;
          }
          if (*(char *)(lVar7 + 6) == ')') {
            *param_14 = 1;
          }
          iVar4 = FUN_0010b360(param_1,lVar7);
          if (iVar4 == -1) goto LAB_0010d618;
          if (iVar4 == 0) goto LAB_0010d650;
LAB_0010d3fb:
          uVar6 = FUN_0010a2b0(param_1,lVar7,local_60);
          if ((int)uVar6 != 0) {
LAB_0010d86f:
            *param_13 = 1;
            *param_12 = 1;
            *param_14 = 1;
            goto LAB_0010d61d;
          }
          if (*(char *)(lVar7 + 0x80) != '\0') {
            *param_13 = 1;
            *param_12 = 1;
            if ((local_60 == 0) && (iVar4 = FUN_00114fd0(param_1, "", &DAT_0011ce1b), iVar4 == -1))
            goto LAB_0010d618;
          }
          if ((uVar3 == 0) && (iVar4 = FUN_0010bb70(param_1,lVar7), iVar4 == -1)) goto LAB_0010d618;
          iVar4 = FUN_0010a470(param_1,lVar7,param_5,*(undefined8 *)(param_1 + 0x18));
          if (iVar4 + 1U < 2) goto LAB_0010d650;
          iVar4 = FUN_00115ad0(param_1,1);
          if (iVar4 == -1) goto LAB_0010d618;
          uVar5 = (uint)uVar11 + 1;
          uVar10 = (uint)uVar11;
          if (uVar5 < param_3) {
            puVar9 = (ushort *)((ulong)uVar5 * 0x158 + param_2);
            uVar8 = 1;
            do {
              uVar12 = uVar5;
              uVar2 = *puVar9;
              uVar10 = uVar12 - 1;
              if (uVar2 == 0) break;
              *(ulong *)(param_1 + 0x48) = (ulong)*(uint *)(puVar9 + 10);
              uVar5 = (uint)uVar2;
              if (uVar5 <= uVar8) {
                if (uVar5 < uVar8) {
                  uVar8 = uVar5;
                }
                iVar4 = *(int *)(puVar9 + 6);
                *(int *)(param_1 + 0x30) = iVar4;
                if ((*(byte *)(puVar9 + 1) & 2) != 0) {
                  *(int *)(param_1 + 0x30) =
                       iVar4 + *(int *)((ulong)(uVar8 - 1) * 0x10 + *(long *)(param_1 + 0x18));
                }
                if ((1 < (byte)(*(char *)(puVar9 + 5) - 2U)) ||
                   (*(int *)((ulong)uVar8 * 0x10 + *(long *)(param_1 + 0x18) + 8) != 1)) {
                  iVar4 = FUN_0010c590(param_1,param_4,puVar9,param_5,param_6,uVar8,param_7,param_8,
                                       param_9,param_10,param_11,param_12,param_13,param_14);
                  if (iVar4 == -1) goto LAB_0010d618;
                  if (iVar4 == 0) {
                    if (*(char *)(puVar9 + 2) == '!') {
LAB_0010d58d:
                      lVar7 = *(long *)(param_1 + 0x18) + (ulong)uVar8 * 0x10;
                      *(undefined4 *)(lVar7 + 8) = 1;
                      if (*(char *)(puVar9 + 3) == '/') {
                        *(undefined4 *)(lVar7 + 4) = 0;
                      }
                      else if (*(int *)(lVar7 + 4) == 0) {
                        *(undefined4 *)(lVar7 + 4) = 1;
                      }
                      else if (*(char *)(puVar9 + 3) == '\x03') goto LAB_0010d5d0;
                      uVar6 = FUN_0010a2b0(param_1,puVar9,local_60);
                      if ((int)uVar6 != 0) goto LAB_0010d86f;
                      if ((((*(char *)(puVar9 + 0x40) != '\0') && (*param_12 == 0)) &&
                          (*param_12 = 1, local_60 == 0)) &&
                         (iVar4 = FUN_00114fd0(param_1, "", &DAT_0011ce1b), iVar4 == -1))
                      goto LAB_0010d618;
                      if (((*param_13 != 0) && ((*(byte *)(puVar9 + 1) & 0x10) == 0)) &&
                         (*(char *)(puVar9 + 0x40) != '\0')) {
                        if ((uVar3 == 0) && (iVar4 = FUN_00114fd0(param_1," ", ""), iVar4 == -1))
                        goto LAB_0010d618;
                        *param_13 = 0;
                      }
                      if ((uVar3 == 0) && (iVar4 = FUN_0010bb70(param_1,puVar9), iVar4 == -1))
                      goto LAB_0010d618;
                      FUN_0010a470(param_1,puVar9,param_5,
                                   *(long *)(param_1 + 0x18) + (ulong)uVar8 * 0x10);
                      if (*(char *)(puVar9 + 0x40) != '\0') {
                        *param_13 = 1;
                      }
                      uVar8 = uVar8 + 1;
                      iVar4 = FUN_00115ad0(param_1,uVar8);
                      if (iVar4 == -1) goto LAB_0010d618;
                    }
                  }
                  else {
                    if (*(char *)(puVar9 + 3) == ')') {
                      *param_14 = 1;
                    }
                    iVar4 = FUN_0010b360(param_1,puVar9);
                    if (iVar4 == -1) goto LAB_0010d618;
                    if (iVar4 != 0) goto LAB_0010d58d;
                    *(undefined4 *)((ulong)uVar8 * 0x10 + *(long *)(param_1 + 0x18) + 8) = 0;
                  }
                }
              }
LAB_0010d5d0:
              puVar9 = puVar9 + 0xac;
              uVar5 = uVar12 + 1;
              uVar10 = uVar12;
            } while (uVar12 + 1 < param_3);
          }
          if (*param_12 == 0) {
LAB_0010d852:
            uVar11 = (ulong)(uVar10 + 1);
          }
          else {
            if (uVar3 == 0) {
              *param_14 = 1;
              if ((*(byte *)(param_1 + 0x38) & 0x20) == 0) {
                local_60 = *param_12;
                if (local_60 == 0) goto LAB_0010d852;
                break;
              }
            }
            else if ((*(byte *)(param_1 + 0x38) & 0x20) == 0) break;
            local_60 = 0;
            uVar11 = (ulong)(uVar10 + 1);
          }
        }
        else {
          if ((bVar1 < 0x2f) && ((0x4200001e2020U >> ((ulong)bVar1 & 0x3f) & 1) != 0)) {
            uVar5 = *(uint *)(lVar7 + 0x1c) & 0x60;
            if (param_8 == 0) {
              if (uVar5 != 0x20) goto LAB_0010d352;
            }
            else if (uVar5 != 0x40) goto LAB_0010d352;
          }
          else {
LAB_0010d352:
            if ((*(byte *)(lVar7 + 2) & param_7) == param_7) goto LAB_0010d36b;
          }
LAB_0010d650:
          do {
            uVar5 = (uint)uVar11;
            uVar11 = (ulong)(uVar5 + 1);
            if (param_3 - 1 <= uVar5) break;
          } while (*(short *)(param_2 + uVar11 * 0x158) != 0);
        }
      } while ((uint)uVar11 < param_3);
    }
    uVar6 = (ulong)*param_14;
  }
LAB_0010d61d:
  if (local_40 != *(long *)(in_FS_OFFSET + 0x28)) {
                    // WARNING: Subroutine does not return
    __stack_chk_fail();
  }
  return uVar6;
}



uint FUN_0010d8d0(long param_1,long param_2,ulong param_3,long param_4,ulong param_5,
                 undefined8 param_6,byte *param_7,undefined4 param_8)

{
  uint uVar1;
  byte bVar2;
  size_t __size;
  bool bVar3;
  bool bVar4;
  byte bVar5;
  int iVar6;
  int iVar7;
  ulong uVar8;
  byte *__ptr;
  long lVar9;
  ulong uVar10;
  byte *pbVar11;
  byte *pbVar12;
  ulong uVar13;
  ulong uVar14;
  byte *pbVar15;
  undefined *puVar16;
  uint uVar17;
  int iVar18;
  uint uVar19;
  uint uVar20;
  int iVar21;
  bool bVar22;
  bool bVar23;
  byte bVar24;
  uint local_48;
  
  bVar24 = 0;
  do {
    uVar13 = param_3;
    if (uVar13 < 2) {
      __ptr = (byte *)0x0;
      uVar19 = 0;
      goto LAB_0010d912;
    }
    param_3 = uVar13 - 1;
  } while (*(char *)(param_2 + -1 + uVar13) == '\0');
  uVar1 = *(uint *)(param_1 + 0x38);
  if (param_5 == 0) {
    if ((uVar1 & 0x1000800) != 0) {
      return 0;
    }
    bVar4 = false;
    iVar21 = 0;
    uVar17 = 0;
    iVar18 = 0;
    iVar6 = 0;
    bVar22 = false;
    __ptr = (byte *)0x0;
    bVar23 = true;
    bVar3 = false;
    local_48 = 0xffffffff;
    uVar20 = 0;
  }
  else {
    if ((uVar1 & 0x4000) == 0) {
      __size = param_5 * 6;
      __ptr = (byte *)malloc(__size);
      if (__ptr == (byte *)0x0) {
        FUN_00115200(param_1,__size);
        uVar19 = 0xffffffff;
        goto LAB_0010d912;
      }
      pbVar15 = __ptr + __size;
      uVar10 = 0;
      pbVar11 = __ptr;
      do {
        uVar14 = *(ulong *)(param_4 + uVar10 * 8);
        bVar5 = (byte)uVar14;
        if (uVar14 < 0x80) {
          if (pbVar15 == pbVar11 || (long)pbVar15 - (long)pbVar11 < 0) goto LAB_0010dfd9;
          *pbVar11 = bVar5;
          pbVar12 = pbVar11 + 1;
        }
        else if (uVar14 < 0x800) {
          if ((long)pbVar15 - (long)pbVar11 < 2) goto LAB_0010dfd9;
          pbVar12 = pbVar11 + 2;
          pbVar11[1] = (bVar5 & 0x3f) + 0x80;
          *pbVar11 = (char)(uVar14 >> 6) - 0x40;
        }
        else if (uVar14 < 0x10000) {
          if ((long)pbVar15 - (long)pbVar11 < 3) goto LAB_0010dfd9;
          pbVar12 = pbVar11 + 3;
          *pbVar11 = (char)(uVar14 >> 0xc) - 0x20;
          pbVar11[2] = (bVar5 & 0x3f) + 0x80;
          pbVar11[1] = ((byte)(uVar14 >> 6) & 0x3f) + 0x80;
        }
        else if (uVar14 < 0x200000) {
          if ((long)pbVar15 - (long)pbVar11 < 4) goto LAB_0010dfd9;
          pbVar12 = pbVar11 + 4;
          *pbVar11 = (char)(uVar14 >> 0x12) - 0x10;
          pbVar11[1] = ((byte)(uVar14 >> 0xc) & 0x3f) + 0x80;
          pbVar11[3] = (bVar5 & 0x3f) + 0x80;
          pbVar11[2] = ((byte)(uVar14 >> 6) & 0x3f) + 0x80;
        }
        else {
          bVar2 = (byte)(uVar14 >> 0x18);
          if (uVar14 < 0x4000000) {
            if ((long)pbVar15 - (long)pbVar11 < 5) {
LAB_0010dfd9:
              uVar19 = 0xffffffff;
              goto LAB_0010d912;
            }
            pbVar12 = pbVar11 + 5;
            *pbVar11 = bVar2 - 8;
            pbVar11[1] = ((byte)(uVar14 >> 0x12) & 0x3f) + 0x80;
            pbVar11[2] = ((byte)(uVar14 >> 0xc) & 0x3f) + 0x80;
            pbVar11[4] = (bVar5 & 0x3f) + 0x80;
            pbVar11[3] = ((byte)(uVar14 >> 6) & 0x3f) + 0x80;
          }
          else {
            if ((0x7fffffff < uVar14) || ((long)pbVar15 - (long)pbVar11 < 6)) goto LAB_0010dfd9;
            pbVar12 = pbVar11 + 6;
            *pbVar11 = (char)(uVar14 >> 0x1e) - 4;
            pbVar11[1] = (bVar2 & 0x3f) + 0x80;
            pbVar11[2] = ((byte)(uVar14 >> 0x12) & 0x3f) + 0x80;
            pbVar11[3] = ((byte)(uVar14 >> 0xc) & 0x3f) + 0x80;
            pbVar11[5] = (bVar5 & 0x3f) + 0x80;
            pbVar11[4] = ((byte)(uVar14 >> 6) & 0x3f) + 0x80;
          }
        }
        uVar10 = uVar10 + 1;
        pbVar11 = pbVar12;
      } while (param_5 != uVar10);
      uVar19 = FUN_0010c460(param_1,__ptr,(long)pbVar12 - (long)__ptr,0,0,0x40,param_8);
      local_48 = 0xffffffff;
      if (uVar19 != 0) {
        local_48 = uVar19;
      }
      if ((*(uint *)(param_1 + 0x38) & 0x1000800) != 0) {
        uVar19 = (uint)(local_48 != 0xffffffff);
        goto LAB_0010d912;
      }
    }
    else {
      if ((uVar1 & 0x1000800) != 0) {
        return 0;
      }
      local_48 = 0xffffffff;
      __ptr = (byte *)0x0;
    }
    bVar3 = false;
    iVar21 = 0;
    uVar20 = 0;
    bVar22 = false;
    iVar6 = 0;
    iVar18 = 0;
    uVar17 = 0;
    bVar4 = false;
    uVar10 = 0;
    uVar14 = 0xffffffffffffffff;
    do {
      while (uVar8 = uVar10, lVar9 = *(long *)(param_4 + uVar8 * 8), lVar9 == 10) {
        if (bVar22) {
          iVar18 = iVar18 + 1;
        }
        else {
          iVar6 = iVar6 + 1;
        }
        bVar22 = false;
        uVar10 = uVar8 + 1;
        uVar14 = uVar8;
        bVar23 = false;
        if (param_5 == uVar8 + 1) goto LAB_0010da05;
      }
      uVar20 = (uVar20 + 1) - (uint)!bVar22;
      bVar22 = lVar9 == 0xd;
      uVar10 = uVar8;
      if (!bVar22) {
        if (lVar9 == 0x85) {
          iVar21 = iVar21 + 1;
        }
        else {
          bVar22 = false;
          uVar10 = uVar14;
          if (uVar14 + 300 < uVar8) {
            bVar3 = true;
          }
        }
      }
      uVar14 = uVar10;
      if (lVar9 == 0x1b) {
        bVar4 = true;
      }
      else if (lVar9 == 8) {
        uVar17 = 1;
      }
      uVar10 = uVar8 + 1;
      bVar23 = bVar22;
    } while (param_5 != uVar8 + 1);
LAB_0010da05:
    bVar22 = false;
    bVar23 = !bVar23;
    if (!bVar23) {
      uVar19 = (uint)(uVar13 < *(ulong *)(param_1 + 0xe0));
      bVar22 = CARRY4(uVar20,uVar19);
      uVar20 = uVar20 + uVar19;
      bVar23 = uVar20 == 0;
    }
  }
  lVar9 = 7;
  pbVar15 = param_7;
  pbVar11 = (byte *)"binary";
  do {
    if (lVar9 == 0) break;
    lVar9 = lVar9 + -1;
    bVar22 = *pbVar15 < *pbVar11;
    bVar23 = *pbVar15 == *pbVar11;
    pbVar15 = pbVar15 + (ulong)bVar24 * -2 + 1;
    pbVar11 = pbVar11 + (ulong)bVar24 * -2 + 1;
  } while (bVar23);
  uVar19 = (uint)(char)((!bVar22 && !bVar23) - bVar22);
  if (uVar19 == 0) goto LAB_0010d912;
  uVar19 = local_48;
  if ((uVar1 & 0x410) != 0) {
    lVar9 = FUN_00115b50(param_1);
    uVar19 = 1;
    if ((lVar9 == 0) && ((uVar1 & 0x10) != 0)) {
      iVar6 = FUN_00114fd0(param_1,"text/plain", "");
      uVar19 = 1;
      if (iVar6 == -1) {
        uVar19 = local_48;
      }
    }
    goto LAB_0010d912;
  }
  lVar9 = FUN_00115b50(param_1);
  bVar22 = false;
  if (lVar9 != 0) {
    iVar7 = FUN_00115d00(param_1," text$",", ");
    if (iVar7 == -1) goto LAB_0010d912;
    if (iVar7 == 0) {
      iVar7 = FUN_00115d00(param_1," text executable$",", ");
      if (iVar7 == -1) goto LAB_0010d912;
      if (iVar7 == 0) {
        iVar7 = FUN_00114fd0(param_1,", ", "");
        if (iVar7 == -1) goto LAB_0010d912;
      }
      else {
        bVar22 = true;
      }
    }
  }
  iVar7 = FUN_00114fd0(param_1,"%s",param_6);
  if ((((iVar7 == -1) || (iVar7 = FUN_00114fd0(param_1," %s",param_7), iVar7 == -1)) ||
      ((bVar22 && (iVar7 = FUN_00114fd0(param_1," executable", ""), iVar7 == -1)))) ||
     ((bVar3 && (iVar7 = FUN_00114fd0(param_1,", with very long lines", ""), iVar7 == -1))))
  goto LAB_0010d912;
  if (iVar6 == 0 && ((iVar18 == 0 && uVar20 == 0) && iVar21 == 0)) {
    iVar6 = FUN_00114fd0(param_1,", with", "");
    if (iVar6 == -1) goto LAB_0010d912;
    puVar16 = &DAT_0011d936;
LAB_0010e118:
    iVar6 = FUN_00114fd0(param_1, "", puVar16);
    if (iVar6 == -1) goto LAB_0010d912;
LAB_0010dca8:
    iVar6 = FUN_00114fd0(param_1," line terminators", "");
    if (iVar6 == -1) goto LAB_0010d912;
  }
  else if ((iVar18 != 0 || uVar20 != 0) || iVar21 != 0) {
    iVar7 = FUN_00114fd0(param_1,", with", "");
    if (iVar7 == -1) goto LAB_0010d912;
    if (iVar18 == 0) {
LAB_0010dc57:
      if (uVar20 != 0) {
        iVar18 = FUN_00114fd0(param_1, "", &DAT_0011d952);
        if (iVar18 == -1) goto LAB_0010d912;
        if (iVar6 == 0 && iVar21 == 0) goto LAB_0010dca8;
        iVar18 = FUN_00114fd0(param_1, "", &DAT_0011e895);
        if (iVar18 == -1) goto LAB_0010d912;
      }
      if (iVar6 == 0) {
        if (iVar21 != 0) {
LAB_0010e279:
          puVar16 = &DAT_0011d95a;
          goto LAB_0010e118;
        }
      }
      else {
        iVar6 = FUN_00114fd0(param_1, "", &DAT_0011d956);
        if (iVar6 == -1) goto LAB_0010d912;
        if (iVar21 != 0) {
          iVar6 = FUN_00114fd0(param_1, "", &DAT_0011e895);
          if (iVar6 == -1) goto LAB_0010d912;
          goto LAB_0010e279;
        }
      }
    }
    else {
      iVar18 = FUN_00114fd0(param_1," CRLF", "");
      if (iVar18 == -1) goto LAB_0010d912;
      if ((uVar20 != 0 || iVar21 != 0) || iVar6 != 0) {
        iVar18 = FUN_00114fd0(param_1, "", &DAT_0011e895);
        if (iVar18 == -1) goto LAB_0010d912;
        goto LAB_0010dc57;
      }
    }
    goto LAB_0010dca8;
  }
  if ((((!bVar4) || (iVar6 = FUN_00114fd0(param_1,", with escape sequences", ""), iVar6 != -1)) &&
      (uVar19 = 1, uVar17 != 0)) &&
     (iVar6 = FUN_00114fd0(param_1,", with overstriking", ""), uVar19 = local_48, iVar6 != -1)) {
    uVar19 = uVar17;
  }
LAB_0010d912:
  free(__ptr);
  return uVar19;
}



int FUN_0010e310(undefined8 param_1,long param_2,ulong param_3,undefined4 param_4)

{
  int iVar1;
  ulong uVar2;
  long in_FS_OFFSET;
  void *local_58;
  undefined8 local_50;
  undefined8 local_48;
  undefined8 local_40;
  undefined8 local_38;
  long local_30;
  
  local_30 = *(long *)(in_FS_OFFSET + 0x28);
  local_58 = (void *)0x0;
  local_50 = 0;
  local_48 = 0;
  local_40 = 0;
  local_38 = 0;
  do {
    uVar2 = param_3;
    if (uVar2 < 2) break;
    param_3 = uVar2 - 1;
  } while (*(char *)(param_2 + -1 + uVar2) == '\0');
  iVar1 = FUN_0010e5b0(param_1,param_2,uVar2,&local_58,&local_50,&local_48,&local_40,&local_38);
  if (iVar1 != 0) {
    iVar1 = FUN_0010d8d0(param_1,param_2,uVar2,local_58,local_50,local_48,local_38,param_4);
  }
  free(local_58);
  if (local_30 != *(long *)(in_FS_OFFSET + 0x28)) {
                    // WARNING: Subroutine does not return
    __stack_chk_fail();
  }
  return iVar1;
}



undefined8 FUN_0010e410(long param_1,ulong param_2,long param_3,long *param_4)

{
  byte bVar1;
  long lVar2;
  bool bVar3;
  bool bVar4;
  int iVar5;
  undefined8 uVar6;
  ulong uVar7;
  ulong uVar8;
  ulong uVar9;
  
  if (param_3 != 0) {
    *param_4 = 0;
  }
  if (param_2 == 0) {
    return 1;
  }
  bVar3 = false;
  uVar8 = 0;
  bVar4 = false;
  do {
    bVar1 = *(byte *)(param_1 + uVar8);
    if ((char)bVar1 < '\0') {
      if ((bVar1 & 0x40) == 0) {
        return 0xffffffff;
      }
      if ((bVar1 & 0x20) == 0) {
        iVar5 = 1;
        uVar7 = (ulong)(bVar1 & 0x1f);
      }
      else if ((bVar1 & 0x10) == 0) {
        iVar5 = 2;
        uVar7 = (ulong)(bVar1 & 0xf);
      }
      else if ((bVar1 & 8) == 0) {
        iVar5 = 3;
        uVar7 = (ulong)(bVar1 & 7);
      }
      else if ((bVar1 & 4) == 0) {
        iVar5 = 4;
        uVar7 = (ulong)(bVar1 & 3);
      }
      else {
        if ((bVar1 & 2) != 0) {
          return 0xffffffff;
        }
        iVar5 = 5;
        uVar7 = (ulong)(bVar1 & 1);
      }
      uVar8 = uVar8 + 1;
      uVar9 = (iVar5 - 1) + uVar8;
      while( true ) {
        if (param_2 <= uVar8) goto LAB_0010e478;
        bVar1 = *(byte *)(param_1 + uVar8);
        if (-1 < (char)bVar1) {
          return 0xffffffff;
        }
        if ((bVar1 & 0x40) != 0) {
          return 0xffffffff;
        }
        uVar7 = uVar7 * 0x40 + (ulong)(bVar1 & 0x3f);
        if (uVar9 == uVar8) break;
        uVar8 = uVar8 + 1;
      }
      bVar4 = true;
      if (param_3 != 0) {
        lVar2 = *param_4;
        *param_4 = lVar2 + 1;
        *(ulong *)(param_3 + lVar2 * 8) = uVar7;
      }
    }
    else {
      if ((&DAT_0011dbe0)[bVar1] != '\x01') {
        bVar3 = true;
      }
      if (param_3 != 0) {
        lVar2 = *param_4;
        *param_4 = lVar2 + 1;
        *(ulong *)(param_3 + lVar2 * 8) = (ulong)bVar1;
      }
    }
    uVar8 = uVar8 + 1;
  } while (uVar8 < param_2);
LAB_0010e478:
  uVar6 = 0;
  if ((!bVar3) && (uVar6 = 2, !bVar4)) {
    return 1;
  }
  return uVar6;
}



undefined8
FUN_0010e5b0(undefined8 param_1,byte *param_2,ulong param_3,long *param_4,long *param_5,
            undefined8 *param_6,undefined8 *param_7,undefined8 *param_8)

{
  size_t __size;
  long *plVar1;
  byte bVar2;
  byte bVar3;
  bool bVar4;
  int iVar5;
  void *pvVar6;
  byte *__ptr;
  long lVar7;
  ulong uVar8;
  long lVar9;
  char *pcVar10;
  byte *pbVar11;
  byte *pbVar12;
  undefined8 uVar13;
  
  __size = param_3 + 1;
  *param_8 = &DAT_0011d9e0;
  *param_5 = 0;
  *param_6 = "unknown";
  *param_7 = "binary";
  pvVar6 = calloc(1,__size * 8);
  *param_4 = (long)pvVar6;
  if (pvVar6 == (void *)0x0) {
    uVar13 = 1;
    FUN_00115200(param_1,__size * 8);
    __ptr = (byte *)0x0;
  }
  else {
    __ptr = (byte *)calloc(1,__size);
    if (__ptr == (byte *)0x0) {
      uVar13 = 1;
      FUN_00115200(param_1,__size);
    }
    else {
      *param_5 = 0;
      if (param_3 != 0) {
        pbVar12 = param_2 + param_3;
        pbVar11 = param_2;
        do {
          bVar2 = *pbVar11;
          if ((&DAT_0011dbe0)[bVar2] != '\x01') {
            if (param_3 < 4) {
              iVar5 = FUN_0010e410(param_2,param_3,pvVar6,param_5);
              if (iVar5 < 2) {
                lVar7 = *param_4;
                if (param_3 == 1) goto LAB_0010e8db;
LAB_0010e7fc:
                if (*param_2 == 0xff) {
                  if (param_2[1] != 0xfe) goto LAB_0010e8db;
                  *param_5 = 0;
                  bVar4 = false;
                  if (param_3 < 4) goto LAB_0010ea7e;
                }
                else {
                  if ((*param_2 != 0xfe) || (param_2[1] != 0xff)) goto LAB_0010e8db;
                  *param_5 = 0;
                  bVar4 = true;
                  if (param_3 < 4) goto LAB_0010ea0d;
                }
                pbVar11 = param_2 + 2;
                lVar9 = 0;
                goto LAB_0010e880;
              }
LAB_0010e7e4:
              pcVar10 = "UTF-8 Unicode";
            }
            else {
              if (((*param_2 != 0xef) || (param_2[1] != 0xbb)) || (param_2[2] != 0xbf)) {
LAB_0010e7c4:
                iVar5 = FUN_0010e410(param_2,param_3,pvVar6,param_5);
                if (iVar5 < 2) {
                  lVar7 = *param_4;
                  goto LAB_0010e7fc;
                }
                goto LAB_0010e7e4;
              }
              iVar5 = FUN_0010e410(param_2 + 3,param_3 - 3,pvVar6,param_5);
              if (iVar5 < 1) {
                pvVar6 = (void *)*param_4;
                goto LAB_0010e7c4;
              }
              pcVar10 = "UTF-8 Unicode (with BOM)";
            }
            *param_6 = pcVar10;
            uVar13 = 1;
            *param_7 = "utf-8";
            goto LAB_0010e714;
          }
          lVar7 = *param_5;
          pbVar11 = pbVar11 + 1;
          *(ulong *)((long)pvVar6 + lVar7 * 8) = (ulong)bVar2;
          *param_5 = lVar7 + 1;
        } while (pbVar12 != pbVar11);
        if (((((4 < param_3) && (*param_2 == 0x2b)) && (param_2[1] == 0x2f)) &&
            ((param_2[2] == 0x76 && (param_2[3] < 0x3a)))) &&
           ((0x300880000000000U >> ((ulong)param_2[3] & 0x3f) & 1) != 0)) {
          *param_5 = 0;
          uVar13 = 1;
          *param_6 = "UTF-7 Unicode";
          *param_7 = "utf-7";
          goto LAB_0010e714;
        }
      }
      uVar13 = 1;
      *param_6 = "ASCII";
      *param_7 = "us-ascii";
    }
  }
  goto LAB_0010e714;
  while (pbVar11 = pbVar11 + 2, param_2 + (param_3 - 4 & 0xfffffffffffffffe) + 4 != pbVar11) {
LAB_0010e880:
    bVar2 = *pbVar11;
    bVar3 = pbVar11[1];
    plVar1 = (long *)(lVar7 + lVar9 * 8);
    *param_5 = lVar9 + 1;
    if (bVar4) {
      *plVar1 = (long)(int)((uint)bVar3 + (uint)bVar2 * 0x100);
    }
    else {
      *plVar1 = (long)(int)((uint)bVar3 * 0x100 + (uint)bVar2);
    }
    lVar9 = *param_5;
    uVar8 = *(ulong *)(lVar7 + -8 + lVar9 * 8);
    if ((uVar8 == 0xfffe) || ((uVar8 < 0x80 && ((&DAT_0011dbe0)[uVar8] != '\x01'))))
    goto LAB_0010e8db;
  }
  if (bVar4) {
LAB_0010ea0d:
    uVar13 = 1;
    *param_6 = "Big-endian UTF-16 Unicode";
    *param_7 = "utf-16be";
  }
  else {
LAB_0010ea7e:
    uVar13 = 1;
    *param_6 = "Little-endian UTF-16 Unicode";
    *param_7 = "utf-16le";
  }
  goto LAB_0010e714;
LAB_0010e948:
  bVar2 = *pbVar11;
  if ((int)(char)(&DAT_0011dbe0)[bVar2] - 1U < 3) {
    lVar9 = *param_5;
    pbVar11 = pbVar11 + 1;
    *param_5 = lVar9 + 1;
    *(ulong *)(lVar7 + lVar9 * 8) = (ulong)bVar2;
    if (pbVar12 == pbVar11) goto LAB_0010eaa7;
    goto LAB_0010e948;
  }
  uVar8 = 0;
  do {
    __ptr[uVar8] = (&DAT_0011dae0)[param_2[uVar8]];
    uVar8 = uVar8 + 1;
  } while (param_3 != uVar8);
  *param_5 = 0;
  pbVar12 = __ptr;
  do {
    bVar2 = *pbVar12;
    if ((&DAT_0011dbe0)[bVar2] != '\x01') {
      *param_5 = 0;
      pbVar12 = __ptr;
      do {
        bVar2 = *pbVar12;
        if (1 < (int)(char)(&DAT_0011dbe0)[bVar2] - 1U) {
          uVar13 = 0;
          *param_8 = "binary";
          goto LAB_0010e714;
        }
        lVar9 = *param_5;
        pbVar12 = pbVar12 + 1;
        *param_5 = lVar9 + 1;
        *(ulong *)(lVar7 + lVar9 * 8) = (ulong)bVar2;
      } while (pbVar12 != __ptr + param_3);
      pcVar10 = "International EBCDIC";
      goto LAB_0010eadc;
    }
    lVar9 = *param_5;
    pbVar12 = pbVar12 + 1;
    *param_5 = lVar9 + 1;
    *(ulong *)(lVar7 + lVar9 * 8) = (ulong)bVar2;
  } while (__ptr + param_3 != pbVar12);
  pcVar10 = "EBCDIC";
LAB_0010eadc:
  *param_6 = pcVar10;
  uVar13 = 1;
  *param_7 = "ebcdic";
  goto LAB_0010e714;
LAB_0010eaa7:
  uVar13 = 1;
  *param_6 = "Non-ISO extended-ASCII";
  *param_7 = "unknown-8bit";
  goto LAB_0010e714;
LAB_0010e8db:
  *param_5 = 0;
  pbVar11 = param_2;
  do {
    bVar2 = *pbVar11;
    if (1 < (int)(char)(&DAT_0011dbe0)[bVar2] - 1U) {
      *param_5 = 0;
      pbVar11 = param_2;
      goto LAB_0010e948;
    }
    lVar9 = *param_5;
    pbVar11 = pbVar11 + 1;
    *param_5 = lVar9 + 1;
    *(ulong *)(lVar7 + lVar9 * 8) = (ulong)bVar2;
  } while (pbVar12 != pbVar11);
  uVar13 = 1;
  *param_6 = "ISO-8859";
  *param_7 = "iso-8859-1";
LAB_0010e714:
  free(__ptr);
  return uVar13;
}



bool FUN_0010eb50(byte *param_1)

{
  byte bVar1;
  bool bVar2;
  
  bVar1 = *param_1;
  bVar2 = false;
  if (((bVar1 & 0xf) == 8) && (-1 < (char)bVar1)) {
    bVar2 = (ushort)(CONCAT11(bVar1,param_1[1]) * 0x7bdf) < 0x843;
  }
  return bVar2;
}



size_t FUN_0010eb90(int param_1,void *param_2,size_t param_3)

{
  ssize_t sVar1;
  int *piVar2;
  size_t __n;
  
  __n = param_3;
  do {
    sVar1 = write(param_1,param_2,__n);
    if (sVar1 == -1) {
      piVar2 = __errno_location();
      if (*piVar2 != 4) {
        return 0xffffffffffffffff;
      }
    }
    else {
      __n = __n - sVar1;
      param_2 = (void *)((long)param_2 + sVar1);
    }
  } while (__n != 0);
  return param_3;
}



undefined8 FUN_0010ec00(undefined8 *param_9,size_t *param_10,undefined8 param_11)

{
  char in_AL;
  int iVar1;
  size_t sVar2;
  undefined8 uVar3;
  long in_FS_OFFSET;
  char *local_f0;
  undefined4 local_e8;
  undefined4 local_e4;
  undefined *local_e0;
  undefined *local_d8;
  long local_d0;
  undefined local_c8 [24];

  local_d0 = *(long *)(in_FS_OFFSET + 0x28);
  local_e0 = &stack0x00000008;
  local_e8 = 0x18;
  local_d8 = local_c8;
  local_e4 = 0x30;
  iVar1 = __vasprintf_chk(&local_f0,1,param_11,&local_e8);
  if (iVar1 < 0) {
    *param_9 = 0;
    uVar3 = 1;
    *param_10 = 0;
  }
  else {
    *param_9 = local_f0;
    sVar2 = strlen(local_f0);
    *param_10 = sVar2;
    uVar3 = 2;
  }
  if (local_d0 == *(long *)(in_FS_OFFSET + 0x28)) {
    return uVar3;
  }
                    // WARNING: Subroutine does not return
  __stack_chk_fail();
}



ulong FUN_0010ed00(undefined8 param_1,long *param_2,long param_3,size_t *param_4,int param_5)

{
  int iVar1;
  void *pvVar2;
  ulong uVar3;
  size_t sVar4;
  int *piVar5;
  char *pcVar6;
  long in_FS_OFFSET;
  undefined8 local_a8;
  undefined4 local_a0;
  void *local_90;
  undefined4 local_88;
  size_t local_80;
  long local_78;
  undefined8 local_68;
  undefined8 local_60;
  undefined8 local_58;
  long local_30;
  
  local_30 = *(long *)(in_FS_OFFSET + 0x28);
  pvVar2 = malloc(param_3 + 1);
  *param_2 = (long)pvVar2;
  if (pvVar2 == (void *)0x0) {
    piVar5 = __errno_location();
    pcVar6 = strerror(*piVar5);
    uVar3 = FUN_0010ec00(param_2,param_4,"No buffer, %s");
  }
  else {
    local_a0 = (undefined4)*param_4;
    local_88 = (undefined4)param_3;
    local_68 = 0;
    local_60 = 0;
    local_58 = 0;
    local_a8 = param_1;
    local_90 = pvVar2;
    if (param_5 == 0) {
      uVar3 = inflateInit2_(&local_a8,0xfffffff1,"1.2.11",0x70);
      iVar1 = (int)uVar3;
    }
    else {
      uVar3 = inflateInit_(&local_a8,"1.2.11",0x70);
      iVar1 = (int)uVar3;
    }
    if ((iVar1 == 0) && (uVar3 = inflate(&local_a8,2), (uint)uVar3 < 2)) {
      *param_4 = local_80;
      uVar3 = inflateEnd(&local_a8);
      if ((int)uVar3 == 0) {
        *(undefined *)(*param_2 + *param_4) = 0;
        goto LAB_0010edc9;
      }
    }
    if (local_78 == 0) {
      local_78 = zError(uVar3 & 0xffffffff);
    }
    FUN_00119e40(*param_2,local_78,param_3);
    sVar4 = strlen((char *)*param_2);
    *param_4 = sVar4;
    uVar3 = 2;
  }
LAB_0010edc9:
  if (local_30 != *(long *)(in_FS_OFFSET + 0x28)) {
                    // WARNING: Subroutine does not return
    __stack_chk_fail();
  }
  return uVar3;
}



void FUN_0010ee80(int *param_1)

{
  if (*param_1 != -1) {
    close(*param_1);
    *param_1 = -1;
  }
  if (param_1[1] != -1) {
    close(param_1[1]);
    param_1[1] = -1;
  }
  return;
}



ulong FUN_0010eeb0(int param_1,void *param_2,size_t param_3,int param_4)

{
  byte bVar1;
  int iVar2;
  ssize_t sVar3;
  int *piVar4;
  ulong uVar5;
  long lVar6;
  __fd_mask *p_Var7;
  ulong uVar8;
  long in_FS_OFFSET;
  long local_f8;
  int local_dc;
  timeval local_d8;
  ulong local_c8 [17];
  long local_40;
  
  local_40 = *(long *)(in_FS_OFFSET + 0x28);
  local_dc = 0;
  uVar8 = param_3;
  if ((param_1 != 0) && (param_4 != 0)) {
    iVar2 = ioctl(param_1,0x541b,&local_dc);
    if ((iVar2 == -1) || (local_dc == 0)) {
      local_f8 = 0;
      bVar1 = (byte)(param_1 >> 0x1f);
      while( true ) {
        local_d8.tv_sec = 0;
        local_d8.tv_usec = 100000;
        p_Var7 = (__fd_mask *)local_c8;
        for (lVar6 = 0x10; lVar6 != 0; lVar6 = lVar6 + -1) {
          *p_Var7 = 0;
          p_Var7 = p_Var7 + 1;
        }
        lVar6 = __fdelt_chk((long)param_1);
        local_c8[lVar6] =
             local_c8[lVar6] | 1L << (((char)param_1 + (bVar1 >> 2) & 0x3f) - (bVar1 >> 2) & 0x3f);
        iVar2 = select(param_1 + 1,(fd_set *)local_c8,(fd_set *)0x0,(fd_set *)0x0,&local_d8);
        if (iVar2 != -1) break;
        local_f8 = local_f8 + 1;
      }
      if ((iVar2 == 0) && (uVar8 = 0, 4 < local_f8)) goto LAB_0010ef20;
      ioctl(param_1,0x541b,&local_dc);
    }
    uVar5 = (ulong)local_dc;
    uVar8 = param_3;
    if ((0 < local_dc) && (uVar5 < param_3)) {
      param_3 = uVar5;
      uVar8 = uVar5;
    }
  }
  do {
    sVar3 = read(param_1,param_2,param_3);
    if (sVar3 == -1) {
      piVar4 = __errno_location();
      if (*piVar4 != 4) {
        uVar8 = 0xffffffffffffffff;
        break;
      }
    }
    else {
      if (sVar3 == 0) {
        uVar8 = uVar8 - param_3;
        break;
      }
      param_3 = param_3 - sVar3;
      param_2 = (void *)((long)param_2 + sVar3);
    }
  } while (param_3 != 0);
LAB_0010ef20:
  if (local_40 != *(long *)(in_FS_OFFSET + 0x28)) {
                    // WARNING: Subroutine does not return
    __stack_chk_fail();
  }
  return uVar8;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

uint FUN_0010f080(long param_1,int param_2,undefined8 param_3,void *param_4,ulong param_5)

{
  byte bVar1;
  char **__argv;
  byte *__dest;
  uint uVar2;
  __pid_t _Var3;
  int iVar4;
  uint uVar5;
  __sighandler_t __handler;
  char *pcVar6;
  int *piVar7;
  char *pcVar8;
  long lVar9;
  void *__ptr;
  size_t sVar10;
  ulong uVar11;
  long *plVar12;
  __int32_t **pp_Var13;
  size_t sVar14;
  undefined *puVar15;
  int __fd2;
  long lVar16;
  ulong uVar17;
  undefined8 *puVar18;
  byte *__s;
  long lVar19;
  undefined **ppuVar20;
  long in_FS_OFFSET;
  uint local_c4;
  undefined8 *local_b0;
  size_t local_88;
  undefined local_6c [4];
  byte *local_68;
  size_t local_60;
  undefined8 local_58;
  undefined8 local_50;
  undefined8 local_48;
  long local_40;
  
  local_40 = *(long *)(in_FS_OFFSET + 0x28);
  local_68 = (byte *)0x0;
  local_c4 = *(uint *)(param_1 + 0x38) & 4;
  if (local_c4 == 0) {
LAB_0010f0c8:
    if (local_40 == *(long *)(in_FS_OFFSET + 0x28)) {
      return local_c4;
    }
                    // WARNING: Subroutine does not return
    __stack_chk_fail();
  }
  uVar2 = *(uint *)(param_1 + 0x38) & 0x410;
  __handler = signal(0xd,(__sighandler_t)0x1);
  uVar17 = 2;
  pcVar6 = " (";
  lVar16 = 1;
  ppuVar20 = &PTR_FUN_001235a0;
  if (uVar2 != 0) {
    pcVar6 = " compressed-encoding=";
  }
  local_c4 = 0;
LAB_0010f38d:
  lVar9 = lVar16 + -1;
  if (param_5 < uVar17) {
joined_r0x0010f36c:
    lVar9 = lVar16;
    if (lVar16 == 0xe) goto LAB_0010f3f0;
  }
  else {
    if (uVar17 == 0) {
      uVar5 = (*(code *)*ppuVar20)(param_4)(); //TODO: Fix this.
    }
    else {
      iVar4 = memcmp(param_4,*ppuVar20,uVar17);
      uVar5 = (uint)(iVar4 == 0);
    }
    if (uVar5 == 0) goto joined_r0x0010f36c;
    lVar19 = *(long *)(param_1 + 0xe0);
    local_60 = param_5;
    if (lVar9 != 2) {
      if (uVar17 == 0) {
        *(undefined4 *)(local_88 + 0) = FUN_0010ed00(param_4,&local_68,lVar19,&local_60,1);
      }
      else {
        fflush(_stdout);
        fflush(_stderr);
        local_58 = 0xffffffffffffffff;
        local_50 = 0xffffffffffffffff;
        local_48 = 0xffffffffffffffff;
        if ((((param_2 == -1) && (iVar4 = pipe((int *)&local_58), iVar4 == -1)) ||
            (iVar4 = pipe((int *)&local_50), iVar4 == -1)) ||
           (iVar4 = pipe((int *)&local_48), iVar4 == -1)) {
          local_b0 = &local_50;
          FUN_0010ee80(&local_58);
          FUN_0010ee80(local_b0);
          piVar7 = __errno_location();
          pcVar8 = strerror(*piVar7);
          *(undefined4 *)(local_88 + 0) = FUN_0010ec00(&local_68,&local_60,"Cannot create pipe, %s");
        }
        else {
          _Var3 = fork();
          if (_Var3 == -1) {
            piVar7 = __errno_location();
            pcVar8 = strerror(*piVar7);
            *(undefined4 *)(local_88 + 0) = FUN_0010ec00(&local_68,&local_60,"Cannot fork, %s");
          }
          else {
            if (_Var3 == 0) {
              if (param_2 != -1) {
                local_58 = CONCAT44(*(undefined4 *)(local_58 + 4),param_2);
                lseek(param_2,0,0);
              }
              puVar18 = &local_58;
              lVar16 = 0;
              goto LAB_0010faec;
            }
            if (*(undefined4 *)(local_50 + 4) != -1) {
              close(*(undefined4 *)(local_50 + 4));
              local_50 = CONCAT44(0xffffffff,(int)local_50);
            }
            if (*(undefined4 *)(local_48 + 4) != -1) {
              close(*(undefined4 *)(local_48 + 4));
              local_48 = CONCAT44(0xffffffff,(int)local_48);
            }
            sVar10 = local_60;
            if (param_2 == -1) {
              if ((int)local_58 != -1) {
                close((int)local_58);
                local_58 = CONCAT44(*(undefined4 *)(local_58 + 4),0xffffffff);
              }
              _Var3 = fork();
              if (_Var3 == -1) goto LAB_0010fb64;
              if (_Var3 == 0) {
                if ((int)local_50 != -1) {
                  close((int)local_50);
                  local_50 = CONCAT44(*(undefined4 *)(local_50 + 4),0xffffffff);
                }
                sVar14 = FUN_0010eb90(*(undefined4 *)(local_58 + 4),param_4,sVar10);
                if (sVar14 == sVar10) {
                    // WARNING: Subroutine does not return
                  exit(0);
                }
                goto LAB_0010fb64;
              }
              _Var3 = wait(local_6c);
              if (_Var3 == -1) goto LAB_0010fb64;
              if (*(undefined4 *)(local_58 + 4) != -1) {
                close(*(undefined4 *)(local_58 + 4));
                local_58 = CONCAT44(0xffffffff,(int)local_58);
              }
            }
            local_b0 = (undefined8 *)local_6c;
            local_68 = (byte *)malloc(lVar19 + 1);
            if (local_68 == (byte *)0x0) {
              piVar7 = __errno_location();
              pcVar8 = strerror(*piVar7);
              *(undefined4 *)(local_88 + 0) = FUN_0010ec00(&local_68,&local_60,"No buffer, %s");
            }
            else {
              sVar10 = FUN_0010eeb0(local_50 & 0xffffffff,local_68,lVar19,0);
              *(undefined4 *)(local_88 + 0) = 0;
              if ((long)sVar10 < 1) {
                if (sVar10 == 0) {
                  local_88 = FUN_0010eeb0(local_48 & 0xffffffff,local_68,lVar19,0);
                  __dest = local_68;
                  if (0 < (long)local_88) {
                    local_68[local_88] = 0;
                    plVar12 = (long *)FUN_00104d70();
                    __s = __dest;
                    while ((*(byte *)(*plVar12 + 1 + (ulong)*__s * 2) & 0x20) != 0) {
                      __s = __s + 1;
                    }
                    pcVar8 = strchr((char *)__s,10);
                    if (pcVar8 != (char *)0x0) {
                      *pcVar8 = '\0';
                    }
                    pcVar8 = strchr((char *)__s,0x3b);
                    if (pcVar8 != (char *)0x0) {
                      *pcVar8 = '\0';
                    }
                    pcVar8 = strrchr((char *)__s,0x3a);
                    lVar19 = *plVar12;
                    if (pcVar8 != (char *)0x0) {
                      bVar1 = *(byte *)(lVar19 + 1 + (ulong)(byte)pcVar8[1] * 2);
                      while (pcVar8 = pcVar8 + 1, (bVar1 & 0x20) != 0) {
                        bVar1 = *(byte *)(lVar19 + 1 + (ulong)(byte)pcVar8[1] * 2);
                      }
                      local_88 = strlen(pcVar8);
                      memmove(__dest,pcVar8,local_88 + 1);
                      lVar19 = *plVar12;
                    }
                    sVar10 = local_88;
                    *(undefined4 *)(local_88 + 0) = 2;
                    bVar1 = *__dest;
                    if ((*(byte *)(lVar19 + 1 + (ulong)bVar1 * 2) & 2) != 0) {
                      pp_Var13 = __ctype_toupper_loc();
                      *(undefined4 *)(local_88 + 0) = 2;
                      *__dest = (byte)(*pp_Var13)[bVar1];
                    }
                    goto LAB_0010f5b5;
                  }
                  free(local_68);
                  if (local_88 == 0) {
                    piVar7 = __errno_location();
                    pcVar8 = strerror(*piVar7);
                    *(undefined4 *)(local_88 + 0) = FUN_0010ec00(&local_68,&local_60,"Read failed, %s");
                    goto LAB_0010f5c3;
                  }
                }
                else {
                  free(local_68);
                }
                *(undefined4 *)(local_88 + 0) = FUN_0010ec00(&local_68,&local_60,"No data");
              }
              else {
LAB_0010f5b5:
                local_68[sVar10] = 0;
                local_60 = sVar10;
              }
            }
LAB_0010f5c3:
            if (*(undefined4 *)(local_58 + 4) != -1) {
              close(*(undefined4 *)(local_58 + 4));
              local_58 = CONCAT44(0xffffffff,(int)local_58);
            }
            if ((int)local_50 != -1) {
              close((int)local_50);
              local_50 = CONCAT44(*(undefined4 *)(local_50 + 4),0xffffffff);
            }
            if ((int)local_48 != -1) {
              close((int)local_48);
              local_48 = CONCAT44(*(undefined4 *)(local_48 + 4),0xffffffff);
            }
            _Var3 = wait(local_b0);
            if (_Var3 == -1) {
              free(local_68);
              piVar7 = __errno_location();
              pcVar8 = strerror(*piVar7);
              *(undefined4 *)(local_88 + 0) = FUN_0010ec00(&local_68,&local_60,"Wait failed, %s");
            }
            if ((int)local_58 != -1) {
              close((int)local_58);
            }
          }
        }
      }
      if ((uint)local_88 == 1) goto joined_r0x0010f36c;
      if (((uint)local_88 & 0xfffffffd) != 0) goto ABORT_LABEL;
      *(uint *)(param_1 + 0x38) = *(uint *)(param_1 + 0x38) & 0xfffffffb;
      if ((uint)local_88 == 2) {
        if ((uVar17 == 0) || (lVar9 == 2)) {
          puVar15 = &DAT_0011dd35;
        }
        else {
          puVar15 = *(undefined **)ppuVar20[2];
        }
        goto LAB_0010f295;
      }
LAB_0010f490:
      iVar4 = FUN_001152a0(param_1,0xffffffff,param_3,local_68);
LAB_0010f2a6:
      if (iVar4 != -1) {
        if (((*(byte *)(param_1 + 0x3b) & 2) != 0) || ((uVar2 != 0x410 && (uVar2 != 0)))) {
          local_c4 = 1;
LAB_0010f3f0:
          signal(0xd,__handler);
          free(local_68);
          *(uint *)(param_1 + 0x38) = *(uint *)(param_1 + 0x38) | 4;
          goto LAB_0010f0c8;
        }
        iVar4 = FUN_00114fd0(param_1, "", pcVar6);
        if (((iVar4 != -1) && (lVar9 = FUN_00115e40(param_1), lVar9 != 0)) &&
           (iVar4 = FUN_001152a0(param_1,0xffffffff,0,param_4), iVar4 != -1)) {
          __ptr = (void *)FUN_00115e90(param_1,lVar9);
          if (__ptr != (void *)0x0) {
            iVar4 = FUN_00114fd0(param_1,"%s",__ptr);
            if (iVar4 == -1) {
              free(__ptr);
              local_c4 = 0xffffffff;
              goto joined_r0x0010f36c;
            }
            free(__ptr);
          }
          if ((uVar2 != 0) || (iVar4 = FUN_00114fd0(param_1,")", ""), iVar4 != -1)) {
            local_c4 = 1;
            goto joined_r0x0010f36c;
          }
        }
      }
      local_c4 = 0xffffffff;
      goto joined_r0x0010f36c;
    }
    bVar1 = *(byte *)((long)param_4 + 3);
    if ((bVar1 & 4) == 0) {
      uVar17 = 10;
LAB_0010f6c8:
      if ((bVar1 & 8) != 0) {
        if (uVar17 < param_5) {
          do {
            uVar11 = uVar17;
            uVar17 = uVar11 + 1;
            if (*(char *)((long)param_4 + uVar11) == '\0') goto LAB_0010f6f9;
          } while (uVar17 < param_5);
          uVar17 = uVar11 + 2;
        }
        else {
          uVar17 = uVar17 + 1;
        }
      }
LAB_0010f6f9:
      if ((bVar1 & 0x10) != 0) {
        if (uVar17 < param_5) {
          do {
            uVar11 = uVar17;
            uVar17 = uVar11 + 1;
            if (*(char *)((long)param_4 + uVar11) == '\0') goto LAB_0010f420;
          } while (uVar17 < param_5);
          uVar17 = uVar11 + 2;
        }
        else {
          uVar17 = uVar17 + 1;
        }
      }
LAB_0010f420:
      if ((bVar1 & 2) != 0) {
        uVar17 = uVar17 + 2;
      }
      if (param_5 <= uVar17) goto LAB_0010f8d8;
      local_60 = param_5 - uVar17;
      uVar5 = FUN_0010ed00((long)param_4 + uVar17,&local_68,lVar19,&local_60,0);
    }
    else {
      if (0xb < param_5) {
        uVar17 = (long)(int)(*(byte *)((long)param_4 + 10) + 2 +
                            (uint)*(byte *)((long)param_4 + 0xb) * 0x100) + 10;
        goto LAB_0010f6c8;
      }
LAB_0010f8d8:
      uVar5 = FUN_0010ec00(&local_68,&local_60,"File too short");
    }
    if (uVar5 != 1) {
      if ((uVar5 & 0xfffffffd) != 0) {
ABORT_LABEL:
                    // WARNING: Subroutine does not return
        abort();
      }
      *(uint *)(param_1 + 0x38) = *(uint *)(param_1 + 0x38) & 0xfffffffb;
      puVar15 = &DAT_0011dd35;
      if (uVar5 != 2) goto LAB_0010f490;
LAB_0010f295:
      iVar4 = FUN_00114fd0(param_1,"%s ERROR: %s",puVar15);
      goto LAB_0010f2a6;
    }
    lVar9 = 3;
  }
  lVar16 = lVar16 + 1;
  ppuVar20 = ppuVar20 + 3;
  uVar17 = *(ulong *)(&UNK_001235a8 + lVar9 * 0x18);
  goto LAB_0010f38d;
LAB_0010faec:
  do {
    __fd2 = (int)lVar16;
    iVar4 = *(int *)((long)puVar18 + (ulong)(__fd2 != 0) * 4);
    if (iVar4 != __fd2) {
      iVar4 = dup2(iVar4,__fd2);
      if (iVar4 == -1) goto LAB_0010fb64;
      FUN_0010ee80(puVar18);
    }
    lVar16 = lVar16 + 1;
    puVar18 = puVar18 + 1;
  } while (lVar16 != 3);
  __argv = (char **)(&PTR_PTR_DAT_001235b0)[lVar9 * 3];
  execvp(*__argv,__argv);
  piVar7 = __errno_location();
  pcVar6 = strerror(*piVar7);
  __dprintf_chk(2,1,"exec `%s\' failed, %s",*__argv,pcVar6);
LAB_0010fb64:
                    // WARNING: Subroutine does not return
  exit(1);
}



int FUN_0010fb80(undefined8 param_1,int param_2,undefined8 param_3,long param_4)

{
  int iVar1;
  int __fd;
  int __fd_00;
  int *piVar2;
  long lVar3;
  long lVar4;
  __off_t _Var5;
  char *pcVar6;
  long in_FS_OFFSET;
  char local_1048 [4104];
  long local_40;
  
  local_40 = *(long *)(in_FS_OFFSET + 0x28);
  FUN_00119e40(local_1048,"/tmp/file.XXXXXX",0x1000);
  __fd = mkstemp(local_1048);
  piVar2 = __errno_location();
  iVar1 = *piVar2;
  unlink(local_1048);
  *piVar2 = iVar1;
  if (__fd == -1) {
    __fd_00 = -1;
    FUN_00114dc0(param_1,iVar1,"cannot create temporary file for pipe copy");
  }
  else {
    lVar3 = FUN_0010eb90(__fd,param_3,param_4);
    if (lVar3 == param_4) {
      do {
        lVar3 = FUN_0010eeb0(param_2,local_1048,0x1000,1);
        if (lVar3 < 1) {
          pcVar6 = "error copying from pipe to temp file";
          if (lVar3 == -1) goto LAB_0010fc71;
          if (lVar3 == 0) {
            __fd_00 = dup2(__fd,param_2);
            if (__fd_00 == -1) {
              FUN_00114dc0(param_1,*piVar2,"could not dup descriptor for temp file");
            }
            else {
              close(__fd);
              _Var5 = lseek(__fd_00,0,0);
              if (_Var5 == -1) {
                __fd_00 = -1;
                FUN_00115240(param_1);
              }
            }
            goto LAB_0010fc84;
          }
          break;
        }
        lVar4 = FUN_0010eb90(__fd,local_1048,lVar3);
      } while (lVar4 == lVar3);
    }
    pcVar6 = "error while writing to temp file";
LAB_0010fc71:
    __fd_00 = -1;
    FUN_00114dc0(param_1,*piVar2,pcVar6);
  }
LAB_0010fc84:
  if (local_40 != *(long *)(in_FS_OFFSET + 0x28)) {
                    // WARNING: Subroutine does not return
    __stack_chk_fail();
  }
  return __fd_00;
}



int FUN_0010fd40(long param_1,byte *param_2,ulong param_3)

{
  byte bVar1;
  uint uVar2;
  char cVar3;
  long *plVar4;
  ulong uVar5;
  uint uVar6;
  long lVar7;
  int iVar8;
  char *pcVar9;
  byte *pbVar10;
  byte *pbVar11;
  bool bVar12;
  bool bVar13;
  byte bVar14;
  
  bVar14 = 0;
  uVar2 = *(uint *)(param_1 + 0x38);
  if ((uVar2 & 0x1000800) != 0) {
    return 0;
  }
  if (param_3 < 0x200) {
    return 0;
  }
  pbVar10 = param_2 + 0x94;
  plVar4 = (long *)FUN_00104d70();
  iVar8 = 8;
  do {
    uVar5 = (ulong)*pbVar10;
    if ((*(byte *)(*plVar4 + 1 + uVar5 * 2) & 0x20) == 0) {
      uVar6 = 0;
      pbVar11 = pbVar10 + (ulong)(iVar8 - 1) + 1;
      goto LAB_0010fdc3;
    }
    pbVar10 = pbVar10 + 1;
    iVar8 = iVar8 + -1;
  } while (iVar8 != 0);
  uVar6 = 0xffffffff;
LAB_0010fde3:
  iVar8 = 0;
  pbVar10 = param_2;
  do {
    bVar1 = *pbVar10;
    pbVar10 = pbVar10 + 1;
    iVar8 = iVar8 + (uint)bVar1;
  } while (pbVar10 != param_2 + 0x200);
  pbVar10 = param_2 + 0x9b;
  do {
    bVar1 = *pbVar10;
    pbVar10 = pbVar10 + -1;
    iVar8 = iVar8 - (char)bVar1;
  } while (param_2 + 0x93 != pbVar10);
  bVar12 = iVar8 + 0x100U < uVar6;
  bVar13 = iVar8 + 0x100U == uVar6;
  if (!bVar13) {
    return 0;
  }
  lVar7 = 8;
  iVar8 = 3;
  pbVar10 = param_2 + 0x101;
  pbVar11 = (byte *)"ustar  ";
  do {
    if (lVar7 == 0) break;
    lVar7 = lVar7 + -1;
    bVar12 = *pbVar10 < *pbVar11;
    bVar13 = *pbVar10 == *pbVar11;
    pbVar10 = pbVar10 + (ulong)bVar14 * -2 + 1;
    pbVar11 = pbVar11 + (ulong)bVar14 * -2 + 1;
  } while (bVar13);
  if (((!bVar12 && !bVar13) != bVar12) &&
     ((*(int *)(param_2 + 0x101) != 0x61747375 || (iVar8 = 2, *(short *)(param_2 + 0x105) != 0x72)))
     ) {
    iVar8 = 1;
  }
  pcVar9 = "application/x-tar";
  if ((uVar2 & 0x410) == 0) {
    pcVar9 = "tar archive" + (long)(iVar8 + -1) * 0x20;
  }
  iVar8 = FUN_00114fd0(param_1,"%s",pcVar9);
  if (iVar8 != -1) {
    iVar8 = 1;
  }
  return iVar8;
LAB_0010fdc3:
  cVar3 = (char)uVar5;
  if (7 < (byte)(cVar3 - 0x30U)) goto LAB_0010fed8;
  pbVar10 = pbVar10 + 1;
  uVar6 = uVar6 << 3 | (int)cVar3 - 0x30U;
  if (pbVar11 == pbVar10) goto LAB_0010fde3;
  uVar5 = (ulong)*pbVar10;
  goto LAB_0010fdc3;
LAB_0010fed8:
  if ((cVar3 != '\0') && ((*(byte *)(*plVar4 + 1 + uVar5 * 2) & 0x20) == 0)) {
    uVar6 = 0xffffffff;
  }
  goto LAB_0010fde3;
}



uint FUN_0010ff10(uint param_1)

{
  long in_FS_OFFSET;
  
  if (*(long *)(in_FS_OFFSET + 0x28) == *(long *)(in_FS_OFFSET + 0x28)) {
    return param_1 >> 0x18 | (param_1 & 0xff0000) >> 8 | (param_1 & 0xff00) << 8 | param_1 << 0x18;
  }
                    // WARNING: Subroutine does not return
  __stack_chk_fail();
}



undefined8
FUN_0010ff50(undefined8 param_1,ulong param_2,int param_3,int param_4,uint param_5,uint param_6,
            ulong param_7,long param_8,uint *param_9,ulong param_10,int param_11)

{
  byte bVar1;
  long lVar2;
  int iVar3;
  undefined4 uVar4;
  long *plVar5;
  char *pcVar6;
  ulong uVar7;
  undefined8 uVar8;
  long lVar9;
  byte *pbVar10;
  byte *pbVar11;
  ulong uVar12;
  long in_FS_OFFSET;
  bool bVar13;
  bool bVar14;
  long local_270;
  long local_250;
  undefined local_248 [520];
  long local_40;
  
  local_40 = *(long *)(in_FS_OFFSET + 0x28);
  if (param_5 == 4) {
    bVar13 = CARRY8(param_7,param_2);
    bVar14 = (byte *)(param_7 + param_2) == (byte *)0x0;
    lVar9 = 4;
    pbVar11 = (byte *)(param_7 + param_2);
    pbVar10 = (byte *)0x11e080;
    do {
      if (lVar9 == 0) break;
      lVar9 = lVar9 + -1;
      bVar13 = *pbVar11 < *pbVar10;
      bVar14 = *pbVar11 == *pbVar10;
      pbVar11 = pbVar11 + 1;
      pbVar10 = pbVar10 + 1;
    } while (bVar14);
    iVar3 = -(uint)((!bVar13 && !bVar14) != bVar13);
    if ((!bVar13 && !bVar14) == bVar13) {
LAB_00110233:
      bVar1 = *(byte *)param_9;
joined_r0x00110238:
      if ((bVar1 & 8) == 0) {
        iVar3 = FUN_00114fd0(param_1,", %s-style",&DAT_0011e5d0 + (long)iVar3 * 8);
        if (iVar3 == -1) goto LAB_0011026a;
        *param_9 = *param_9 | 8;
      }
    }
LAB_00110038:
    if ((param_3 == 3) && ((*param_9 & 0x100) != 0)) {
      local_250 = 0;
      do {
        if (param_11 == 1) {
          local_270 = *(long *)(&DAT_0011e640 + local_250 * 8);
        }
        else {
          local_270 = *(long *)(&DAT_0011e600 + local_250 * 8);
        }
        lVar9 = 0;
LAB_001100a0:
        if (((ulong)(local_270 + param_8 + lVar9) < param_10) &&
           ((ulong)(local_270 + lVar9) < (ulong)param_6)) {
          bVar1 = *(byte *)(local_270 + param_8 + param_2 + lVar9);
          if (bVar1 == 0) {
            if (lVar9 != 0) goto LAB_00110115;
          }
          else {
            plVar5 = (long *)FUN_00104d70();
            if (((*(byte *)(*plVar5 + 1 + (ulong)bVar1 * 2) & 0x40) != 0) &&
               (pcVar6 = strchr("\'\"`",(uint)bVar1), pcVar6 == (char *)0x0)) goto code_r0x0011010b;
          }
        }
        local_250 = local_250 + 1;
      } while (local_250 != 5);
    }
LAB_0010ffe3:
    uVar8 = 0;
    goto LAB_0010ffe5;
  }
  if (param_5 == 5) {
    bVar13 = CARRY8(param_7,param_2);
    bVar14 = (byte *)(param_7 + param_2) == (byte *)0x0;
    lVar9 = 5;
    pbVar11 = (byte *)(param_7 + param_2);
    pbVar10 = (byte *)0x11e080;
    do {
      if (lVar9 == 0) break;
      lVar9 = lVar9 + -1;
      bVar13 = *pbVar11 < *pbVar10;
      bVar14 = *pbVar11 == *pbVar10;
      pbVar11 = pbVar11 + 1;
      pbVar10 = pbVar10 + 1;
    } while (bVar14);
    iVar3 = (int)(char)((!bVar13 && !bVar14) - bVar13);
    if (iVar3 == 0) goto LAB_00110233;
    goto LAB_00110038;
  }
  if (param_5 == 8) {
    bVar13 = CARRY8(param_7,param_2);
    bVar14 = (byte *)(param_7 + param_2) == (byte *)0x0;
    lVar9 = 8;
    pbVar11 = (byte *)(param_7 + param_2);
    pbVar10 = (byte *)0x11e1cb;
    do {
      if (lVar9 == 0) break;
      lVar9 = lVar9 + -1;
      bVar13 = *pbVar11 < *pbVar10;
      bVar14 = *pbVar11 == *pbVar10;
      pbVar11 = pbVar11 + 1;
      pbVar10 = pbVar10 + 1;
    } while (bVar14);
    if ((!bVar13 && !bVar14) == bVar13) {
      iVar3 = 1;
      bVar1 = *(byte *)param_9;
      goto joined_r0x00110238;
    }
    goto LAB_00110038;
  }
  if (param_5 < 0xb) goto LAB_00110038;
  bVar13 = CARRY8(param_7,param_2);
  bVar14 = (byte *)(param_7 + param_2) == (byte *)0x0;
  lVar9 = 0xb;
  pbVar11 = (byte *)(param_7 + param_2);
  pbVar10 = (byte *)"NetBSD-CORE";
  do {
    if (lVar9 == 0) break;
    lVar9 = lVar9 + -1;
    bVar13 = *pbVar11 < *pbVar10;
    bVar14 = *pbVar11 == *pbVar10;
    pbVar11 = pbVar11 + 1;
    pbVar10 = pbVar10 + 1;
  } while (bVar14);
  if ((!bVar13 && !bVar14) != bVar13) goto LAB_00110038;
  if ((*(byte *)param_9 & 8) == 0) {
    iVar3 = FUN_00114fd0(param_1,", %s-style","NetBSD");
    if (iVar3 == -1) goto LAB_0011026a;
    *param_9 = *param_9 | 8;
  }
  if (param_3 != 1) goto LAB_0010ffe3;
  uVar8 = FUN_00115ef0(local_248,0x200,param_2 + 0x7c + param_8);
  iVar3 = FUN_00114fd0(param_1,", from \'%.31s\'",uVar8);
  if (iVar3 != -1) {
    uVar4 = *(undefined4 *)(param_2 + 8 + param_8);
    if (param_4 != 0) {
      uVar4 = FUN_0010ff10(uVar4);
    }
    iVar3 = FUN_00114fd0(param_1," (signal %u)",uVar4);
    if (iVar3 == -1) goto LAB_0011026a;
    goto LAB_001101fc;
  }
  goto LAB_0011026a;
code_r0x0011010b:
  lVar9 = lVar9 + 1;
  if (lVar9 == 0x10) {
LAB_00110115:
    lVar9 = local_250 + 1;
    if (local_250 != 4) goto LAB_00110140;
    local_250 = 4;
    goto LAB_0011016e;
  }
  goto LAB_001100a0;
LAB_00110140:
  do {
    if (param_11 == 1) {
      uVar12 = *(ulong *)(&DAT_0011e640 + lVar9 * 8);
      uVar7 = *(ulong *)(&DAT_0011e640 + local_250 * 8);
    }
    else {
      uVar12 = *(ulong *)(&DAT_0011e600 + lVar9 * 8);
      uVar7 = *(ulong *)(&DAT_0011e600 + local_250 * 8);
    }
    lVar2 = local_250;
    if (uVar12 < uVar7) {
      uVar12 = uVar12 + param_8;
      lVar2 = lVar9;
      if (uVar12 < uVar7 + param_8) {
        plVar5 = (long *)FUN_00104d70();
        do {
          lVar2 = local_250;
          if ((*(byte *)(*plVar5 + 1 + (ulong)*(byte *)(param_2 + uVar12) * 2) & 0x40) == 0) break;
          uVar12 = uVar12 + 1;
          lVar2 = lVar9;
        } while (uVar12 < uVar7 + param_8);
      }
    }
    local_250 = lVar2;
    lVar9 = lVar9 + 1;
  } while (lVar9 != 5);
LAB_0011016e:
  if (param_11 == 1) {
    lVar9 = *(long *)(&DAT_0011e640 + local_250 * 8);
  }
  else {
    lVar9 = *(long *)(&DAT_0011e600 + local_250 * 8);
  }
  pbVar11 = (byte *)(lVar9 + param_8 + param_2);
  bVar1 = *pbVar11;
  if (bVar1 == 0) {
LAB_00110448:
    iVar3 = 0;
  }
  else {
    plVar5 = (long *)FUN_00104d70();
    pbVar10 = pbVar11;
    do {
      if ((*(byte *)(*plVar5 + 1 + (ulong)bVar1 * 2) & 0x40) == 0) break;
      bVar1 = pbVar10[1];
      pbVar10 = pbVar10 + 1;
    } while (bVar1 != 0);
    if (pbVar11 < pbVar10) {
      do {
        if ((*(byte *)(*plVar5 + 1 + (ulong)pbVar10[-1] * 2) & 0x20) == 0) goto LAB_001101e0;
        pbVar10 = pbVar10 + -1;
      } while (pbVar11 != pbVar10);
      goto LAB_00110448;
    }
LAB_001101e0:
    iVar3 = (int)pbVar10 - (int)pbVar11;
  }
  iVar3 = FUN_00114fd0(param_1,", from \'%.*s\'",pbVar11);
  if (iVar3 != -1) {
LAB_001101fc:
    *param_9 = *param_9 | 1;
  }
LAB_0011026a:
  uVar8 = 1;
LAB_0010ffe5:
  if (local_40 == *(long *)(in_FS_OFFSET + 0x28)) {
    return uVar8;
  }
                    // WARNING: Subroutine does not return
  __stack_chk_fail();
}



ulong FUN_00110480(ulong param_1)

{
  long in_FS_OFFSET;
  
  if (*(long *)(in_FS_OFFSET + 0x28) == *(long *)(in_FS_OFFSET + 0x28)) {
    return param_1 >> 0x38 | (param_1 & 0xff000000000000) >> 0x28 |
           (param_1 & 0xff0000000000) >> 0x18 | (param_1 & 0xff00000000) >> 8 |
           (param_1 & 0xff000000) << 8 | (param_1 & 0xff0000) << 0x18 | (param_1 & 0xff00) << 0x28 |
           param_1 << 0x38;
  }
                    // WARNING: Subroutine does not return
  __stack_chk_fail();
}



undefined8
FUN_001104c0(undefined8 param_1,long param_2,int param_3,int param_4,ulong param_5,long param_6,
            uint *param_7,int param_8,int param_9,long param_10,int param_11,long param_12)

{
  long lVar1;
  ulong uVar2;
  byte *__buf;
  byte bVar3;
  uint uVar4;
  uint uVar5;
  undefined4 uVar6;
  int iVar7;
  uint uVar8;
  undefined8 uVar9;
  ulong uVar10;
  ulong uVar11;
  ulong uVar12;
  ssize_t sVar13;
  long *plVar14;
  byte *pbVar15;
  long lVar16;
  __off_t __offset;
  long lVar17;
  long __offset_00;
  char *pcVar18;
  long in_FS_OFFSET;
  long local_218;
  char *local_1d8;
  undefined4 local_1c0;
  uint uStack_1bc;
  undefined8 local_1b8;
  ulong local_1b0;
  undefined local_1a8 [4];
  uint local_1a4;
  uint local_1a0;
  uint local_198;
  undefined local_188 [8];
  ulong local_180;
  ulong local_178;
  ulong local_168;
  byte abStack_149 [265];
  long local_40;
  
  local_40 = *(long *)(in_FS_OFFSET + 0x28);
  if ((param_3 == 6) && ((*param_7 & 0x100) != 0)) {
    local_218 = 0;
    *param_7 = *param_7 | 0x200;
    lVar1 = (ulong)(param_8 != 1) * 8;
    uVar2 = lVar1 + 8;
    uVar4 = (uint)uVar2;
    lVar17 = param_2 + param_6;
    uVar10 = uVar2;
    while (uVar10 <= (param_5 & 0xffffffff)) {
      if (param_8 == 1) {
        *(undefined8 *)(&local_1c0 + (ulong)(param_8 != 1) * 2) = *(undefined8 *)(lVar1 + lVar17);
        if (7 < uVar4 - 1) {
          uVar5 = 0;
          do {
            uVar10 = (ulong)uVar5;
            uVar5 = uVar5 + 8;
            *(undefined8 *)((long)&local_1c0 + uVar10) = *(undefined8 *)(lVar17 + uVar10);
          } while (uVar5 < uVar4 - 8);
        }
        if (local_218 == 0x32) goto LAB_00110c10;
        if (param_4 != 0) {
          uVar6 = FUN_0010ff10(uVar6);
          if (false) goto switchD_001105ef_caseD_10;
          switch(uVar6) {
          case 0xb:
            goto switchD_001105ef_caseD_b;
          case 0xc:
            goto switchD_001105ef_caseD_c;
          case 0xd:
            goto switchD_001105ef_caseD_d;
          case 0xe:
            uVar10 = (ulong)uStack_1bc;
            pcVar18 = "effective gid";
            break;
          case 0xf:
            goto switchD_001105ef_caseD_f;
          default:
            goto switchD_001105ef_caseD_10;
          case 0x1f:
            goto switchD_001105ef_caseD_1f;
          }
          goto LAB_00110876;
        }
        if (true) {
          switch(local_1c0) {
          case 0xb:
            goto switchD_001105ef_caseD_b;
          case 0xc:
            goto switchD_001105ef_caseD_c;
          case 0xd:
            goto switchD_001105ef_caseD_d;
          case 0xe:
            uVar10 = (ulong)uStack_1bc;
            pcVar18 = "effective gid";
            goto LAB_0011061b;
          case 0xf:
            goto switchD_001105ef_caseD_f;
          case 0x1f:
            goto switchD_001105ef_caseD_1f;
          }
        }
        goto switchD_001105ef_caseD_10;
      }
      uVar10 = 0;
      do {
        uVar5 = (int)uVar10 + 8;
        uVar11 = (ulong)uVar5;
        *(undefined8 *)((long)&local_1b8 + uVar10) = *(undefined8 *)(lVar17 + uVar10);
        uVar10 = uVar11;
      } while (uVar5 < uVar4);
      if (false) {
        *(undefined *)((long)&local_1b8 + uVar11) = *(undefined *)(uVar11 + lVar17);
      }
      if (local_218 == 0x32) {
LAB_00110c10:
        FUN_00114dc0(param_1,0,"Too many ELF Auxv elements");
        break;
      }
      if (param_4 == 0) {
        if (false) goto switchD_001105ef_caseD_10;
        switch(local_1b8) {
        case 0xb:
          goto switchD_001105ef_caseD_b;
        case 0xc:
          goto switchD_001105ef_caseD_c;
        case 0xd:
          goto switchD_001105ef_caseD_d;
        case 0xe:
          pcVar18 = "effective gid";
          uVar10 = local_1b0;
          break;
        case 0xf:
          goto switchD_001105ef_caseD_f;
        default:
          goto switchD_001105ef_caseD_10;
        case 0x1f:
          goto switchD_001105ef_caseD_1f;
        }
        goto LAB_0011061b;
      }
      uVar9 = FUN_00110480(uVar9);
      if (false) goto switchD_001105ef_caseD_10;
      switch(uVar9) {
      case 0xb:
switchD_001105ef_caseD_b:
        pcVar18 = "real uid";
        break;
      case 0xc:
switchD_001105ef_caseD_c:
        pcVar18 = "effective uid";
        break;
      case 0xd:
switchD_001105ef_caseD_d:
        pcVar18 = "real gid";
        break;
      case 0xe:
        pcVar18 = "effective gid";
        goto LAB_00110613;
      case 0xf:
switchD_001105ef_caseD_f:
        local_1d8 = "platform";
        if (param_8 == 1) goto LAB_0011083e;
LAB_001106c6:
        uVar10 = local_1b0;
        if (param_4 != 0) {
          uVar10 = FUN_00110480(local_1b0);
        }
        goto LAB_001106db;
      default:
        goto switchD_001105ef_caseD_10;
      case 0x1f:
switchD_001105ef_caseD_1f:
        local_1d8 = "execfn";
        if (param_8 != 1) goto LAB_001106c6;
LAB_0011083e:
        uVar5 = uStack_1bc;
        if (param_4 != 0) {
          uVar5 = FUN_0010ff10(uVar5);
        }
        uVar10 = (ulong)uVar5;
LAB_001106db:
        __offset_00 = param_10;
        iVar7 = param_11;
        if (param_11 != 0) {
          do {
            if (param_8 == 1) {
              sVar13 = pread(param_9,local_1a8,0x20,__offset_00);
              lVar16 = 0x20;
              if (sVar13 < 0x20) {
LAB_00110809:
                FUN_00115270(param_1);
                __offset = -1;
                goto LAB_00110aa7;
              }
            }
            else {
              sVar13 = pread(param_9,local_188,0x38,__offset_00);
              lVar16 = 0x38;
              if (sVar13 < 0x38) goto LAB_00110809;
            }
            if (param_12 == -1) {
              if (param_8 == 1) {
                if (local_1a0 == 0) goto LAB_001109a3;
LAB_001108b1:
                if (param_4 == 0) {
                  if (local_1a0 <= uVar10) {
                    uVar11 = (ulong)local_198;
                    uVar12 = (ulong)local_1a0;
                    goto LAB_001107bd;
                  }
                }
                else {
                  uVar5 = FUN_0010ff10(uVar5);
                  uVar12 = (ulong)uVar5;
                  if (uVar12 <= uVar10) {
                    uVar11 = (ulong)local_198;
                    goto LAB_001108d2;
                  }
                }
              }
              else {
LAB_00110779:
                uVar11 = local_168;
                if (local_178 == 0) {
                  if (3 < uVar10) {
                    if (param_4 != 0) {
                      uVar12 = 4;
                      goto LAB_001107ab;
                    }
LAB_001109e0:
                    uVar12 = 4;
                    goto LAB_001107bd;
                  }
                }
                else if (param_4 == 0) {
                  uVar12 = local_178;
                  if (local_178 <= uVar10) goto LAB_001107bd;
                }
                else {
                  uVar12 = FUN_00110480(local_178);
                  if (uVar12 <= uVar10) {
LAB_001107ab:
                    uVar11 = FUN_00110480(local_168);
LAB_001107bd:
                    if (uVar10 < uVar11 + uVar12) goto LAB_001108f0;
                  }
                }
              }
            }
            else if (param_8 == 1) {
              uVar5 = local_1a4;
              if (param_4 != 0) {
                uVar5 = FUN_0010ff10(uVar5);
              }
              if ((long)(ulong)uVar5 <= param_12) {
                if (local_1a0 != 0) goto LAB_001108b1;
LAB_001109a3:
                if (3 < uVar10) {
                  uVar11 = (ulong)local_198;
                  if (param_4 == 0) goto LAB_001109e0;
                  uVar12 = 4;
LAB_001108d2:
                  uVar5 = FUN_0010ff10(uVar11);
                  if (uVar5 + uVar12 <= uVar10) goto LAB_001107c9;
LAB_001108f0:
                  uVar11 = local_178;
                  uVar5 = local_1a0;
                  if (param_8 == 1) {
                    uVar11 = (ulong)local_1a0;
                    if (param_4 == 0) {
                      uVar12 = (ulong)local_1a4;
                      if (local_1a0 == 0) goto LAB_00110bfc;
                    }
                    else {
                      uVar8 = FUN_0010ff10(uVar8);
                      uVar12 = (ulong)uVar8;
                      if (uVar5 == 0) {
LAB_00110bfc:
                        uVar11 = 4;
                      }
                      else {
                        uVar5 = FUN_0010ff10(uVar5);
                        uVar11 = (ulong)uVar5;
                      }
                    }
                  }
                  else if (param_4 == 0) {
                    uVar12 = local_180;
                    if (local_178 == 0) {
                      uVar11 = 4;
                    }
                  }
                  else {
                    uVar12 = FUN_00110480(local_180);
                    if (uVar11 == 0) goto LAB_00110bfc;
                    uVar11 = FUN_00110480(uVar11);
                  }
                  __offset = (uVar10 + uVar12) - uVar11;
                  goto LAB_00110aa7;
                }
              }
            }
            else {
              uVar11 = local_180;
              if (param_4 != 0) {
                uVar11 = FUN_00110480(uVar11);
              }
              if ((long)uVar11 <= param_12) goto LAB_00110779;
            }
LAB_001107c9:
            iVar7 = iVar7 + -1;
            __offset_00 = __offset_00 + lVar16;
          } while (iVar7 != 0);
        }
        __offset = 0;
LAB_00110aa7:
        __buf = abStack_149 + 1;
        sVar13 = pread(param_9,__buf,0x100,__offset);
        if (0 < sVar13) {
          abStack_149[sVar13] = 0;
          bVar3 = abStack_149[1];
          if (abStack_149[1] == 0) goto switchD_001105ef_caseD_10;
          plVar14 = (long *)FUN_00104d70();
          pbVar15 = __buf;
          do {
            if ((*(byte *)(*plVar14 + 1 + (ulong)bVar3 * 2) & 0x40) == 0)
            goto switchD_001105ef_caseD_10;
            bVar3 = pbVar15[1];
            pbVar15 = pbVar15 + 1;
          } while (bVar3 != 0);
          if (pbVar15 == __buf) goto switchD_001105ef_caseD_10;
          iVar7 = FUN_00114fd0(param_1,", %s: \'%s\'",__buf);
          goto joined_r0x00110b2b;
        }
        FUN_00115270(param_1);
        goto switchD_001105ef_caseD_10;
      }
      if (param_8 == 1) {
        uVar10 = (ulong)uStack_1bc;
        if (param_4 != 0) {
LAB_00110876:
          uVar5 = FUN_0010ff10(uVar10);
          uVar10 = (ulong)uVar5;
        }
      }
      else {
        uVar10 = local_1b0;
        if (param_4 != 0) {
LAB_00110613:
          uVar10 = FUN_00110480(local_1b0);
        }
      }
LAB_0011061b:
      iVar7 = FUN_00114fd0(param_1,", %s: %d",uVar10 & 0xffffffff);
joined_r0x00110b2b:
      if (iVar7 == -1) goto LAB_00110640;
switchD_001105ef_caseD_10:
      local_218 = local_218 + 1;
      lVar17 = lVar17 + uVar2;
      uVar10 = (uVar2 - (param_2 + param_6)) + lVar17;
    }
    uVar9 = 1;
  }
  else {
LAB_00110640:
    uVar9 = 0;
  }
  if (local_40 == *(long *)(in_FS_OFFSET + 0x28)) {
    return uVar9;
  }
                    // WARNING: Subroutine does not return
  __stack_chk_fail();
}



ulong FUN_00110c50(undefined8 param_1,long param_2,long param_3,ulong param_4,int param_5,
                  int param_6,ulong param_7,uint *param_8,short *param_9,undefined4 param_10,
                  undefined8 param_11,undefined4 param_12,undefined8 param_13)

{
  uint uVar1;
  int iVar2;
  uint uVar3;
  int iVar4;
  uint uVar5;
  undefined4 uVar6;
  ulong uVar7;
  ulong uVar8;
  long lVar9;
  uint *puVar10;
  undefined1 *puVar11;
  char *pcVar12;
  uint uVar13;
  ulong uVar14;
  byte *pbVar15;
  ulong uVar16;
  byte *pbVar17;
  ulong uVar18;
  long in_FS_OFFSET;
  bool bVar19;
  bool bVar20;
  bool bVar21;
  byte bVar22;
  uint local_84;
  uint local_68;
  undefined8 local_58;
  undefined8 uStack_50;
  long local_40;
  
  bVar22 = 0;
  local_40 = *(long *)(in_FS_OFFSET + 0x28);
  uVar8 = 0;
  if (*param_9 == 0) goto LAB_00110ea8;
  uVar14 = param_3 + 0xc;
  *param_9 = *param_9 + -1;
  uVar8 = uVar14;
  if (param_4 < uVar14) goto LAB_00110ea8;
  puVar10 = (uint *)(param_3 + param_2);
  local_84 = puVar10[2];
  uVar3 = *puVar10;
  uVar13 = puVar10[1];
  uVar8 = param_4;
  if (param_5 == 1) {
    local_68 = local_84;
    if (param_6 != 0) {
      uVar3 = FUN_0010ff10(uVar3);
      uVar13 = FUN_0010ff10(uVar13);
    }
LAB_00110cd8:
    if (uVar13 == 0 && uVar3 == 0) goto LAB_00110ea8;
  }
  else {
    if (param_6 == 0) goto LAB_00110cd8;
    uVar3 = FUN_0010ff10(uVar3);
    uVar13 = FUN_0010ff10(uVar13);
    if (uVar13 == 0 && uVar3 == 0) goto LAB_00110ea8;
  }
  if ((int)uVar3 < 0) {
    FUN_00114fd0(param_1,", bad note name size 0x%lx",uVar3);
    uVar8 = 0;
    goto LAB_00110ea8;
  }
  if ((int)uVar13 < 0) {
    FUN_00114fd0(param_1,", bad note description size 0x%lx",uVar13);
    uVar8 = 0;
    goto LAB_00110ea8;
  }
  uVar7 = ((uVar3 + uVar14 + (param_7 - 1)) / param_7) * param_7;
  uVar8 = uVar7;
  if (param_4 < uVar3 + uVar14) goto LAB_00110ea8;
  uVar16 = (ulong)uVar13;
  uVar8 = ((uVar16 + uVar7 + (param_7 - 1)) / param_7) * param_7;
  if (param_4 < uVar16 + uVar7) {
    if (uVar8 <= param_4) {
      uVar8 = param_4;
    }
    goto LAB_00110ea8;
  }
  uVar5 = *param_8;
  if ((uVar5 & 2) == 0) {
    if (param_5 == 1) {
      uVar1 = local_68;
      if (param_6 != 0) {
        uVar1 = FUN_0010ff10(uVar1);
      }
    }
    else {
      uVar1 = local_84;
      if (param_6 != 0) {
        uVar1 = FUN_0010ff10(uVar1);
      }
    }
    bVar19 = uVar3 < 5;
    bVar21 = uVar3 == 5;
    if (bVar21) {
      lVar9 = 5;
      pbVar15 = (byte *)(param_2 + uVar14);
      pbVar17 = &DAT_0011e152;
      do {
        if (lVar9 == 0) break;
        lVar9 = lVar9 + -1;
        bVar19 = *pbVar15 < *pbVar17;
        bVar21 = *pbVar15 == *pbVar17;
        pbVar15 = pbVar15 + (ulong)bVar22 * -2 + 1;
        pbVar17 = pbVar17 + (ulong)bVar22 * -2 + 1;
      } while (bVar21);
      if ((((!bVar19 && !bVar21) == bVar19) && (uVar1 == 1)) && (uVar13 == 2)) {
        *param_8 = uVar5 | 2;
        FUN_00114fd0(param_1,", for SuSE %d.%d",*(undefined *)(param_2 + uVar7),
                     *(undefined *)(param_2 + 1 + uVar7));
        goto LAB_00110ea8;
      }
    }
    else {
      bVar19 = uVar3 < 4;
      bVar21 = uVar3 == 4;
      if (bVar21) {
        lVar9 = 4;
        pbVar15 = (byte *)(param_2 + uVar14);
        pbVar17 = &DAT_0011e168;
        do {
          if (lVar9 == 0) break;
          lVar9 = lVar9 + -1;
          bVar19 = *pbVar15 < *pbVar17;
          bVar21 = *pbVar15 == *pbVar17;
          pbVar15 = pbVar15 + (ulong)bVar22 * -2 + 1;
          pbVar17 = pbVar17 + (ulong)bVar22 * -2 + 1;
        } while (bVar21);
        if ((((!bVar19 && !bVar21) == bVar19) && (uVar1 == 1)) && (uVar13 == 0x10)) {
          uVar14 = *(ulong *)(param_2 + uVar7);
          uVar7 = *(ulong *)(param_2 + 8 + uVar7);
          *param_8 = uVar5 | 2;
          iVar2 = FUN_00114fd0(param_1,", for GNU/", "");
          if (iVar2 != -1) {
            uVar6 = (undefined4)uVar14;
            if (param_6 != 0) {
              uVar6 = FUN_0010ff10(uVar14 & 0xffffffff);
            }
            switch(uVar6) {
            case 0:
              pcVar12 = "Linux";
              break;
            case 1:
              pcVar12 = "Hurd";
              break;
            case 2:
              pcVar12 = "Solaris";
              break;
            case 3:
              pcVar12 = "kFreeBSD";
              break;
            case 4:
              pcVar12 = "kNetBSD";
              break;
            default:
              pcVar12 = "<unknown>";
            }
            iVar2 = FUN_00114fd0(param_1,pcVar12, "");
            if (iVar2 != -1) {
              uVar14 = uVar14 >> 0x20;
              uVar18 = uVar7 & 0xffffffff;
              uVar16 = uVar7 >> 0x20;
              if (param_6 != 0) {
                uVar3 = FUN_0010ff10(uVar3);
                uVar16 = (ulong)uVar3;
                uVar3 = FUN_0010ff10(uVar7 & 0xffffffff);
                uVar18 = (ulong)uVar3;
                uVar3 = FUN_0010ff10(uVar14);
                uVar14 = (ulong)uVar3;
              }
              FUN_00114fd0(param_1," %d.%d.%d",uVar16);
            }
          }
          goto LAB_00110ea8;
        }
      }
      else {
        bVar19 = uVar3 < 7;
        bVar21 = uVar3 == 7;
        if (bVar21) {
          lVar9 = 7;
          pbVar15 = (byte *)(param_2 + uVar14);
          pbVar17 = (byte *)0x11e1b5;
          do {
            if (lVar9 == 0) break;
            lVar9 = lVar9 + -1;
            bVar19 = *pbVar15 < *pbVar17;
            bVar21 = *pbVar15 == *pbVar17;
            pbVar15 = pbVar15 + (ulong)bVar22 * -2 + 1;
            pbVar17 = pbVar17 + (ulong)bVar22 * -2 + 1;
          } while (bVar21);
          if ((((!bVar19 && !bVar21) == bVar19) && (uVar1 == 1)) && (uVar13 == 4)) {
            *param_8 = uVar5 | 2;
            uVar3 = *(uint *)(param_2 + uVar7);
            if (param_6 != 0) {
              uVar3 = FUN_0010ff10(uVar3);
            }
            iVar2 = FUN_00114fd0(param_1,", for NetBSD", "");
            if ((iVar2 != -1) && (100000000 < uVar3)) {
              uVar14 = ((ulong)uVar3 / 100) % 100;
              uVar7 = ((ulong)uVar3 / 10000) % 100;
              uVar13 = (uint)uVar7;
              iVar2 = FUN_00114fd0(param_1,&DAT_0011e1bc,(ulong)uVar3 / 100000000,
                                   ((ulong)uVar3 / 1000000) % 100);
              if (iVar2 != -1) {
                if ((uVar13 == 0) && ((int)uVar14 != 0)) {
                  FUN_00114fd0(param_1,&DAT_0011e1bf,uVar14);
                }
                else if (uVar13 != 0) {
                  while (0x1a < uVar13) {
                    iVar2 = FUN_00114fd0(param_1,"", &DAT_0011e1c3);
                    if (iVar2 == -1) goto LAB_00110ea8;
                    uVar13 = (int)uVar7 - 0x1a;
                    uVar7 = (ulong)uVar13;
                  }
                  FUN_00114fd0(param_1,&DAT_0011e8a9,uVar13 + 0x40);
                }
              }
            }
            goto LAB_00110ea8;
          }
        }
        else {
          bVar19 = uVar3 < 8;
          bVar21 = uVar3 == 8;
          if (bVar21) {
            lVar9 = 8;
            pbVar15 = (byte *)(param_2 + uVar14);
            pbVar17 = (byte *)0x11e1cb;
            do {
              if (lVar9 == 0) break;
              lVar9 = lVar9 + -1;
              bVar19 = *pbVar15 < *pbVar17;
              bVar21 = *pbVar15 == *pbVar17;
              pbVar15 = pbVar15 + (ulong)bVar22 * -2 + 1;
              pbVar17 = pbVar17 + (ulong)bVar22 * -2 + 1;
            } while (bVar21);
            bVar20 = false;
            bVar19 = (!bVar19 && !bVar21) == bVar19;
            if (bVar19) {
              if ((uVar1 == 1) && (uVar13 == 4)) {
                *param_8 = uVar5 | 2;
                uVar3 = *(uint *)(param_2 + uVar7);
                if (param_6 != 0) {
                  uVar3 = FUN_0010ff10(uVar3);
                }
                iVar2 = FUN_00114fd0(param_1,", for FreeBSD", "");
                if (iVar2 == -1) goto LAB_00110ea8;
                if (uVar3 == 0x704e2) {
                  FUN_00114fd0(param_1," 4.6.2", "");
                  goto LAB_00110ea8;
                }
                if (uVar3 < 0x70544) {
                  iVar2 = FUN_00114fd0(param_1," %d.%d",(ulong)uVar3 / 100000,
                                       ((ulong)uVar3 / 10000) % 10);
                  if (((iVar2 == -1) ||
                      (((int)(((ulong)uVar3 / 1000) % 10) != 0 &&
                       (iVar2 = FUN_00114fd0(param_1,".%d", ""), iVar2 == -1)))) ||
                     ((uVar3 % 1000 == 0 && (uVar3 % 100000 != 0)))) goto LAB_00110ea8;
LAB_00111be0:
                  FUN_00114fd0(param_1," (%d)",uVar3);
                }
                else {
                  if (uVar3 < 500000) {
                    iVar2 = FUN_00114fd0(param_1," %d.%d",4,
                                         (int)(((ulong)uVar3 / 1000) % 10) +
                                         (int)(((ulong)uVar3 / 10000) % 10));
                    if (iVar2 == -1) goto LAB_00110ea8;
                    if ((int)(((ulong)uVar3 / 100) % 10) != 0) {
                      FUN_00114fd0(param_1," (%d)",uVar3);
                      goto LAB_00110ea8;
                    }
                    iVar2 = (int)(((ulong)uVar3 / 10) % 10);
                  }
                  else {
                    iVar2 = FUN_00114fd0(param_1," %d.%d",(ulong)uVar3 / 100000);
                    if (iVar2 == -1) goto LAB_00110ea8;
                    if (((int)(((ulong)uVar3 / 100) % 10) != 0) || (uVar3 % 100000 < 100))
                    goto LAB_00111be0;
                    iVar2 = (int)(((ulong)uVar3 / 10) % 10);
                  }
                  if (iVar2 != 0) {
                    FUN_00114fd0(param_1,".%d", "");
                  }
                }
                goto LAB_00110ea8;
              }
            }
            else {
              lVar9 = 8;
              pbVar15 = (byte *)(param_2 + uVar14);
              pbVar17 = (byte *)0x11e1e6;
              do {
                if (lVar9 == 0) break;
                lVar9 = lVar9 + -1;
                bVar20 = *pbVar15 < *pbVar17;
                bVar19 = *pbVar15 == *pbVar17;
                pbVar15 = pbVar15 + (ulong)bVar22 * -2 + 1;
                pbVar17 = pbVar17 + (ulong)bVar22 * -2 + 1;
              } while (bVar19);
              if ((((!bVar20 && !bVar19) == bVar20) && (uVar1 == 1)) && (uVar13 == 4)) {
                *param_8 = uVar5 | 2;
                FUN_00114fd0(param_1,", for OpenBSD", "");
                goto LAB_00110ea8;
              }
            }
          }
          else {
            bVar19 = uVar3 < 10;
            bVar21 = uVar3 == 10;
            if (bVar21) {
              lVar9 = 10;
              pbVar15 = (byte *)(param_2 + uVar14);
              pbVar17 = (byte *)0x11e1f4;
              do {
                if (lVar9 == 0) break;
                lVar9 = lVar9 + -1;
                bVar19 = *pbVar15 < *pbVar17;
                bVar21 = *pbVar15 == *pbVar17;
                pbVar15 = pbVar15 + (ulong)bVar22 * -2 + 1;
                pbVar17 = pbVar17 + (ulong)bVar22 * -2 + 1;
              } while (bVar21);
              if ((((!bVar19 && !bVar21) == bVar19) && (uVar1 == 1)) && (uVar13 == 4)) {
                *param_8 = uVar5 | 2;
                iVar2 = FUN_00114fd0(param_1,", for DragonFly", "");
                if (iVar2 != -1) {
                  uVar3 = *(uint *)(param_2 + uVar7);
                  if (param_6 != 0) {
                    uVar3 = FUN_0010ff10(uVar3);
                  }
                  FUN_00114fd0(param_1," %d.%d.%d",(ulong)(uVar3 >> 5) / 0xc35);
                }
                goto LAB_00110ea8;
              }
            }
          }
        }
      }
    }
  }
  if ((uVar5 & 4) == 0) {
    if (param_5 == 1) {
      uVar1 = local_68;
      if (param_6 != 0) {
        uVar1 = FUN_0010ff10(uVar1);
      }
    }
    else {
      uVar1 = local_84;
      if (param_6 != 0) {
        uVar1 = FUN_0010ff10(uVar1);
      }
    }
    bVar19 = uVar3 < 4;
    bVar21 = uVar3 == 4;
    if (bVar21) {
      lVar9 = 4;
      pbVar15 = (byte *)(param_2 + uVar14);
      pbVar17 = &DAT_0011e168;
      do {
        if (lVar9 == 0) break;
        lVar9 = lVar9 + -1;
        bVar19 = *pbVar15 < *pbVar17;
        bVar21 = *pbVar15 == *pbVar17;
        pbVar15 = pbVar15 + (ulong)bVar22 * -2 + 1;
        pbVar17 = pbVar17 + (ulong)bVar22 * -2 + 1;
      } while (bVar21);
      if (((!bVar19 && !bVar21) == bVar19) && (uVar1 == 3)) {
        *param_8 = uVar5 | 4;
        if (uVar13 == 0x10) {
          iVar2 = FUN_00114fd0(param_1,", BuildID[%s]=","md5/uuid");
          if (iVar2 == -1) goto LAB_00110ea8;
          local_58 = *(undefined8 *)(param_2 + uVar7);
          uStack_50 = ((undefined8 *)(param_2 + uVar7))[1];
        }
        else {
          if (uVar13 == 0x14) {
            pcVar12 = "sha1";
          }
          else {
            if (uVar13 != 8) {
              iVar2 = FUN_00114fd0(param_1,", BuildID[%s]=","unknown");
              if ((iVar2 == -1) ||
                 (__memcpy_chk(&local_58,uVar7 + param_2,uVar16,0x14), uVar13 == 0))
              goto LAB_00110ea8;
              goto LAB_00111028;
            }
            pcVar12 = "xxHash";
          }
          iVar2 = FUN_00114fd0(param_1,", BuildID[%s]=",pcVar12);
          if (iVar2 == -1) goto LAB_00110ea8;
          __memcpy_chk(&local_58,uVar7 + param_2,uVar16,0x14);
        }
LAB_00111028:
        lVar9 = 0;
        do {
          iVar2 = FUN_00114fd0(param_1,&DAT_0011e20d,*(undefined *)((long)&local_58 + lVar9));
          if (iVar2 == -1) break;
          lVar9 = lVar9 + 1;
        } while ((uint)lVar9 < uVar13);
        goto LAB_00110ea8;
      }
    }
  }
  if ((uVar5 & 0x10) == 0) {
    if (param_5 == 1) {
      uVar1 = local_68;
      if (param_6 != 0) {
        uVar1 = FUN_0010ff10(uVar1);
      }
    }
    else {
      uVar1 = local_84;
      if (param_6 != 0) {
        uVar1 = FUN_0010ff10(uVar1);
      }
    }
    bVar19 = uVar3 < 4;
    bVar21 = uVar3 == 4;
    if (bVar21) {
      lVar9 = 4;
      pbVar15 = (byte *)(param_2 + uVar14);
      pbVar17 = &DAT_0011e212;
      do {
        if (lVar9 == 0) break;
        lVar9 = lVar9 + -1;
        bVar19 = *pbVar15 < *pbVar17;
        bVar21 = *pbVar15 == *pbVar17;
        pbVar15 = pbVar15 + (ulong)bVar22 * -2 + 1;
        pbVar17 = pbVar17 + (ulong)bVar22 * -2 + 1;
      } while (bVar21);
      if ((((!bVar19 && !bVar21) == bVar19) && (uVar1 == 3)) && (uVar13 == 4)) {
        *param_8 = uVar5 | 0x10;
        uVar3 = *(uint *)(param_2 + uVar7);
        if (param_6 != 0) {
          uVar3 = FUN_0010ff10(uVar3);
        }
        if ((uVar3 == 0) || (iVar2 = FUN_00114fd0(param_1,", PaX: ", ""), iVar2 != -1)) {
          lVar9 = 0;
          iVar2 = 0;
          do {
            if ((1 << ((byte)lVar9 & 0x1f) & uVar3) != 0) {
              bVar19 = iVar2 != 0;
              iVar2 = iVar2 + 1;
              puVar11 = &DAT_0011ddf7;
              if (bVar19) {
                puVar11 = &DAT_0011e895;
              }
              iVar4 = FUN_00114fd0(param_1,&DAT_0011e898,puVar11)
              ;
              if (iVar4 == -1) break;
            }
            lVar9 = lVar9 + 1;
          } while (lVar9 != 6);
        }
        goto LAB_00110ea8;
      }
    }
  }
  if ((uVar5 & 1) == 0) {
    if (param_5 == 1) {
      uVar5 = local_68;
      if (param_6 != 0) {
        uVar5 = FUN_0010ff10(uVar5);
      }
    }
    else {
      uVar5 = local_84;
      if (param_6 != 0) {
        uVar5 = FUN_0010ff10(uVar5);
      }
    }
    iVar2 = FUN_0010ff50(param_1,param_2,uVar5,param_6,uVar3,uVar13,uVar14,uVar7,param_8,param_4,
                         param_5);
    if (iVar2 != 0) goto LAB_00110ea8;
    uVar5 = *param_8;
  }
  if ((uVar5 & 0x200) == 0) {
    if (param_5 == 1) {
      uVar5 = local_68;
      if (param_6 != 0) {
        uVar5 = FUN_0010ff10(uVar5);
      }
    }
    else {
      uVar5 = local_84;
      if (param_6 != 0) {
        uVar5 = FUN_0010ff10(uVar5);
      }
    }
    iVar2 = FUN_001104c0(param_1,param_2,uVar5,param_6,uVar13,uVar7,param_8,param_5,param_10,
                         param_11,param_12,param_13);
    if (iVar2 != 0) goto LAB_00110ea8;
  }
  bVar19 = uVar3 < 7;
  bVar21 = uVar3 == 7;
  if (bVar21) {
    lVar9 = 7;
    pbVar15 = (byte *)(param_2 + uVar14);
    pbVar17 = (byte *)0x11e1b5;
    do {
      if (lVar9 == 0) break;
      lVar9 = lVar9 + -1;
      bVar19 = *pbVar15 < *pbVar17;
      bVar21 = *pbVar15 == *pbVar17;
      pbVar15 = pbVar15 + (ulong)bVar22 * -2 + 1;
      pbVar17 = pbVar17 + (ulong)bVar22 * -2 + 1;
    } while (bVar21);
    if ((!bVar19 && !bVar21) == bVar19) {
      uVar3 = 100;
      if (uVar13 < 0x65) {
        uVar3 = uVar13;
      }
      if (param_5 == 1) {
        local_84 = local_68;
        if (param_6 != 0) {
          local_84 = FUN_0010ff10(local_68);
        }
      }
      else if (param_6 != 0) {
        local_84 = FUN_0010ff10(local_84);
      }
      if (local_84 == 5) {
        if ((*param_8 & 0x20) == 0) {
          *param_8 = *param_8 | 0x20;
          FUN_00114fd0(param_1,", compiled for: %.*s",uVar3);
        }
      }
      else if (local_84 == 6) {
        if ((*param_8 & 0x40) == 0) {
          *param_8 = *param_8 | 0x40;
          FUN_00114fd0(param_1,", compiler model: %.*s",uVar7 + param_2);
        }
      }
      else if ((local_84 != 1) && ((*param_8 & 0x80) == 0)) {
        *param_8 = *param_8 | 0x80;
        FUN_00114fd0(param_1,", note=%u",local_84);
      }
    }
  }
LAB_00110ea8:
  if (local_40 != *(long *)(in_FS_OFFSET + 0x28)) {
                    // WARNING: Subroutine does not return
    __stack_chk_fail();
  }
  return uVar8;
}



int FUN_00111c70(undefined8 param_1,int param_2,int param_3,undefined4 param_4,long param_5,
                int param_6,long param_7,long param_8,undefined8 param_9,undefined8 param_10)

{
  int iVar1;
  uint uVar2;
  long lVar3;
  long lVar4;
  ulong uVar5;
  int *piVar6;
  ulong uVar7;
  long lVar8;
  long in_FS_OFFSET;
  long local_20d8;
  int local_20b4;
  int local_20a8;
  uint local_20a4;
  uint local_2098;
  int local_2088 [2];
  ulong local_2080;
  ulong local_2068;
  undefined local_2048 [8200];
  long local_40;
  
  local_40 = *(long *)(in_FS_OFFSET + 0x28);
  lVar3 = 0x38;
  lVar8 = 0x38;
  if (param_2 == 1) {
    lVar8 = 0x20;
  }
  if (lVar8 == param_7) {
    if (param_6 != 0) {
      if (param_2 == 1) {
        lVar3 = 0x20;
      }
      local_20d8 = param_5;
      local_20b4 = param_6;
      piVar6 = local_2088;
      if (param_2 == 1) {
        piVar6 = &local_20a8;
      }
LAB_00111d83:
      do {
        lVar4 = __pread_chk(param_4,piVar6,lVar8,local_20d8,0x38);
        if (lVar4 < lVar3) {
LAB_00112000:
          FUN_00115270(param_1);
          iVar1 = -1;
          goto LAB_00111e84;
        }
        local_20d8 = local_20d8 + param_7;
        if (param_8 != -1) {
          if (param_2 == 1) {
            if (param_3 == 0) {
              if ((long)(ulong)local_20a4 <= param_8) goto LAB_00111f5d;
            }
            else {
              uVar2 = FUN_0010ff10(uVar2);
              if ((long)(ulong)uVar2 <= param_8) goto LAB_00111ed6;
            }
          }
          else if (param_3 == 0) {
            if ((long)local_2080 <= param_8) goto LAB_00111dd8;
          }
          else {
            lVar4 = FUN_00110480(lVar4);
            if (lVar4 <= param_8) goto LAB_00111d6a;
          }
          goto LAB_00111d78;
        }
        if (param_2 == 1) {
          if (param_3 == 0) {
LAB_00111f5d:
            if (local_20a8 == 4) {
              uVar2 = local_2098;
              if (0x1fff < local_2098) {
                uVar7 = 0x2000;
                uVar5 = (ulong)local_20a4;
                goto LAB_00111dfa;
              }
LAB_00111ef4:
              uVar5 = (ulong)local_20a4;
              uVar7 = (ulong)uVar2;
              if (param_3 == 0) goto LAB_00111dfa;
LAB_00111f0f:
              uVar2 = FUN_0010ff10(uVar5);
              uVar5 = (ulong)uVar2;
              goto LAB_00111dfa;
            }
          }
          else {
LAB_00111ed6:
            iVar1 = FUN_0010ff10(local_20a8);
            if (iVar1 == 4) {
              uVar2 = FUN_0010ff10(local_2098);
              if (uVar2 < 0x2000) goto LAB_00111ef4;
              uVar5 = (ulong)local_20a4;
              uVar7 = 0x2000;
              goto LAB_00111f0f;
            }
          }
LAB_00111d78:
          local_20b4 = local_20b4 + -1;
          if (local_20b4 == 0) break;
          goto LAB_00111d83;
        }
        if (param_3 != 0) {
LAB_00111d6a:
          iVar1 = FUN_0010ff10(local_2088[0]);
          if (iVar1 == 4) {
            uVar7 = FUN_00110480(local_2068);
            if (0x1fff < uVar7) {
              uVar7 = 0x2000;
            }
            uVar5 = FUN_00110480(local_2080);
            goto LAB_00111dfa;
          }
          goto LAB_00111d78;
        }
LAB_00111dd8:
        if (local_2088[0] != 4) goto LAB_00111d78;
        uVar5 = local_2080;
        uVar7 = local_2068;
        if (0x1fff < local_2068) {
          uVar7 = 0x2000;
        }
LAB_00111dfa:
        uVar7 = __pread_chk(param_4,local_2048,uVar7,uVar5,0x2000);
        if (uVar7 == 0xffffffffffffffff) goto LAB_00112000;
        uVar5 = 0;
        do {
          if (uVar7 <= uVar5) break;
          uVar5 = FUN_00110c50(param_1,local_2048,uVar5,uVar7,param_2,param_3,4,param_9,param_10,
                               param_4,param_5,param_6,param_8);
        } while (uVar5 != 0);
        local_20b4 = local_20b4 + -1;
      } while (local_20b4 != 0);
    }
    iVar1 = 0;
  }
  else {
    iVar1 = FUN_00114fd0(param_1,", corrupted program header size", "");
    iVar1 = -(uint)(iVar1 == -1);
  }
LAB_00111e84:
  if (local_40 != *(long *)(in_FS_OFFSET + 0x28)) {
                    // WARNING: Subroutine does not return
    __stack_chk_fail();
  }
  return iVar1;
}



int FUN_00112020(undefined8 param_1,int param_2,int param_3,uint param_4,undefined8 param_5, int param_6)

{
  int *piVar1;
  undefined *puVar2;
  undefined4 uVar3;
  int iVar4;
  int iVar5;
  uint uVar6;
  long lVar7;
  undefined *puVar8;
  ulong uVar9;
  undefined8 uVar10;
  ulong uVar11;
  undefined *puVar12;
  long in_FS_OFFSET;
  undefined local_4030 [16384];
  
  puVar8 = &stack0xffffffffffffffd0;
  do {
    puVar12 = puVar8;
    *(undefined8 *)(puVar12 + -0x1000) = *(undefined8 *)(puVar12 + -0x1000);
    puVar8 = puVar12 + -0x1000;
  } while (puVar12 + -0x1000 != local_4030);
  *(undefined8 *)(puVar12 + -0x10c0) = *(undefined8 *)(puVar12 + 0x3050);
  *(undefined8 *)(puVar12 + -0x10b0) = param_5;
  *(int *)(puVar12 + -0x109c) = param_6;
  *(undefined8 *)(puVar12 + -0x10b8) = *(undefined8 *)(puVar12 + 0x3058);
  *(undefined8 *)(puVar12 + 0x2ff0) = *(undefined8 *)(in_FS_OFFSET + 0x28);
  lVar7 = 0x38;
  if (param_2 == 1) {
    lVar7 = 0x20;
  }
  *(long *)(puVar12 + -0x10a8) = lVar7;
  if (lVar7 == *(long *)(puVar12 + 0x3038)) {
    if (param_6 == 0) {
      *(undefined8 *)(puVar12 + -0x10d0) = 0x11271b;
      iVar5 = FUN_00114fd0(param_1,", %s linked","statically", "");
      if (iVar5 != -1) {
        iVar5 = 0;
        goto LAB_001125b1;
      }
    }
    else {
      puVar8 = puVar12 + -0x1058;
      if (param_2 == 1) {
        puVar8 = puVar12 + -0x1078;
      }
      puVar2 = puVar12 + -0x1018;
      *(undefined **)(puVar12 + -0x1098) = puVar8;
      *(undefined1 **)(puVar12 + -0x1088) = &DAT_0011ddf7;
      *(char **)(puVar12 + -0x1090) = "statically";
      do {
        *(undefined8 *)(puVar12 + -0x10d0) = 0x11210d;
        lVar7 = __pread_chk((ulong)param_4,*(undefined8 *)(puVar12 + -0x1098),
                            *(undefined8 *)(puVar12 + -0x10a8),*(undefined8 *)(puVar12 + -0x10b0),
                            0x38);
        if (param_2 == 1) {
          if (lVar7 < 0x20) goto LAB_00112660;
          iVar5 = *(int *)(puVar12 + -0x1078);
          *(long *)(puVar12 + -0x10b0) = *(long *)(puVar12 + -0x10b0) + *(long *)(puVar12 + 0x3038);
          if (param_3 == 0) {
            if (iVar5 != 3) {
              if (iVar5 == 4) goto LAB_001124d0;
              if (iVar5 == 2) goto LAB_00112338;
              if (*(long *)(puVar12 + 0x3040) == -1) goto LAB_001122da;
              if ((long)(ulong)*(uint *)(puVar12 + -0x1074) <= *(long *)(puVar12 + 0x3040))
              goto LAB_0011238c;
              goto LAB_00112208;
            }
            uVar11 = (ulong)*(uint *)(puVar12 + -0x1068);
LAB_00112614:
            *(undefined8 *)(puVar12 + -0x10c8) = 4;
LAB_0011261c:
            if (0x1fff < (uint)uVar11) {
              uVar11 = 0x2000;
              uVar9 = (ulong)*(uint *)(puVar12 + -0x1074);
              goto LAB_00112496;
            }
LAB_00112628:
            uVar6 = *(uint *)(puVar12 + -0x1074);
joined_r0x00112630:
            if (param_3 == 0) {
              uVar9 = (ulong)uVar6;
            }
            else {
              *(ulong *)(puVar12 + -0x1080) = uVar11;
              *(undefined8 *)(puVar12 + -0x10d0) = 0x112640;
              uVar6 = FUN_0010ff10(uVar6);
              uVar11 = *(ulong *)(puVar12 + -0x1080);
              uVar9 = (ulong)uVar6;
            }
LAB_00112496:
            *(undefined8 *)(puVar12 + -0x10d0) = 0x1124a7;
            uVar11 = __pread_chk(param_4,puVar2,uVar11,uVar9,0x2000);
            if (uVar11 != 0xffffffffffffffff) {
              if (param_2 == 1) {
                iVar5 = *(int *)(puVar12 + -0x1078);
              }
              else {
                iVar5 = *(int *)(puVar12 + -0x1058);
              }
              goto LAB_001122e5;
            }
            goto LAB_00112660;
          }
          *(int *)(puVar12 + -0x10c8) = iVar5;
          *(undefined8 *)(puVar12 + -0x10d0) = 0x1122b0;
          iVar4 = FUN_0010ff10(iVar5);
          if (iVar4 == 3) {
            uVar11 = (ulong)*(uint *)(puVar12 + -0x1068);
LAB_0011252e:
            *(undefined8 *)(puVar12 + -0x10c8) = 4;
LAB_00112536:
            *(undefined8 *)(puVar12 + -0x10d0) = 0x11253b;
            uVar6 = FUN_0010ff10(uVar11);
            uVar11 = (ulong)uVar6;
            if (uVar6 < 0x2000) goto LAB_00112628;
LAB_00112548:
            uVar6 = *(uint *)(puVar12 + -0x1074);
            uVar11 = 0x2000;
            goto joined_r0x00112630;
          }
          if (iVar4 == 4) {
LAB_001124d0:
            if (*(int *)(puVar12 + 0x3048) == 0) {
              uVar6 = *(uint *)(puVar12 + -0x105c);
              if (uVar6 == 0) {
LAB_00112522:
                uVar11 = (ulong)*(uint *)(puVar12 + -0x1068);
                if (param_3 == 0) goto LAB_00112614;
                goto LAB_0011252e;
              }
              if (param_3 != 0) {
                *(undefined8 *)(puVar12 + -0x10d0) = 0x1126bb;
                uVar6 = FUN_0010ff10(uVar6);
                *(ulong *)(puVar12 + -0x10c8) = (ulong)uVar6;
                if (0x7ffffffb < uVar6 - 4) goto LAB_00112504;
                uVar11 = (ulong)*(uint *)(puVar12 + -0x1068);
                goto LAB_00112536;
              }
              *(ulong *)(puVar12 + -0x10c8) = (ulong)uVar6;
              if (uVar6 - 4 < 0x7ffffffc) {
                uVar11 = (ulong)*(uint *)(puVar12 + -0x1068);
                goto LAB_0011261c;
              }
LAB_00112504:
              *(undefined8 *)(puVar12 + -0x10d0) = 0x112519;
              iVar5 = FUN_00114fd0(param_1,", invalid note alignment 0x%lx",
                                   *(undefined8 *)(puVar12 + -0x10c8));
              if (iVar5 != -1) goto LAB_00112522;
              goto LAB_00112727;
            }
          }
          else {
            iVar5 = *(int *)(puVar12 + -0x10c8);
            if (iVar4 == 2) goto LAB_00112338;
            if (*(long *)(puVar12 + 0x3040) == -1) goto LAB_001122da;
            *(int *)(puVar12 + -0x10c8) = iVar5;
            *(undefined8 *)(puVar12 + -0x10d0) = 0x1126ed;
            uVar6 = FUN_0010ff10(*(undefined4 *)(puVar12 + -0x1074));
            uVar3 = *(undefined4 *)(puVar12 + -0x10c8);
            if ((long)(ulong)uVar6 <= *(long *)(puVar12 + 0x3040)) goto LAB_00112190;
          }
        }
        else {
          if (lVar7 < 0x38) {
LAB_00112660:
            *(undefined8 *)(puVar12 + -0x10d0) = 0x112668;
            FUN_00115270(param_1);
            iVar5 = -1;
            goto LAB_001125b1;
          }
          iVar5 = *(int *)(puVar12 + -0x1058);
          *(long *)(puVar12 + -0x10b0) = *(long *)(puVar12 + -0x10b0) + *(long *)(puVar12 + 0x3038);
          if (param_3 == 0) {
            if (iVar5 == 3) {
              uVar11 = *(ulong *)(puVar12 + -0x1038);
LAB_00112568:
              *(undefined8 *)(puVar12 + -0x10c8) = 4;
LAB_00112570:
              if (uVar11 < 0x2000) {
                uVar9 = *(ulong *)(puVar12 + -0x1050);
              }
              else {
                if (param_2 == 1) goto LAB_00112548;
                uVar9 = *(ulong *)(puVar12 + -0x1050);
                uVar11 = 0x2000;
              }
              goto LAB_00112496;
            }
            if (iVar5 == 4) goto LAB_001123f0;
            if (iVar5 == 2) goto LAB_00112338;
            if (*(long *)(puVar12 + 0x3040) == -1) goto LAB_001122da;
            if (*(long *)(puVar12 + 0x3040) < *(long *)(puVar12 + -0x1050)) goto LAB_00112208;
LAB_0011238c:
            if (iVar5 == 3) goto LAB_00112396;
LAB_001121a4:
            *(undefined8 *)(puVar12 + -0x10c8) = 4;
            uVar11 = 0;
          }
          else {
            *(int *)(puVar12 + -0x10c8) = iVar5;
            *(undefined8 *)(puVar12 + -0x10d0) = 0x112146;
            iVar4 = FUN_0010ff10(iVar5);
            if (iVar4 == 3) {
              uVar11 = *(ulong *)(puVar12 + -0x1038);
LAB_0011245b:
              *(undefined8 *)(puVar12 + -0x10c8) = 4;
LAB_00112463:
              *(undefined8 *)(puVar12 + -0x10d0) = 0x11246b;
              uVar11 = FUN_00110480(uVar11);
              if (uVar11 < 0x2000) {
                uVar10 = *(undefined8 *)(puVar12 + -0x1050);
              }
              else {
                uVar10 = *(undefined8 *)(puVar12 + -0x1050);
                uVar11 = 0x2000;
              }
              *(ulong *)(puVar12 + -0x1080) = uVar11;
              *(undefined8 *)(puVar12 + -0x10d0) = 0x11248e;
              uVar9 = FUN_00110480(uVar10);
              uVar11 = *(ulong *)(puVar12 + -0x1080);
              goto LAB_00112496;
            }
            if (iVar4 == 4) {
LAB_001123f0:
              if (*(int *)(puVar12 + 0x3048) != 0) goto LAB_00112208;
              lVar7 = *(long *)(puVar12 + -0x1028);
              *(long *)(puVar12 + -0x10c8) = lVar7;
              if (lVar7 == 0) {
LAB_0011244b:
                uVar11 = *(ulong *)(puVar12 + -0x1038);
                if (param_3 == 0) goto LAB_00112568;
                goto LAB_0011245b;
              }
              if (param_3 != 0) {
                *(undefined8 *)(puVar12 + -0x10d0) = 0x112680;
                uVar11 = FUN_00110480(lVar7);
                *(ulong *)(puVar12 + -0x10c8) = uVar11;
                if (((uVar11 & 0x80000000) != 0) || (uVar11 < 4)) goto LAB_0011242d;
                uVar11 = *(ulong *)(puVar12 + -0x1038);
                goto LAB_00112463;
              }
              if (((*(ulong *)(puVar12 + -0x10c8) & 0x80000000) == 0) &&
                 (3 < *(ulong *)(puVar12 + -0x10c8))) {
                uVar11 = *(ulong *)(puVar12 + -0x1038);
                goto LAB_00112570;
              }
LAB_0011242d:
              *(undefined8 *)(puVar12 + -0x10d0) = 0x112442;
              iVar5 = FUN_00114fd0(param_1,", invalid note alignment 0x%lx",
                                   *(undefined8 *)(puVar12 + -0x10c8));
              if (iVar5 != -1) goto LAB_0011244b;
              goto LAB_00112727;
            }
            iVar5 = *(int *)(puVar12 + -0x10c8);
            if (iVar4 == 2) {
LAB_00112338:
              *(char **)(puVar12 + -0x1090) = "dynamically";
              goto LAB_00112208;
            }
            if (*(long *)(puVar12 + 0x3040) != -1) {
              *(int *)(puVar12 + -0x10c8) = iVar5;
              *(undefined8 *)(puVar12 + -0x10d0) = 0x112182;
              lVar7 = FUN_00110480(*(undefined8 *)(puVar12 + -0x1050));
              uVar3 = *(undefined4 *)(puVar12 + -0x10c8);
              if (lVar7 <= *(long *)(puVar12 + 0x3040)) {
LAB_00112190:
                *(undefined8 *)(puVar12 + -0x10d0) = 0x112198;
                iVar5 = FUN_0010ff10(uVar3);
                if (iVar5 != 3) goto LAB_001121a4;
LAB_00112396:
                *(char **)(puVar12 + -0x1088) = "*empty*";
              }
              goto LAB_00112208;
            }
LAB_001122da:
            *(undefined8 *)(puVar12 + -0x10c8) = 4;
            uVar11 = 0;
LAB_001122e5:
            if (param_3 != 0) {
              *(undefined8 *)(puVar12 + -0x10d0) = 0x1122f1;
              iVar5 = FUN_0010ff10(iVar5);
            }
            if (iVar5 == 3) {
              *(char **)(puVar12 + -0x1088) = "*empty*";
              if ((uVar11 != 0) && (puVar12[-0x1018] != '\0')) {
                puVar12[uVar11 - 0x1019] = 0;
                *(undefined **)(puVar12 + -0x1088) = puVar2;
              }
              goto LAB_00112208;
            }
          }
          uVar9 = 0;
          if (iVar5 == 4) {
            do {
              if (uVar11 <= uVar9) break;
              *(undefined8 *)(puVar12 + -0x10d8) = 0;
              *(undefined8 *)(puVar12 + -0x10e0) = 0;
              *(undefined8 *)(puVar12 + -0x10e8) = 0;
              *(ulong *)(puVar12 + -0x10f0) = (ulong)param_4;
              *(undefined8 *)(puVar12 + -0x10f8) = *(undefined8 *)(puVar12 + -0x10b8);
              *(undefined8 *)(puVar12 + -0x1100) = *(undefined8 *)(puVar12 + -0x10c0);
              *(undefined8 *)(puVar12 + -0x1108) = *(undefined8 *)(puVar12 + -0x10c8);
              *(undefined8 *)(puVar12 + -0x1110) = 0x1121f4;
              uVar9 = FUN_00110c50(param_1,puVar2,uVar9,uVar11,param_2,param_3);
            } while (uVar9 != 0);
          }
        }
LAB_00112208:
        piVar1 = (int *)(puVar12 + -0x109c);
        *piVar1 = *piVar1 + -1;
      } while (*piVar1 != 0);
      *(undefined8 *)(puVar12 + -0x10d0) = 0x112229;
      iVar5 = FUN_00114fd0(param_1,", %s linked",*(undefined8 *)(puVar12 + -0x1090));
      if (iVar5 != -1) {
        iVar5 = 0;
        if (**(char **)(puVar12 + -0x1088) != '\0') {
          *(undefined8 *)(puVar12 + -0x10d0) = 0x112257;
          uVar10 = FUN_00115ef0(puVar12 + 0xfe8,0x2000,*(char **)(puVar12 + -0x1088));
          *(undefined8 *)(puVar12 + -0x10d0) = 0x11226b;
          iVar5 = FUN_00114fd0(param_1,", interpreter %s",uVar10);
          iVar5 = -(uint)(iVar5 == -1);
        }
        goto LAB_001125b1;
      }
    }
LAB_00112727:
    iVar5 = -1;
  }
  else {
    *(undefined8 *)(puVar12 + -0x10d0) = 0x1125a6;
    iVar5 = FUN_00114fd0(param_1,", corrupted program header size", "");
    iVar5 = -(uint)(iVar5 == -1);
  }
LAB_001125b1:
  if (*(long *)(puVar12 + 0x2ff0) == *(long *)(in_FS_OFFSET + 0x28)) {
    return iVar5;
  }
                    // WARNING: Subroutine does not return
  *(undefined8 *)(puVar12 + -0x10d0) = 0x112756;
  __stack_chk_fail();
}



int FUN_00112760(undefined8 param_1,int param_2,int param_3,int param_4,long param_5,int param_6,
                long param_7,ulong param_8,uint param_9,int param_10,undefined8 param_11,
                undefined8 param_12)

{
  bool bVar1;
  bool bVar2;
  uint uVar3;
  int iVar4;
  uint uVar5;
  long lVar6;
  ssize_t sVar7;
  ulong uVar8;
  ulong uVar9;
  void *__buf;
  __off_t _Var10;
  long lVar11;
  ulong uVar12;
  int *piVar13;
  undefined1 *puVar14;
  ulong extraout_RDX;
  ulong extraout_RDX_00;
  ulong *puVar15;
  char *pcVar16;
  long in_FS_OFFSET;
  int local_170;
  ulong local_168;
  uint *local_160;
  long local_158;
  ulong local_140;
  ulong local_130;
  ulong local_128;
  undefined8 uStack_118;
  uint local_110;
  uint uStack_10c;
  ulong local_108 [2];
  uint local_f8;
  int local_f4;
  uint local_e8;
  uint local_e4;
  uint local_c8;
  int local_c4;
  ulong local_b0;
  ulong local_a8;
  undefined8 uStack_90;
  char local_88 [16];
  long local_78;
  int local_70;
  long local_40;
  
  local_40 = *(long *)(in_FS_OFFSET + 0x28);
  if (param_2 == 1) {
    if (param_7 == 0x28) {
      local_160 = &local_f8;
      lVar6 = __pread_chk(param_4,local_160,0x28,param_5 + (long)param_10 * 0x28,0x40);
      if (0x27 < lVar6) {
        uVar3 = local_e8;
        if (param_3 != 0) {
          uVar3 = FUN_0010ff10(uVar3);
        }
        local_168 = (ulong)uVar3;
        local_158 = 0x28;
        goto LAB_0011282e;
      }
LAB_00112fb0:
      FUN_00115270(param_1);
      iVar4 = -1;
      goto LAB_00112c5b;
    }
  }
  else if (param_7 == 0x40) {
    local_160 = &local_c8;
    lVar6 = __pread_chk(param_4,local_160,0x40,(long)param_10 * 0x40 + param_5,0x40);
    if (lVar6 < 0x40) goto LAB_00112fb0;
    local_168 = local_b0;
    if (param_3 != 0) {
      local_168 = FUN_00110480(local_168);
    }
    local_158 = 0x40;
LAB_0011282e:
    if (param_6 == 0) {
      iVar4 = FUN_00114fd0(param_1,", %sstripped",&DAT_0011ddf7);
      if (iVar4 != -1) {
        iVar4 = 0;
        goto LAB_00112c5b;
      }
    }
    else {
      local_128 = 0;
      bVar1 = true;
      local_130 = 0;
      local_140 = 0;
      local_170 = param_6;
      do {
        uVar3 = local_f8;
        if (param_2 != 1) {
          uVar3 = local_c8;
        }
        if (param_3 != 0) {
          uVar3 = FUN_0010ff10(uVar3);
        }
        sVar7 = pread(param_4,&local_78,0x31,uVar3 + local_168);
        if (sVar7 == -1) goto LAB_00112fb0;
        *(undefined *)((long)&local_78 + sVar7) = 0;
        bVar2 = bVar1;
        if ((local_78 == 0x695f67756265642e) && (bVar2 = false, local_70 != 0x6f666e)) {
          bVar2 = bVar1;
        }
        bVar1 = bVar2;
        lVar6 = __pread_chk(param_4,local_160,param_7,param_5,0x40);
        if (lVar6 < local_158) goto LAB_00112fb0;
        param_5 = param_5 + param_7;
        if (param_2 == 1) {
          iVar4 = local_f4;
          if (param_3 != 0) goto LAB_00112968;
          if (local_f4 == 2) goto LAB_00112eb8;
LAB_0011297d:
          if (param_8 != 0xffffffffffffffff) {
            if (param_2 == 1) {
              uVar8 = (ulong)local_e8;
              if (param_3 != 0) {
                uVar3 = FUN_0010ff10(uVar3);
                uVar8 = (ulong)uVar3;
              }
            }
            else {
              uVar8 = local_b0;
              if (param_3 != 0) {
                uVar8 = FUN_00110480(uVar8);
              }
            }
            if ((long)param_8 < (long)uVar8) goto LAB_00112b1e;
          }
          uVar8 = local_b0;
          if (iVar4 == 7) {
            if (param_2 == 1) {
              uVar9 = (ulong)local_e4;
              uVar8 = (ulong)local_e8;
              if (param_3 != 0) {
                uVar3 = FUN_0010ff10(uVar9);
                uVar9 = (ulong)uVar3;
                uVar3 = FUN_0010ff10(uVar8);
                uVar8 = (ulong)uVar3;
              }
            }
            else {
              uVar9 = local_a8;
              if (param_3 != 0) {
                uVar9 = FUN_00110480(local_a8);
                uVar8 = FUN_00110480(uVar8);
              }
            }
            if (param_8 < uVar8 + uVar9) {
              iVar4 = FUN_00114fd0(param_1,", note offset/size 0x%jx+0x%jx exceeds file size 0x%jx" ,param_8);
              iVar4 = -(uint)(iVar4 == -1);
              goto LAB_00112c5b;
            }
            __buf = malloc(uVar9);
            if (__buf == (void *)0x0) {
              piVar13 = __errno_location();
              FUN_00114dc0(param_1,*piVar13,"Cannot allocate memory for note");
              iVar4 = -1;
              goto LAB_00112c5b;
            }
            if (param_2 == 1) {
              if (param_3 == 0) {
                sVar7 = pread(param_4,__buf,uVar9,(ulong)local_e8);
                uVar8 = (ulong)local_e4;
              }
              else {
                uVar3 = FUN_0010ff10(uVar3);
                sVar7 = pread(param_4,__buf,uVar9,(ulong)uVar3);
                uVar3 = FUN_0010ff10(local_e4);
                uVar8 = (ulong)uVar3;
              }
            }
            else if (param_3 == 0) {
              sVar7 = pread(param_4,__buf,uVar9,local_b0);
              uVar8 = local_a8;
            }
            else {
              _Var10 = FUN_00110480(local_b0);
              sVar7 = pread(param_4,__buf,uVar9,_Var10);
              uVar8 = FUN_00110480(local_a8);
            }
            if (sVar7 < (long)uVar8) {
              FUN_00115270(param_1);
              free(__buf);
              iVar4 = -1;
              goto LAB_00112c5b;
            }
            lVar6 = 0;
            do {
              if (param_2 == 1) {
                uVar8 = (ulong)local_e4;
                if (param_3 != 0) {
                  uVar3 = FUN_0010ff10(uVar3);
                  uVar8 = (ulong)uVar3;
                }
              }
              else {
                uVar8 = local_a8;
                if (param_3 != 0) {
                  uVar8 = FUN_00110480(local_a8);
                }
              }
            } while ((lVar6 < (long)uVar8) &&
                    (lVar6 = FUN_00110c50(param_1,__buf,lVar6,uVar8,param_2,param_3,4,param_11,
                                          param_12,param_4,0,0,0), lVar6 != 0));
            free(__buf);
          }
          else if ((((iVar4 == 0x6ffffff5) && (param_9 < 0x3f)) &&
                   ((1L << ((byte)param_9 & 0x3f) & 0x400408000000000cU) != 0)) && (local_140 < 6))
          {
            if (param_2 == 1) {
              uVar3 = local_e8;
              if (param_3 != 0) {
                uVar3 = FUN_0010ff10(uVar3);
              }
              uVar8 = (ulong)uVar3;
            }
            else if (param_3 != 0) {
              uVar8 = FUN_00110480(uVar8);
            }
            _Var10 = lseek(param_4,uVar8,0);
            if (_Var10 != -1) {
              uVar8 = 0;
LAB_00112d00:
              if (param_2 == 1) goto LAB_00112e40;
LAB_00112d09:
              uVar8 = uVar8 + 0x10;
              uVar9 = local_a8;
              if (param_3 != 0) {
                uVar9 = FUN_00110480(uVar9);
              }
              lVar6 = 0x10;
              do {
                if ((long)uVar9 < (long)uVar8) goto LAB_00112b1e;
                lVar11 = __read_chk(param_4,local_88,lVar6,0x10);
                if ((ulong)(param_2 != 1) * 8 + 8 != lVar11) {
                  FUN_00115270(param_1);
                  goto LAB_0011321d;
                }
                if (local_88[0] == 'A') goto LAB_00112b1e;
                uVar3 = (uint)lVar6;
                if (param_2 == 1) {
                  *(undefined8 *)((long)&uStack_118 + lVar6) =
                       *(undefined8 *)((long)&uStack_90 + lVar6);
                  if (7 < uVar3 - 1) {
                    uVar5 = 0;
                    do {
                      uVar9 = (ulong)uVar5;
                      uVar5 = uVar5 + 8;
                      *(undefined8 *)((long)local_108 + (uVar9 - 8)) =
                           *(undefined8 *)(local_88 + uVar9);
                    } while (uVar5 < uVar3 - 8);
                  }
                  uVar9 = (ulong)local_110;
                  if (param_3 == 0) {
                    if (local_110 == 1) {
                      uVar9 = (ulong)uStack_10c;
                      goto LAB_0011314d;
                    }
                    if (local_110 == 2) {
                      uVar9 = (ulong)uStack_10c;
                      goto LAB_0011316d;
                    }
                    if (local_110 != 0) {
                      uVar12 = (ulong)uStack_10c;
                      goto LAB_00112de0;
                    }
                  }
                  else {
                    uVar3 = FUN_0010ff10(uVar3);
                    if (uVar3 == 1) {
                      uVar3 = FUN_0010ff10(uStack_10c);
                      uVar9 = (ulong)uVar3;
                      goto LAB_0011314d;
                    }
                    if (uVar3 == 2) {
                      uVar3 = FUN_0010ff10(uStack_10c);
                      uVar9 = (ulong)uVar3;
                      goto LAB_0011316d;
                    }
                    if (uVar3 != 0) {
                      uVar9 = (ulong)uVar3;
                      uVar3 = FUN_0010ff10(uStack_10c);
                      uVar12 = (ulong)uVar3;
                      goto LAB_00112de0;
                    }
                  }
                }
                else {
                  uVar5 = 0;
                  do {
                    uVar9 = (ulong)uVar5;
                    uVar5 = uVar5 + 8;
                    *(undefined8 *)((long)local_108 + uVar9) = *(undefined8 *)(local_88 + uVar9);
                  } while (uVar5 < uVar3);
                  if (param_3 == 0) {
                    uVar9 = local_108[1];
                    if (local_108[0] == 1) goto LAB_0011314d;
                    if (local_108[0] == 2) goto LAB_0011316d;
                    uVar12 = local_108[1];
                    uVar9 = local_108[0];
                    if (local_108[0] == 0) goto LAB_00112d00;
                  }
                  else {
                    uVar9 = FUN_00110480(local_108[0]);
                    if (uVar9 == 1) {
                      uVar9 = FUN_00110480(local_108[1]);
LAB_0011314d:
                      local_130 = local_130 | uVar9;
                      goto LAB_00112d00;
                    }
                    if (uVar9 == 2) {
                      uVar9 = FUN_00110480(local_108[1]);
LAB_0011316d:
                      local_128 = local_128 | uVar9;
                      goto LAB_00112d00;
                    }
                    if (uVar9 == 0) goto LAB_00112d00;
                    uVar12 = FUN_00110480(local_108[1]);
                  }
LAB_00112de0:
                  iVar4 = FUN_00114fd0(param_1,", with unknown capability 0x%llx = 0x%llx",uVar9);
                  if (iVar4 == -1) goto LAB_0011321d;
                  uVar9 = local_140 + 1;
                  if (2 < local_140) {
                    if (param_2 == 1) {
                      uVar3 = local_e4;
                      if (param_3 != 0) {
                        uVar3 = FUN_0010ff10(uVar3);
                      }
                      uVar8 = (ulong)uVar3;
                      local_140 = uVar9;
                      goto LAB_00112e40;
                    }
                    uVar8 = local_a8;
                    if (param_3 != 0) {
                      uVar8 = FUN_00110480(local_a8);
                    }
                  }
                  local_140 = uVar9;
                  if (param_2 != 1) goto LAB_00112d09;
                }
LAB_00112e40:
                uVar8 = uVar8 + 8;
                uVar3 = local_e4;
                if (param_3 != 0) {
                  uVar3 = FUN_0010ff10(uVar3);
                }
                uVar9 = (ulong)uVar3;
                lVar6 = 8;
              } while( true );
            }
            FUN_00115240(param_1);
            iVar4 = -1;
            goto LAB_00112c5b;
          }
        }
        else {
          iVar4 = local_c4;
          if (param_3 != 0) {
LAB_00112968:
            iVar4 = FUN_0010ff10(iVar4);
          }
          if (iVar4 != 2) goto LAB_0011297d;
LAB_00112eb8:
          bVar1 = false;
        }
LAB_00112b1e:
        local_170 = local_170 + -1;
      } while (local_170 != 0);
      puVar14 = &DAT_0011ddf7;
      if (!bVar1) {
        puVar14 = &DAT_0011e299;
      }
      iVar4 = FUN_00114fd0(param_1,", %sstripped",puVar14);
      if (iVar4 != -1) {
        uVar8 = extraout_RDX;
        if (local_130 == 0) {
LAB_00112bdb:
          if (local_128 != 0) {
            if ((local_128 & 2) != 0) {
              pcVar16 = ", uses frame pointer";
              if ((local_128 & 1) == 0) {
                pcVar16 = ", not known to use frame pointer";
              }
              iVar4 = FUN_00114fd0(param_1,pcVar16,uVar8);
              if (iVar4 == -1) goto LAB_0011321d;
            }
            if ((local_128 & 0xfffffffffffffffc) != 0) {
              iVar4 = FUN_00114fd0(param_1,", with unknown software capability 0x%llx", "");
              iVar4 = -(uint)(iVar4 == -1);
              goto LAB_00112c5b;
            }
          }
          iVar4 = 0;
          goto LAB_00112c5b;
        }
        uVar8 = local_130;
        if (param_9 < 0x3f) {
          uVar9 = 1L << ((byte)param_9 & 0x3f);
          if ((uVar9 & 0x4004000000000008) == 0) {
            if ((uVar9 & 0x80000040004) == 0) goto LAB_00112ba2;
            iVar4 = FUN_00114fd0(param_1,", uses", "");
            if (iVar4 != -1) {
              pcVar16 = "MUL32";
              puVar15 = &DAT_001238e0;
              goto LAB_001132dd;
            }
          }
          else {
            iVar4 = FUN_00114fd0(param_1,", uses", "");
            if (iVar4 != -1) {
              pcVar16 = "FPU";
              puVar15 = (ulong *)&DAT_00123740;
LAB_001132dd:
              do {
                if ((*puVar15 & uVar8) != 0) {
                  iVar4 = FUN_00114fd0(param_1," %s",pcVar16);
                  if (iVar4 == -1) goto LAB_0011321d;
                  uVar8 = uVar8 & ~*puVar15;
                }
                pcVar16 = (char *)puVar15[3];
                puVar15 = puVar15 + 2;
              } while (pcVar16 != (char *)0x0);
              pcVar16 = " unknown hardware capability 0x%llx";
              if (uVar8 == 0) goto LAB_00112bdb;
              goto LAB_00112bc8;
            }
          }
        }
        else {
LAB_00112ba2:
          iVar4 = FUN_00114fd0(param_1,", uses", "");
          if (iVar4 != -1) {
            pcVar16 = " hardware capability 0x%llx";
LAB_00112bc8:
            iVar4 = FUN_00114fd0(param_1,pcVar16,uVar8);
            uVar8 = extraout_RDX_00;
            if (iVar4 != -1) goto LAB_00112bdb;
          }
        }
      }
    }
LAB_0011321d:
    iVar4 = -1;
    goto LAB_00112c5b;
  }
  iVar4 = FUN_00114fd0(param_1,", corrupted section header size", "");
  iVar4 = -(uint)(iVar4 == -1);
LAB_00112c5b:
  if (local_40 == *(long *)(in_FS_OFFSET + 0x28)) {
    return iVar4;
  }
                    // WARNING: Subroutine does not return
  __stack_chk_fail();
}



int FUN_001133b0(long param_1,int param_2,char *param_3,ulong param_4)

{
  char cVar1;
  ushort uVar2;
  ulong uVar3;
  ushort uVar4;
  ushort uVar5;
  ushort uVar6;
  int iVar7;
  undefined uVar17;
  uint uVar8;
  uint uVar9;
  undefined4 uVar10;
  __off_t _Var11;
  int *piVar12;
  undefined uVar16;
  ulong uVar13;
  ulong uVar14;
  undefined uVar18;
  bool bVar19;
  undefined uVar22;
  undefined2 uVar20;
  char *pcVar21;
  undefined8 uVar23;
  uint uVar24;
  long in_FS_OFFSET;
  ushort uVar25;
  undefined2 uVar26;
  short local_de;
  uint local_dc;
  struct stat local_d8;
  long local_40;
  ulong uVar15;
  
  local_40 = *(long *)(in_FS_OFFSET + 0x28);
  local_dc = 0;
  if (((((*(uint *)(param_1 + 0x38) & 0x1000c10) != 0) || (*param_3 != '\x7f')) ||
      ((param_3[1] != 'E' && (param_3[1] != 'O')))) || ((param_3[2] != 'L' || (param_3[3] != 'F'))))
  {
LAB_001133f1:
    iVar7 = 0;
    goto LAB_001133f3;
  }
  _Var11 = lseek(param_2,0,0);
  if ((_Var11 == -1) && (piVar12 = __errno_location(), *piVar12 == 0x1d)) {
    param_2 = FUN_0010fb80(param_1,param_2,param_3);
  }
  iVar7 = __fxstat(1,param_2,&local_d8);
  if (iVar7 == -1) {
    iVar7 = -1;
    FUN_00115270(param_1);
    goto LAB_001133f3;
  }
  _Var11 = local_d8.st_size;
  if (((local_d8.st_mode & 0xf000) != 0x8000) && (local_d8.st_size == 0)) {
    _Var11 = -1;
  }
  cVar1 = param_3[4];
  if (cVar1 == '\x01') {
    if (param_4 < 0x35) goto LAB_001133f1;
    uVar25 = *(ushort *)(param_3 + 0x32);
    uVar26 = *(undefined2 *)(param_3 + 0x2e);
    uVar6 = *(ushort *)(param_3 + 0x10);
    uVar2 = *(ushort *)(param_3 + 0x12);
    uVar24 = (uint)uVar2;
    uVar9 = *(uint *)(param_3 + 0x1c);
    uVar14 = (ulong)uVar25;
    uVar8 = *(uint *)(param_3 + 0x20);
    uVar20 = *(undefined2 *)(param_3 + 0x2a);
    uVar4 = *(ushort *)(param_3 + 0x2c);
    uVar15 = (ulong)uVar4;
    uVar5 = *(ushort *)(param_3 + 0x30);
    local_de = *(short *)(param_1 + 0xd8);
    bVar19 = param_3[5] != '\x01';
    if (param_3[5] == '\x01') {
      if (3 < uVar6) {
        if (uVar6 == 4) {
          uVar24 = (uint)uVar4;
          if (uVar4 <= *(ushort *)(param_1 + 0xd6)) {
            local_dc = local_dc | 0x100;
            goto LAB_001138a9;
          }
LAB_00113bf5:
          uVar15 = (ulong)uVar24;
          pcVar21 = "program headers";
          goto LAB_0011397e;
        }
        goto LAB_0011363d;
      }
      if (uVar6 < 2) {
        if (uVar6 != 1) goto LAB_0011363d;
      }
      else {
        if (*(ushort *)(param_1 + 0xd6) < uVar4) goto LAB_00113c03;
        if (*(ushort *)(param_1 + 0xd4) < uVar5) goto LAB_00113c4c;
        iVar7 = FUN_00112020(param_1,1,0,param_2,uVar9,uVar4);
        if (iVar7 == -1) goto LAB_00113814;
      }
      uVar15 = (ulong)uVar5;
      if (*(ushort *)(param_1 + 0xd4) < uVar5) {
LAB_00113c26:
        pcVar21 = "section headers";
        goto LAB_0011397e;
      }
      uVar14 = uVar14 & 0xffff;
      uVar24 = uVar24 & 0xffff;
LAB_00113762:
      uVar13 = (ulong)uVar8;
      uVar23 = 1;
LAB_00113628:
      iVar7 = FUN_00112760(param_1,uVar23,bVar19,param_2,uVar13,uVar15,uVar26,_Var11,uVar24,uVar14,
                           &local_dc,&local_de);
joined_r0x0011380e:
      if (iVar7 == -1) {
LAB_00113814:
        iVar7 = -1;
        goto LAB_001133f3;
      }
      goto LAB_0011363d;
    }
    uVar6 = CONCAT11((char)uVar6,(char)(uVar6 >> 8));
    uVar18 = (undefined)(uVar4 >> 8);
    uVar22 = (undefined)((ushort)uVar20 >> 8);
    if (3 < uVar6) {
      if (uVar6 != 4) goto LAB_0011363d;
      uVar4 = CONCAT11((char)uVar4,uVar18);
      if (*(ushort *)(param_1 + 0xd6) < uVar4) {
LAB_00113bf2:
        uVar24 = (uint)uVar4;
        goto LAB_00113bf5;
      }
      local_dc = local_dc | 0x100;
      uVar20 = CONCAT11((char)uVar20,uVar22);
      uVar9 = FUN_0010ff10(uVar9);
LAB_001138a9:
      uVar14 = (ulong)uVar9;
      uVar15 = (ulong)uVar4;
      uVar23 = 1;
LAB_001137ff:
      iVar7 = FUN_00111c70(param_1,uVar23,bVar19,param_2,uVar14,uVar15,uVar20,_Var11,&local_dc,
                           &local_de);
      goto joined_r0x0011380e;
    }
    uVar16 = (undefined)uVar5;
    uVar17 = (undefined)(uVar5 >> 8);
    if (uVar6 < 2) {
      if (uVar6 != 1) goto LAB_0011363d;
LAB_001136e2:
      uVar4 = CONCAT11(uVar16,uVar17);
      if (*(ushort *)(param_1 + 0xd4) < uVar4) {
        uVar15 = (ulong)uVar4;
        goto LAB_00113c26;
      }
      uVar15 = (ulong)uVar4;
      uVar9 = (uint)CONCAT11((char)uVar25,(char)(uVar25 >> 8));
      uVar24 = (uint)CONCAT11((char)uVar2,(char)(uVar2 >> 8));
      uVar26 = CONCAT11((char)uVar26,(char)((ushort)uVar26 >> 8));
      uVar8 = FUN_0010ff10(uVar8);
      uVar15 = uVar15 & 0xffffffff;
      uVar14 = (ulong)uVar9;
      goto LAB_00113762;
    }
    uVar4 = CONCAT11((char)uVar4,uVar18);
    uVar15 = (ulong)uVar4;
    if (uVar4 <= *(ushort *)(param_1 + 0xd6)) {
      uVar5 = CONCAT11(uVar16,uVar17);
      if (*(ushort *)(param_1 + 0xd4) < uVar5) {
LAB_00113c4c:
        uVar15 = (ulong)uVar5;
        pcVar21 = "section";
        goto LAB_0011397e;
      }
      uVar6 = CONCAT11((char)uVar20,uVar22);
      uVar13 = (ulong)uVar6;
      uVar24 = (uint)uVar6;
      uVar10 = FUN_0010ff10(uVar10);
      iVar7 = FUN_00112020(param_1,1,1,param_2,uVar10,uVar4);
      if (iVar7 != -1) goto LAB_001136e2;
      goto LAB_00113814;
    }
LAB_00113c03:
    pcVar21 = "program";
  }
  else {
    if (cVar1 != '\x02') {
      iVar7 = FUN_00114fd0(param_1,", unknown class %d",cVar1);
      iVar7 = -(uint)(iVar7 == -1);
      goto LAB_001133f3;
    }
    if (param_4 < 0x41) goto LAB_001133f1;
    uVar13 = *(ulong *)(param_3 + 0x28);
    uVar4 = *(ushort *)(param_3 + 0x10);
    uVar25 = *(ushort *)(param_3 + 0x12);
    uVar24 = (uint)uVar25;
    uVar14 = *(ulong *)(param_3 + 0x20);
    uVar20 = *(undefined2 *)(param_3 + 0x36);
    uVar26 = *(undefined2 *)(param_3 + 0x3a);
    uVar6 = *(ushort *)(param_3 + 0x38);
    uVar15 = (ulong)uVar6;
    uVar2 = *(ushort *)(param_3 + 0x3c);
    uVar5 = *(ushort *)(param_3 + 0x3e);
    bVar19 = param_3[5] != '\x01';
    local_de = *(short *)(param_1 + 0xd8);
    if (param_3[5] == '\x01') {
      if (uVar4 < 4) {
        if (uVar4 < 2) {
          if (uVar4 != 1) goto LAB_0011363d;
        }
        else {
          if (*(ushort *)(param_1 + 0xd6) < uVar6) goto LAB_00113c03;
          uVar3 = (ulong)uVar2;
          if (*(ushort *)(param_1 + 0xd4) < uVar2) goto LAB_00113c3a;
          iVar7 = FUN_00112020(param_1,2,0,param_2,uVar14,uVar15);
          if (iVar7 == -1) goto LAB_00113814;
        }
        uVar15 = (ulong)uVar2;
        if (*(ushort *)(param_1 + 0xd4) < uVar2) goto LAB_00113c13;
        uVar24 = uVar24 & 0xffff;
        goto LAB_00113606;
      }
      if (uVar4 == 4) {
        uVar24 = (uint)uVar6;
        if (*(ushort *)(param_1 + 0xd6) < uVar6) goto LAB_00113bf5;
        local_dc = local_dc | 0x100;
        goto LAB_001137e2;
      }
    }
    else {
      uVar4 = CONCAT11((char)uVar4,(char)(uVar4 >> 8));
      uVar18 = (undefined)(uVar6 >> 8);
      uVar22 = (undefined)((ushort)uVar20 >> 8);
      if (uVar4 < 4) {
        uVar16 = (undefined)(uVar2 >> 8);
        if (uVar4 < 2) {
          if (uVar4 != 1) goto LAB_0011363d;
        }
        else {
          uVar4 = CONCAT11((char)uVar6,uVar18);
          uVar15 = (ulong)uVar4;
          if (*(ushort *)(param_1 + 0xd6) < uVar4) goto LAB_00113c03;
          uVar6 = CONCAT11((char)uVar2,uVar16);
          uVar3 = (ulong)uVar6;
          if (*(ushort *)(param_1 + 0xd4) < uVar6) {
LAB_00113c3a:
            uVar15 = uVar3;
            pcVar21 = "section";
            goto LAB_0011397e;
          }
          uVar24 = (uint)CONCAT11((char)uVar20,uVar22);
          uVar23 = FUN_00110480(uVar14);
          iVar7 = FUN_00112020(param_1,2,1,param_2,uVar23,uVar4);
          if (iVar7 == -1) goto LAB_00113814;
        }
        uVar4 = CONCAT11((char)uVar2,uVar16);
        if (*(ushort *)(param_1 + 0xd4) < uVar4) {
          uVar15 = (ulong)uVar4;
LAB_00113c13:
          pcVar21 = "section headers";
          goto LAB_0011397e;
        }
        uVar5 = CONCAT11((char)uVar5,(char)(uVar5 >> 8));
        uVar9 = (uint)uVar4;
        uVar24 = (uint)CONCAT11((char)uVar25,(char)(uVar25 >> 8));
        uVar26 = CONCAT11((char)uVar26,(char)((ushort)uVar26 >> 8));
        uVar13 = FUN_00110480(uVar13);
        uVar15 = (ulong)uVar9;
LAB_00113606:
        uVar14 = (ulong)uVar5;
        uVar23 = 2;
        goto LAB_00113628;
      }
      if (uVar4 == 4) {
        uVar4 = CONCAT11((char)uVar6,uVar18);
        if (*(ushort *)(param_1 + 0xd6) < uVar4) goto LAB_00113bf2;
        local_dc = local_dc | 0x100;
        uVar15 = (ulong)uVar4;
        uVar20 = CONCAT11((char)uVar20,uVar22);
        uVar14 = FUN_00110480(uVar14);
LAB_001137e2:
        uVar23 = 2;
        goto LAB_001137ff;
      }
    }
LAB_0011363d:
    if (local_de != 0) {
      iVar7 = 1;
      goto LAB_001133f3;
    }
    uVar15 = (ulong)*(ushort *)(param_1 + 0xd8);
    pcVar21 = "notes";
  }
LAB_0011397e:
  iVar7 = FUN_00114fd0(param_1,", too many %s (%u)",uVar15);
  iVar7 = -(uint)(iVar7 == -1);
LAB_001133f3:
  if (local_40 == *(long *)(in_FS_OFFSET + 0x28)) {
    return iVar7;
  }
                    // WARNING: Subroutine does not return
  __stack_chk_fail();
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

void FUN_00113c60(undefined8 param_1,undefined8 param_2,undefined8 param_3,undefined8 param_4,
                 undefined8 param_5,undefined8 param_6,undefined8 param_7,undefined8 param_8,
                 long param_9,undefined8 param_10,undefined8 param_11,undefined8 param_12,
                 undefined8 param_13,undefined8 param_14)

{
  char in_AL;
  long in_FS_OFFSET;
  undefined4 local_e8;
  undefined4 local_e4;
  undefined *local_e0;
  undefined *local_d8;
  long local_d0;
  undefined local_c8 [16];
  undefined8 local_b8;
  undefined8 local_b0;
  undefined8 local_a8;
  undefined8 local_a0;
  undefined8 local_98;
  undefined8 local_88;
  undefined8 local_78;
  undefined8 local_68;
  undefined8 local_58;
  undefined8 local_48;
  undefined8 local_38;
  undefined8 local_28;
  
  if (in_AL != '\0') {
    local_98 = param_1;
    local_88 = param_2;
    local_78 = param_3;
    local_68 = param_4;
    local_58 = param_5;
    local_48 = param_6;
    local_38 = param_7;
    local_28 = param_8;
  }
  local_d0 = *(long *)(in_FS_OFFSET + 0x28);
  local_b8 = param_11;
  local_b0 = param_12;
  local_a8 = param_13;
  local_a0 = param_14;
  fflush(_stdout);
  if (*(long *)(param_9 + 0x40) != 0) {
    __fprintf_chk(_stderr,1,"%s, %lu: ",*(long *)(param_9 + 0x40),*(undefined8 *)(param_9 + 0x48));
  }
  fwrite("Warning: ",1,9,_stderr);
  local_e0 = &stack0x00000008;
  local_e8 = 0x10;
  local_d8 = local_c8;
  local_e4 = 0x30;
  __vfprintf_chk(_stderr,1,param_10,&local_e8);
  fputc(10,_stderr);
  if (local_d0 == *(long *)(in_FS_OFFSET + 0x28)) {
    return;
  }
                    // WARNING: Subroutine does not return
  __stack_chk_fail();
}



char * FUN_00113da0(time_t param_1,uint param_2,char *param_3)

{
  tm *__tp;
  char *__s;
  size_t sVar1;
  long in_FS_OFFSET;
  time_t local_60;
  tm local_58;
  long local_20;
  
  local_20 = *(long *)(in_FS_OFFSET + 0x28);
  local_60 = param_1;
  if ((param_2 & 2) != 0) {
    FUN_00118d10(&local_58,param_1);
    *(undefined4 *)(local_60 + 0) = local_58.tm_sec;
    *(undefined4 *)(local_60 + 4)= local_58.tm_min;
  }
  if ((param_2 & 1) == 0) {
    __tp = gmtime_r(&local_60,&local_58);
  }
  else {
    __tp = localtime_r(&local_60,&local_58);
  }
  if ((__tp == (tm *)0x0) || (__s = asctime_r(__tp,param_3), __s == (char *)0x0)) {
    builtin_strncpy(param_3,"*Invalid time*",0xf);
  }
  else {
    sVar1 = strcspn(__s,"\n");
    __s[sVar1] = '\0';
    param_3 = __s;
  }
  if (local_20 == *(long *)(in_FS_OFFSET + 0x28)) {
    return param_3;
  }
                    // WARNING: Subroutine does not return
  __stack_chk_fail();
}



// WARNING: Type propagation algorithm not settling
// WARNING: Globals starting with '_' overlap smaller symbols at the same address

void FUN_00113e90(ushort *param_1)

{
  byte bVar1;
  uint uVar2;
  char *pcVar3;
  char *pcVar4;
  undefined8 uVar5;
  ulong uVar6;
  long in_FS_OFFSET;
  double dVar7;
  undefined auStack_48 [40];
  long local_20;
  
  local_20 = *(long *)(in_FS_OFFSET + 0x28);
  __fprintf_chk(_stderr,1,"%u: %.*s %u",*(undefined4 *)(param_1 + 10),(*param_1 & 7) + 1,">>>>>>>>",
                *(undefined4 *)(param_1 + 6));
  bVar1 = *(byte *)(param_1 + 1);
  if ((bVar1 & 1) != 0) {
    pcVar3 = "*bad in_type*";
    if ((ulong)*(byte *)((long)param_1 + 7) < 0x31) {
      pcVar3 = *(char **)(&DAT_001245e0 + (ulong)*(byte *)((long)param_1 + 7) * 8);
    }
    __fprintf_chk(_stderr,1,&DAT_0011e88b,pcVar3);
    bVar1 = *(byte *)(param_1 + 4);
    if ((bVar1 & 0x40) != 0) {
      fputc(0x7e,_stderr);
      bVar1 = *(byte *)(param_1 + 4);
    }
    __fprintf_chk(_stderr,1,&DAT_0011e890,(int)"&|^+-*/%"[bVar1 & 7],*(undefined4 *)(param_1 + 8));
    bVar1 = *(byte *)(param_1 + 1);
  }
  pcVar3 = "*bad type";
  if ((ulong)*(byte *)(param_1 + 3) < 0x31) {
    pcVar3 = *(char **)(&DAT_001245e0 + (ulong)*(byte *)(param_1 + 3) * 8);
  }
  pcVar4 = "u";
  if ((bVar1 & 8) == 0) {
    pcVar4 = "";
  }
  __fprintf_chk(_stderr,1,&DAT_0011e897,pcVar4,pcVar3);
  if ((*(byte *)((long)param_1 + 9) & 0x40) != 0) {
    fputc(0x7e,_stderr);
  }
  if ((*(byte *)(param_1 + 3) < 0x2f) &&
     ((0x6200001e2020U >> ((ulong)*(byte *)(param_1 + 3) & 0x3f) & 1) != 0)) {
    if (*(int *)(param_1 + 0xe) != 0) {
      fputc(0x2f,_stderr);
      uVar2 = *(uint *)(param_1 + 0xe);
      if ((uVar2 & 1) != 0) {
        fputc(0x57,_stderr);
        uVar2 = *(uint *)(param_1 + 0xe);
      }
      if ((uVar2 & 2) != 0) {
        fputc(0x77,_stderr);
        uVar2 = *(uint *)(param_1 + 0xe);
      }
      if ((uVar2 & 4) != 0) {
        fputc(99,_stderr);
        uVar2 = *(uint *)(param_1 + 0xe);
      }
      if ((uVar2 & 8) != 0) {
        fputc(0x43,_stderr);
        uVar2 = *(uint *)(param_1 + 0xe);
      }
      if ((uVar2 & 0x10) != 0) {
        fputc(0x73,_stderr);
        uVar2 = *(uint *)(param_1 + 0xe);
      }
      if ((uVar2 & 0x20) != 0) {
        fputc(0x74,_stderr);
        uVar2 = *(uint *)(param_1 + 0xe);
      }
      if ((uVar2 & 0x40) != 0) {
        fputc(0x62,_stderr);
        uVar2 = *(uint *)(param_1 + 0xe);
      }
      if ((uVar2 & 0x80) != 0) {
        fputc(0x42,_stderr);
        uVar2 = *(uint *)(param_1 + 0xe);
      }
      if ((uVar2 & 0x100) != 0) {
        fputc(0x48,_stderr);
        uVar2 = *(uint *)(param_1 + 0xe);
      }
      if ((uVar2 & 0x200) != 0) {
        fputc(0x68,_stderr);
        uVar2 = *(uint *)(param_1 + 0xe);
      }
      if ((uVar2 & 0x400) != 0) {
        fputc(0x4c,_stderr);
        uVar2 = *(uint *)(param_1 + 0xe);
      }
      if ((uVar2 & 0x800) != 0) {
        fputc(0x6c,_stderr);
        uVar2 = *(uint *)(param_1 + 0xe);
      }
      if ((uVar2 & 0x1000) != 0) {
        fputc(0x4a,_stderr);
      }
    }
    if (*(int *)(param_1 + 0xc) != 0) {
      __fprintf_chk(_stderr,1,&DAT_0011e89d);
    }
  }
  else {
    fputc((int)"&|^+-*/%"[*(byte *)((long)param_1 + 9) & 7],_stderr);
    if (*(long *)(param_1 + 0xc) != 0) {
      __fprintf_chk(_stderr,1,"%.8llx");
    }
  }
  __fprintf_chk(_stderr,1,&DAT_0011e8a8,*(undefined *)(param_1 + 2));
  if (*(char *)(param_1 + 2) == 'x') goto switchD_00114069_caseD_3;
  if (false) {
switchD_00114069_caseD_0:
    __fprintf_chk(_stderr,1,"*bad type %d*");
    goto switchD_00114069_caseD_3;
  }
  switch(*(undefined *)(param_1 + 3)) {
  default:
    goto switchD_00114069_caseD_0;
  case 1:
  case 2:
  case 4:
  case 7:
  case 8:
  case 10:
  case 0xb:
  case 0x17:
  case 0x29:
    __fprintf_chk(_stderr,1,"%d",*(undefined4 *)(param_1 + 0x10));
    break;
  case 3:
    break;
  case 5:
  case 0xd:
  case 0x11:
  case 0x12:
  case 0x13:
  case 0x14:
    FUN_00107320(_stderr,param_1 + 0x10,*(undefined *)((long)param_1 + 5));
    break;
  case 6:
  case 9:
  case 0xc:
  case 0x15:
    uVar6 = (ulong)*(uint *)(param_1 + 0x10);
    uVar5 = 0;
    goto LAB_00114078;
  case 0xe:
  case 0xf:
  case 0x10:
  case 0x16:
    uVar6 = (ulong)*(uint *)(param_1 + 0x10);
    goto LAB_001141f6;
  case 0x18:
  case 0x19:
  case 0x1a:
    __fprintf_chk(_stderr,1,&DAT_0011e8ac,*(undefined8 *)(param_1 + 0x10));
    break;
  case 0x1b:
  case 0x1c:
  case 0x1d:
    uVar6 = *(ulong *)(param_1 + 0x10);
    uVar5 = 0;
    goto LAB_00114078;
  case 0x1e:
  case 0x1f:
  case 0x20:
    uVar6 = *(ulong *)(param_1 + 0x10);
LAB_001141f6:
    uVar5 = 1;
    goto LAB_00114078;
  case 0x21:
  case 0x22:
  case 0x23:
    dVar7 = (double)*(float *)(param_1 + 0x10);
    goto LAB_00114225;
  case 0x24:
  case 0x25:
  case 0x26:
    dVar7 = *(double *)(param_1 + 0x10);
LAB_00114225:
    __fprintf_chk((void *)dVar7,_stderr,1,&DAT_0011e8b1);
    break;
  case 0x2a:
  case 0x2b:
  case 0x2c:
    uVar6 = *(ulong *)(param_1 + 0x10);
    uVar5 = 2;
LAB_00114078:
    uVar5 = FUN_00113da0(uVar6,uVar5,auStack_48);
    __fprintf_chk(_stderr,1,&DAT_0011e88c,uVar5);
    break;
  case 0x2d:
  case 0x2e:
  case 0x30:
    __fprintf_chk(_stderr,1,"\'%s\'",param_1 + 0x10);
  }
switchD_00114069_caseD_3:
  __fprintf_chk(_stderr,1,",\"%s\"]\n",param_1 + 0x40);
  if (local_20 == *(long *)(in_FS_OFFSET + 0x28)) {
    return;
  }
                    // WARNING: Subroutine does not return
  __stack_chk_fail();
}



undefined8 FUN_00114480(long param_1,undefined4 param_2,undefined8 param_3)

{
  uint uVar1;
  int iVar2;
  
  uVar1 = *(uint *)(param_1 + 0x38);
  if (((uVar1 & 0x10) != 0) && (iVar2 = FUN_00114fd0(param_1,"inode/symlink"), iVar2 == -1)) {
    return 0xffffffff;
  }
  if ((uVar1 & 0x410) == 0) {
    if ((*(byte *)(param_1 + 0x39) & 2) != 0) {
      FUN_00114dc0(param_1,param_2,"broken symbolic link to %s");
      return 0xffffffff;
    }
    iVar2 = FUN_00114fd0(param_1,"broken symbolic link to %s",param_3);
    if (iVar2 == -1) {
      return 0xffffffff;
    }
  }
  return 1;
}



int FUN_00114530(undefined8 param_1,uint param_2)

{
  int iVar1;
  
  if ((param_2 & 0x10) == 0) {
    if ((param_2 & 0x400) != 0) {
LAB_0011457e:
      iVar1 = FUN_00114fd0(param_1,"binary", "");
      return -(uint)(iVar1 == -1);
    }
LAB_00114545:
    iVar1 = 0;
  }
  else {
    iVar1 = FUN_00114fd0(param_1,"inode/%s", "");
    if (iVar1 != -1) {
      if ((param_2 & 0x400) == 0) goto LAB_00114545;
      iVar1 = FUN_00114fd0(param_1,"; charset=", "");
      if (iVar1 != -1) goto LAB_0011457e;
    }
    iVar1 = -1;
  }
  return iVar1;
}



uint FUN_001145b0(long param_1,char *param_2, struct stat *param_3)

{
  byte bVar1;
  ulong uVar2;
  undefined8 uVar3;
  undefined *puVar4;
  int iVar5;
  uint uVar6;
  uint uVar7;
  int *piVar8;
  char *pcVar9;
  ssize_t sVar10;
  char *pcVar11;
  long lVar12;
  char *extraout_RDX;
  char *extraout_RDX_00;
  uint uVar13;
  undefined *puVar14;
  char *pcVar15;
  uint uVar16;
  uint uVar17;
  long in_FS_OFFSET;
  undefined local_6030 [24576];
  
  puVar4 = &stack0xffffffffffffffd0;
  do {
    puVar14 = puVar4;
    *(undefined8 *)(puVar14 + -0x1000) = *(undefined8 *)(puVar14 + -0x1000);
    puVar4 = puVar14 + -0x1000;
  } while (puVar14 + -0x1000 != local_6030);
  uVar13 = *(uint *)(param_1 + 0x38);
  *(undefined8 *)(puVar14 + 0x4ff0) = *(undefined8 *)(in_FS_OFFSET + 0x28);
  if (((uVar13 & 0x1000800) != 0) || (param_2 == (char *)0x0)) {
    uVar16 = 0;
    goto LAB_00114663;
  }
  if ((uVar13 & 2) == 0) {
    *(undefined8 *)(puVar14 + -0x10d0) = 0x114695;
    iVar5 = __lxstat(1,param_2,param_3);
  }
  else {
    *(undefined8 *)(puVar14 + -0x10d0) = 0x114621;
    iVar5 = __xstat(1,param_2,param_3);
  }
  if (iVar5 != 0) {
    *(undefined8 *)(puVar14 + -0x10d0) = 0x11462e;
    piVar8 = __errno_location();
    iVar5 = *piVar8;
    if ((*(byte *)(param_1 + 0x39) & 2) == 0) {
      *(undefined8 *)(puVar14 + -0x10d0) = 0x11463f;
      pcVar9 = strerror(iVar5);
      *(undefined8 *)(puVar14 + -0x10d0) = 0x114659;
      iVar5 = FUN_00114fd0(param_1,"cannot open `%s\' (%s)",param_2);
      uVar16 = -(uint)(iVar5 == -1);
    }
    else {
      uVar16 = 0xffffffff;
      *(undefined8 *)(puVar14 + -0x10d0) = 0x114d2c;
      FUN_00114dc0(param_1,iVar5,"cannot stat `%s\'");
    }
    goto LAB_00114663;
  }
  uVar7 = param_3->st_mode;
  uVar13 = uVar13 & 0x410;
  uVar16 = 0;
  if (uVar13 == 0) {
    if ((uVar7 & 0x800) == 0) {
      if ((uVar7 & 0x400) == 0) {
        uVar17 = 1;
        pcVar9 = "";
        if ((uVar7 & 0x200) == 0) {
          uVar6 = uVar7 & 0xf000;
          if (uVar6 == 0x4000) {
LAB_00114787:
            pcVar15 = "%sdirectory";
          }
          else {
            if (0x4000 < uVar6) {
              uVar17 = uVar16;
              if (uVar6 == 0xa000) goto LAB_00114963;
              if (0xa000 < uVar6) {
                if (uVar6 != 0xc000) goto LAB_00114a50;
                goto LAB_001148b9;
              }
              if (uVar6 != 0x6000) goto LAB_001147b0;
              uVar17 = *(uint *)(param_1 + 0x38) & 8;
              if (uVar17 != 0) goto LAB_00114663;
              goto LAB_00114ba1;
            }
            if (uVar6 != 0x1000) {
              if (uVar6 != 0x2000) goto LAB_00114a50;
              uVar17 = *(uint *)(param_1 + 0x38) & 8;
              if (uVar17 != 0) goto LAB_00114663;
              goto LAB_00114b34;
            }
            bVar1 = *(byte *)(param_1 + 0x38);
joined_r0x00114c20:
            if ((bVar1 & 8) != 0) goto LAB_001146f1;
            pcVar15 = "%sfifo (named pipe)";
          }
          goto LAB_00114791;
        }
LAB_00114738:
        *(undefined8 *)(puVar14 + -0x10d0) = 0x114749;
        iVar5 = FUN_00114fd0(param_1,"%ssticky",pcVar9);
        if (iVar5 != -1) {
          uVar7 = param_3->st_mode;
          pcVar9 = extraout_RDX;
          goto LAB_00114752;
        }
      }
      else {
        uVar17 = 1;
        pcVar9 = "";
LAB_0011483d:
        *(undefined8 *)(puVar14 + -0x10d0) = 0x11484e;
        iVar5 = FUN_00114fd0(param_1,"%ssetgid",pcVar9);
        if (iVar5 != -1) {
          uVar7 = param_3->st_mode;
          pcVar9 = extraout_RDX_00;
          goto LAB_0011485b;
        }
      }
    }
    else {
      *(undefined8 *)(puVar14 + -0x10d0) = 0x114928;
      iVar5 = FUN_00114fd0(param_1,"%ssetuid",&DAT_0011ddf7);
      if (iVar5 != -1) {
        uVar7 = param_3->st_mode;
        uVar17 = 2;
        pcVar9 = ", ";
        if ((uVar7 & 0x400) != 0) goto LAB_0011483d;
        uVar17 = 1;
LAB_0011485b:
        if ((uVar7 & 0x200) != 0) {
          uVar17 = uVar17 + 1;
          pcVar9 = ", ";
          goto LAB_00114738;
        }
LAB_00114752:
        uVar7 = uVar7 & 0xf000;
        if (uVar7 != 0x6000) {
          if (uVar7 < 0x6001) {
            if (uVar7 == 0x2000) {
              if ((*(byte *)(param_1 + 0x38) & 8) == 0) {
LAB_00114b34:
                uVar2 = param_3->st_rdev;
                param_2 = (char *)(ulong)((uint)(uVar2 >> 0x20) & 0xfffff000 |
                                         (uint)(uVar2 >> 8) & 0xfff);
                pcVar9 = "";
                if (uVar17 != 0) {
                  pcVar9 = ", ";
                }
                pcVar15 = (char *)(ulong)((uint)uVar2 & 0xff | (uint)((uVar2 >> 0x14) << 8));
                pcVar11 = "%scharacter special (%ld/%ld)";
                goto LAB_00114af0;
              }
              goto LAB_001148ed;
            }
            pcVar9 = ", ";
            if (uVar7 == 0x4000) goto LAB_00114787;
            if (uVar7 == 0x1000) {
              pcVar9 = ", ";
              bVar1 = *(byte *)(param_1 + 0x38);
              goto joined_r0x00114c20;
            }
          }
          else {
            if (uVar7 == 0xa000) goto LAB_00114963;
            pcVar9 = ", ";
            if (uVar7 == 0xc000) {
LAB_001148b9:
              pcVar15 = "%ssocket";
              goto LAB_00114791;
            }
            if (uVar7 == 0x8000) {
              if ((*(byte *)(param_1 + 0x38) & 8) == 0) {
                if (param_3->st_size == 0) goto LAB_00114c10;
                if (uVar17 == 0) goto LAB_00114663;
              }
              goto LAB_001148ed;
            }
          }
LAB_00114a50:
          *(undefined8 *)(puVar14 + -0x10d0) = 0x114a63;
          FUN_00114dc0(param_1,0,"invalid mode 0%o");
          uVar16 = 0xffffffff;
          goto LAB_00114663;
        }
        if ((*(byte *)(param_1 + 0x38) & 8) != 0) {
LAB_001148ed:
          *(undefined8 *)(puVar14 + -0x10d0) = 0x114901;
          iVar5 = FUN_00114fd0(param_1," ",pcVar9);
          uVar16 = -(uint)(iVar5 == -1);
          goto LAB_00114663;
        }
LAB_00114ba1:
        uVar2 = param_3->st_rdev;
        param_2 = (char *)(ulong)((uint)(uVar2 >> 0x20) & 0xfffff000 | (uint)(uVar2 >> 8) & 0xfff);
        pcVar9 = "";
        if (uVar17 != 0) {
          pcVar9 = ", ";
        }
        pcVar15 = (char *)(ulong)((uint)uVar2 & 0xff | (uint)((uVar2 >> 0x14) << 8));
        pcVar11 = "%sblock special (%ld/%ld)";
LAB_00114af0:
        *(undefined8 *)(puVar14 + -0x10d0) = 0x114afa;
        iVar5 = FUN_00114fd0(param_1,pcVar11,param_2);
        if (iVar5 == -1) goto LAB_001147a4;
        goto LAB_001146f1;
      }
    }
  }
  else {
    uVar6 = uVar7 & 0xf000;
    if (uVar6 == 0x6000) {
      if ((*(byte *)(param_1 + 0x38) & 8) != 0) goto LAB_00114663;
      pcVar9 = "blockdevice";
LAB_001146de:
      *(undefined8 *)(puVar14 + -0x10d0) = 0x1146e8;
      iVar5 = FUN_00114530(param_1,uVar13,pcVar9);
    }
    else {
      if (uVar6 < 0x6001) {
        if (uVar6 == 0x2000) {
          if ((*(byte *)(param_1 + 0x38) & 8) != 0) goto LAB_00114663;
          pcVar9 = "chardevice";
        }
        else {
          pcVar9 = "directory";
          if (uVar6 != 0x4000) {
            if (uVar6 != 0x1000) goto LAB_00114a50;
            if ((*(byte *)(param_1 + 0x38) & 8) != 0) goto LAB_001146f1;
            pcVar9 = "fifo";
          }
        }
        goto LAB_001146de;
      }
      uVar17 = uVar16;
      if (uVar6 == 0xa000) {
LAB_00114963:
        pcVar9 = puVar14 + -0x1028;
        *(undefined8 *)(puVar14 + -0x10d0) = 0x11497b;
        sVar10 = readlink(param_2,pcVar9,0x1fff);
        if (sVar10 < 1) {
          if ((*(byte *)(param_1 + 0x39) & 2) != 0) {
            *(undefined8 *)(puVar14 + -0x10d0) = 0x114d5c;
            piVar8 = __errno_location();
            iVar5 = *piVar8;
            *(undefined8 *)(puVar14 + -0x10d0) = 0x114d72;
            FUN_00114dc0(param_1,iVar5,"unreadable symlink `%s\'");
            goto LAB_001147a4;
          }
          if (uVar13 == 0) {
            *(undefined8 *)(puVar14 + -0x10d0) = 0x114ac7;
            piVar8 = __errno_location();
            iVar5 = *piVar8;
            *(undefined8 *)(puVar14 + -0x10d0) = 0x114ace;
            pcVar15 = strerror(iVar5);
            pcVar9 = "";
            pcVar11 = "%sunreadable symlink `%s\' (%s)";
            if (uVar17 != 0) {
              pcVar9 = ", ";
            }
            goto LAB_00114af0;
          }
LAB_00114c04:
          pcVar9 = "symlink";
          goto LAB_001146de;
        }
        puVar14[sVar10 + -0x1028] = 0;
        if (puVar14[-0x1028] == '/') {
          *(undefined8 *)(puVar14 + -0x10d0) = 0x114cc7;
          iVar5 = __xstat(1,pcVar9,(struct stat *)(puVar14 + -0x10b8));
joined_r0x00114cc9:
          if (iVar5 < 0) {
            *(undefined8 *)(puVar14 + -0x10d0) = 0x114cd0;
            piVar8 = __errno_location();
            iVar5 = *piVar8;
            *(undefined8 *)(puVar14 + -0x10d0) = 0x114cdd;
            uVar16 = FUN_00114480(param_1,iVar5,pcVar9);
            goto LAB_00114663;
          }
          uVar16 = *(uint *)(param_1 + 0x38) & 2;
          if (uVar16 != 0) {
            *(uint *)(param_1 + 0x38) = uVar16;
            *(undefined8 *)(puVar14 + -0x10d0) = 0x114cf3;
            lVar12 = magic_file(param_1,pcVar9);
            *(uint *)(param_1 + 0x38) = *(uint *)(param_1 + 0x38) | 2;
            if (lVar12 != 0) goto LAB_001146f1;
            goto LAB_001147a4;
          }
          if (uVar13 != 0) goto LAB_00114c04;
          pcVar15 = "";
          pcVar11 = "%ssymbolic link to %s";
          if (uVar17 != 0) {
            pcVar15 = ", ";
          }
        }
        else {
          *(undefined8 *)(puVar14 + -0x10d0) = 0x1149a7;
          pcVar11 = strrchr(param_2,0x2f);
          pcVar15 = pcVar9;
          if (pcVar11 == (char *)0x0) {
LAB_00114c6e:
            *(undefined8 *)(puVar14 + -0x10d0) = 0x114c7d;
            iVar5 = __xstat(1,pcVar15,(struct stat *)(puVar14 + -0x10b8));
            goto joined_r0x00114cc9;
          }
          if ((long)pcVar11 - (long)param_2 < 0x2000) {
            *(undefined **)(puVar14 + -0x10c0) = puVar14 + 0xfe8;
            *(undefined8 *)(puVar14 + -0x10d0) = 0x114c48;
            FUN_00119e40(puVar14 + 0xfe8,param_2,0x4004);
            uVar3 = *(undefined8 *)(puVar14 + -0x10c0);
            puVar14[((long)pcVar11 - (long)param_2) + 0xfe9] = 0;
            *(undefined8 *)(puVar14 + -0x10d0) = 0x114c66;
            FUN_00119ec0(uVar3,pcVar9,0x4004);
            pcVar15 = *(char **)(puVar14 + -0x10c0);
            goto LAB_00114c6e;
          }
          if ((*(byte *)(param_1 + 0x39) & 2) != 0) {
            uVar16 = 0xffffffff;
            *(undefined8 *)(puVar14 + -0x10d0) = 0x114d4d;
            FUN_00114dc0(param_1,0,"path too long: `%s\'");
            goto LAB_00114663;
          }
          pcVar9 = "x-path-too-long";
          if (uVar13 != 0) goto LAB_001146de;
          pcVar15 = "";
          pcVar11 = "%spath too long: `%s\'";
          pcVar9 = param_2;
          if (uVar17 != 0) {
            pcVar15 = ", ";
          }
        }
        *(undefined8 *)(puVar14 + -0x10d0) = 0x114a04;
        iVar5 = FUN_00114fd0(param_1,pcVar11,pcVar9);
      }
      else {
        pcVar9 = "socket";
        if (uVar6 == 0xc000) goto LAB_001146de;
LAB_001147b0:
        if ((uVar7 & 0xf000) != 0x8000) goto LAB_00114a50;
        if (((*(byte *)(param_1 + 0x38) & 8) != 0) || (param_3->st_size != 0)) goto LAB_00114663;
        pcVar9 = "";
        if (uVar13 != 0) {
          pcVar9 = "x-empty";
          goto LAB_001146de;
        }
LAB_00114c10:
        pcVar15 = "%sempty";
LAB_00114791:
        *(undefined8 *)(puVar14 + -0x10d0) = 0x11479b;
        iVar5 = FUN_00114fd0(param_1,pcVar15,pcVar9);
      }
    }
    if (iVar5 != -1) {
LAB_001146f1:
      uVar16 = 1;
      goto LAB_00114663;
    }
  }
LAB_001147a4:
  uVar16 = 0xffffffff;
LAB_00114663:
  if (*(long *)(puVar14 + 0x4ff0) == *(long *)(in_FS_OFFSET + 0x28)) {
    return uVar16;
  }
                    // WARNING: Subroutine does not return
  *(undefined8 *)(puVar14 + -0x10d0) = 0x114d57;
  __stack_chk_fail();
}



void FUN_00114d90(void)

{
                    // WARNING: Subroutine does not return
  __assert_fail("rx->rc == 0","funcs.c",0x1fe,"file_regexec");
}



void FUN_00114dc0(long param_9,int param_10,undefined8 param_11)
{
  char in_AL;
  char *pcVar1;
  long in_FS_OFFSET;
  undefined4 local_e8;
  undefined4 local_e4;
  undefined *local_e0;
  undefined *local_d8;
  long local_d0;
  undefined local_c8 [24];
  local_d0 = *(long *)(in_FS_OFFSET + 0x28);
  local_e0 = &stack0x00000008;
  local_e8 = 0x18;
  local_d8 = local_c8;
  local_e4 = 0x30;
  if ((*(byte *)(param_9 + 0x3c) & 1) == 0) {
    if ((*(char **)(param_9 + 0x20) != (char *)0x0) && (**(char **)(param_9 + 0x20) != '\0')) {
      FUN_00114fd0(param_9," ", "");
    }
    FUN_00114ee0(param_9,param_11,&local_e8);
    if (0 < param_10) {
      pcVar1 = strerror(param_10);
      FUN_00114fd0(param_9," (%s)",pcVar1);
    }
    *(uint *)(param_9 + 0x3c) = *(uint *)(param_9 + 0x3c) | 1;
    *(int *)(param_9 + 0x34) = param_10;
  }
  if (local_d0 == *(long *)(in_FS_OFFSET + 0x28)) {
    return;
  }
                    // WARNING: Subroutine does not return
  __stack_chk_fail();
}



undefined4 FUN_00114ee0(long param_1,undefined8 param_2,undefined8 param_3)

{
  int iVar1;
  int *piVar2;
  undefined4 uVar3;
  long in_FS_OFFSET;
  void *local_30;
  void *local_28;
  long local_20;
  
  local_20 = *(long *)(in_FS_OFFSET + 0x28);
  if ((*(uint *)(param_1 + 0x3c) & 1) != 0) {
    uVar3 = 0;
    goto LAB_00114f09;
  }
  iVar1 = __vasprintf_chk(&local_30,1,param_2,param_3);
  if (iVar1 < 0) {
LAB_00114f99:
    piVar2 = __errno_location();
    uVar3 = 0xffffffff;
    FUN_00114dc0(param_1,*piVar2,"vasprintf failed");
  }
  else {
    if (*(long *)(param_1 + 0x20) != 0) {
      iVar1 = __asprintf_chk(&local_28,1,&DAT_0011e898);
      free(local_30);
      if (iVar1 < 0) goto LAB_00114f99;
      free(*(void **)(param_1 + 0x20));
      local_30 = local_28;
    }
    *(void **)(param_1 + 0x20) = local_30;
    uVar3 = 0;
  }
LAB_00114f09:
  if (local_20 == *(long *)(in_FS_OFFSET + 0x28)) {
    return uVar3;
  }
                    // WARNING: Subroutine does not return
  __stack_chk_fail();
}



int FUN_00114fd0(undefined8 param_9,undefined8 param_10,undefined8 param_13)

{
  char in_AL;
  long in_FS_OFFSET;
  undefined4 local_d8;
  undefined4 local_d4;
  undefined *local_d0;
  undefined *local_c8;
  long local_c0;
  undefined local_b8 [16];
  undefined8 local_a0;

  local_c0 = *(long *)(in_FS_OFFSET + 0x28);
  local_d0 = &stack0x00000008;
  local_d8 = 0x10;
  local_c8 = local_b8;
  local_d4 = 0x30;
  FUN_00114ee0(param_9,param_10,&local_d8);
  if (local_c0 == *(long *)(in_FS_OFFSET + 0x28)) {
    return 0;
  }
                    // WARNING: Subroutine does not return
  __stack_chk_fail();
}



undefined8 FUN_00115090(undefined8 param_1,undefined4 *param_2)

{
  int iVar1;
  
  iVar1 = FUN_00114fd0(param_1,"",&DAT_0011ce1b);
  if (iVar1 == -1) {
    *param_2 = 0xffffffff;
  }
  return 0;
}



void FUN_001150c0(long param_9,undefined8 param_10)

{
  long lVar1;
  char *__ptr;
  char in_AL;
  long in_FS_OFFSET;
  undefined4 local_e8;
  undefined4 local_e4;
  undefined *local_e0;
  undefined *local_d8;
  long local_d0;
  undefined local_c8 [16];

  local_d0 = *(long *)(in_FS_OFFSET + 0x28);
  local_e0 = &stack0x00000008;
  local_e8 = 0x10;
  local_d8 = local_c8;
  local_e4 = 0x30;

  if ((*(byte *)(param_9 + 0x3c) & 1) == 0) {
    lVar1 = *(long *)(param_9 + 0x48);
    __ptr = *(char **)(param_9 + 0x20);
    if (lVar1 != 0) {
      free(__ptr);
      *(undefined8 *)(param_9 + 0x20) = 0;
      FUN_00114fd0(param_9,"line %zu:",lVar1);
      __ptr = *(char **)(param_9 + 0x20);
    }
    if ((__ptr != (char *)0x0) && (*__ptr != '\0')) {
      FUN_00114fd0(param_9," ", "");
    }
    FUN_00114ee0(param_9,param_10,&local_e8);
    *(uint *)(param_9 + 0x3c) = *(uint *)(param_9 + 0x3c) | 1;
    *(undefined4 *)(param_9 + 0x34) = 0;
  }
  if (local_d0 != *(long *)(in_FS_OFFSET + 0x28)) {
                    // WARNING: Subroutine does not return
    __stack_chk_fail();
  }
  return;
}



void FUN_00115200(undefined8 param_1,undefined8 param_2)

{
  int *piVar1;
  
  piVar1 = __errno_location();
  FUN_00114dc0(param_1,*piVar1,"cannot allocate %zu bytes");
  return;
}



void FUN_00115240(undefined8 param_1)

{
  int *piVar1;
  
  piVar1 = __errno_location();
  FUN_00114dc0(param_1,*piVar1,"error seeking");
  return;
}



void FUN_00115270(undefined8 param_1)

{
  int *piVar1;
  
  piVar1 = __errno_location();
  FUN_00114dc0(param_1,*piVar1,"error reading");
  return;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

int FUN_001152a0(long param_1,int param_2,undefined8 param_3,undefined8 param_4,ulong param_5)

{
  int iVar1;
  int iVar2;
  undefined4 uVar3;
  uint uVar4;
  char *pcVar5;
  char *pcVar6;
  long in_FS_OFFSET;
  int local_6c;
  void *local_68;
  undefined local_60 [8];
  undefined8 local_58;
  char *local_50;
  undefined8 local_48;
  long local_40;
  
  uVar4 = *(uint *)(param_1 + 0x38);
  local_40 = *(long *)(in_FS_OFFSET + 0x28);
  local_6c = 0;
  local_68 = (void *)0x0;
  local_58 = 0;
  local_50 = "binary";
  local_48 = 0;
  if (param_5 == 0) {
    pcVar5 = "empty";
    pcVar6 = "application/x-empty";
LAB_001153f3:
    if ((uVar4 & 0x410) == 0) {
      pcVar6 = "UNKNUNKN";
      if ((uVar4 & 0x800) == 0) {
        pcVar6 = pcVar5;
        if ((uVar4 & 0x1000000) == 0) goto LAB_0011548f;
        pcVar6 = "???";
      }
      iVar1 = FUN_00114fd0(param_1,"", pcVar6);
joined_r0x0011551c:
      if (iVar1 == -1) {
        local_6c = -1;
      }
      uVar4 = *(uint *)(param_1 + 0x38);
      iVar1 = 1;
      goto LAB_001154b6;
    }
    if ((uVar4 & 0x10) != 0) {
LAB_0011548f:
      iVar1 = FUN_00114fd0(param_1,"%s",pcVar6);
      goto joined_r0x0011551c;
    }
    iVar1 = 1;
    if ((uVar4 & 0x400) == 0) goto LAB_0011542e;
  }
  else {
    if (param_5 == 1) {
      pcVar5 = "very short file (no magic)";
      pcVar6 = "application/octet-stream";
      goto LAB_001153f3;
    }
    uVar3 = 0;
    if ((uVar4 & 0x200000) == 0) {
      uVar3 = FUN_0010e5b0(param_1,param_4,param_5,&local_68,local_60,&local_58,&local_50,&local_48)
      ;
      uVar4 = *(uint *)(param_1 + 0x38);
    }
    if ((uVar4 & 0x1000) == 0) {
      iVar1 = FUN_0010f080(param_1,param_2,param_3,param_4,param_5);
      if ((*(byte *)(param_1 + 0x38) & 1) != 0) {
        __fprintf_chk(_stderr,1,"[try zmagic %d]\n",iVar1);
      }
      if (iVar1 != 0) goto LAB_0011542e;
      uVar4 = *(uint *)(param_1 + 0x38);
    }
    iVar1 = 0;
    if ((uVar4 & 0x2000) == 0) {
      iVar1 = FUN_0010fd40(param_1,param_4,param_5);
      uVar4 = *(uint *)(param_1 + 0x38);
      if ((uVar4 & 1) != 0) {
        __fprintf_chk(_stderr,1,"[try tar %d]\n",iVar1);
        uVar4 = *(uint *)(param_1 + 0x38);
      }
      if (iVar1 == 0) goto LAB_0011533a;
      if ((uVar4 & 0x20) != 0) {
        iVar2 = FUN_00115090(param_1,&local_6c);
        uVar4 = *(uint *)(param_1 + 0x38);
        if (iVar2 == 0) goto LAB_0011533a;
      }
      goto LAB_001154b6;
    }
LAB_0011533a:
    if ((uVar4 & 0x40000) == 0) {
      iVar1 = FUN_00119180(param_1,param_2,param_4,param_5);
      uVar4 = *(uint *)(param_1 + 0x38);
      if ((uVar4 & 1) != 0) {
        __fprintf_chk(_stderr,1,"[try cdf %d]\n",iVar1);
        uVar4 = *(uint *)(param_1 + 0x38);
      }
      if (iVar1 == 0) goto LAB_00115346;
      if ((uVar4 & 0x20) != 0) {
        iVar2 = FUN_00115090(param_1,&local_6c);
        uVar4 = *(uint *)(param_1 + 0x38);
        if (iVar2 == 0) goto LAB_00115346;
      }
    }
    else {
LAB_00115346:
      if ((uVar4 & 0x4000) == 0) {
        iVar1 = FUN_0010c460(param_1,param_4,param_5,0,0,0x20,uVar3);
        uVar4 = *(uint *)(param_1 + 0x38);
      }
      if ((uVar4 & 1) != 0) {
        __fprintf_chk(_stderr,1,"[try softmagic %d]\n",iVar1);
        uVar4 = *(uint *)(param_1 + 0x38);
      }
      if (iVar1 == 0) {
LAB_001153d9:
        pcVar5 = "data";
        pcVar6 = "application/octet-stream";
        if ((uVar4 & 0x20000) != 0) goto LAB_001153f3;
        iVar1 = FUN_0010e310(param_1,param_4,param_5,uVar3);
        uVar4 = *(uint *)(param_1 + 0x38);
        if ((uVar4 & 1) != 0) {
          __fprintf_chk(_stderr,1,"[try ascmagic %d]\n",iVar1);
          uVar4 = *(uint *)(param_1 + 0x38);
        }
        if (iVar1 == 0) {
LAB_0011563e:
          pcVar5 = "data";
          pcVar6 = "application/octet-stream";
          goto LAB_001153f3;
        }
        if ((uVar4 & 0x20) != 0) {
          iVar2 = FUN_00115090(param_1,&local_6c);
          uVar4 = *(uint *)(param_1 + 0x38);
          if (iVar2 == 0) goto LAB_0011563e;
        }
      }
      else {
        if (((((uVar4 & 0x10000) == 0) && (iVar1 == 1)) && (5 < param_5)) && (param_2 != -1)) {
          iVar1 = FUN_001133b0(param_1,param_2,param_4,param_5);
          uVar4 = *(uint *)(param_1 + 0x38);
          if ((uVar4 & 1) != 0) {
            __fprintf_chk(_stderr,1,"[try elf %d]\n",iVar1);
            uVar4 = *(uint *)(param_1 + 0x38);
          }
        }
        if ((uVar4 & 0x20) != 0) {
          iVar2 = FUN_00115090(param_1,&local_6c);
          uVar4 = *(uint *)(param_1 + 0x38);
          if (iVar2 == 0) goto LAB_001153d9;
        }
      }
    }
LAB_001154b6:
    if ((uVar4 & 0x400) == 0) goto LAB_0011542e;
    if (((uVar4 & 0x10) != 0) && (iVar2 = FUN_00114fd0(param_1,"; charset=", ""), iVar2 == -1)) {
      local_6c = -1;
    }
  }
  iVar2 = FUN_00114fd0(param_1,"%s",local_50);
  if (iVar2 == -1) {
    local_6c = -1;
  }
LAB_0011542e:
  free(local_68);
  if (local_6c != 0) {
    iVar1 = local_6c;
  }
  if (local_40 == *(long *)(in_FS_OFFSET + 0x28)) {
    return iVar1;
  }
                    // WARNING: Subroutine does not return
  __stack_chk_fail();
}



undefined8 FUN_001157e0(long *param_1)

{
  if (*param_1 != 0) {
    if ((void *)param_1[4] != (void *)0x0) {
      free((void *)param_1[4]);
      param_1[4] = 0;
    }
    if ((void *)param_1[5] != (void *)0x0) {
      free((void *)param_1[5]);
      param_1[5] = 0;
    }
    *(uint *)((long)param_1 + 0x3c) = *(uint *)((long)param_1 + 0x3c) & 0xfffffffe;
    *(undefined4 *)((long)param_1 + 0x34) = 0xffffffff;
    return 0;
  }
  FUN_00114dc0(param_1,0,"no magic files loaded");
  return 0xffffffff;
}



char * FUN_00115840(long param_1)

{
  size_t __size;
  int iVar1;
  size_t sVar2;
  undefined *__dest;
  long *plVar3;
  undefined *puVar4;
  byte *pbVar5;
  byte *pbVar6;
  byte *pbVar7;
  char *__s;
  byte bVar8;
  byte *pbVar9;
  long in_FS_OFFSET;
  wchar_t local_4c;
  mbstate_t local_48;
  long local_40;
  
  local_40 = *(long *)(in_FS_OFFSET + 0x28);
  if ((*(byte *)(param_1 + 0x3c) & 1) == 0) {
    __s = *(char **)(param_1 + 0x20);
    if (((*(byte *)(param_1 + 0x39) & 1) == 0) && (__s != (char *)0x0)) {
      sVar2 = strlen(__s);
      if (sVar2 < 0x4000000000000000) {
        __size = sVar2 * 4 + 1;
        __dest = (undefined *)realloc(*(void **)(param_1 + 0x28),__size);
        if (__dest == (undefined *)0x0) {
          FUN_00115200(param_1,__size);
          __s = (char *)0x0;
        }
        else {
          local_48.__count = 0;
          local_48.__value = (_union_27)0x0;
          pbVar5 = *(byte **)(param_1 + 0x20);
          *(undefined **)(param_1 + 0x28) = __dest;
          pbVar6 = pbVar5 + sVar2;
          if (pbVar5 < pbVar6) {
            do {
              while( true ) {
                sVar2 = mbrtowc(&local_4c,(char *)pbVar5,(long)pbVar6 - (long)pbVar5,&local_48);
                if (0xfffffffffffffffd < sVar2) {
                  *__dest = 0;
                  pbVar6 = *(byte **)(param_1 + 0x20);
                  pbVar5 = *(byte **)(param_1 + 0x28);
                  bVar8 = *pbVar6;
                  if (bVar8 != 0) {
                    plVar3 = (long *)FUN_00104d70();
                    do {
                      pbVar7 = pbVar6 + 1;
                      if ((*(byte *)(*plVar3 + 1 + (ulong)bVar8 * 2) & 0x40) == 0) {
                        *pbVar5 = 0x5c;
                        pbVar5[1] = (*pbVar6 >> 6) + 0x30;
                        pbVar5[2] = ((byte)((uint)(int)(char)*pbVar6 >> 3) & 7) + 0x30;
                        pbVar5[3] = (*pbVar6 & 7) + 0x30;
                        bVar8 = *pbVar7;
                        pbVar5 = pbVar5 + 4;
                      }
                      else {
                        *pbVar5 = bVar8;
                        bVar8 = *pbVar7;
                        pbVar5 = pbVar5 + 1;
                      }
                      pbVar6 = pbVar7;
                    } while (bVar8 != 0);
                  }
                  *pbVar5 = 0;
                  __s = *(char **)(param_1 + 0x28);
                  goto LAB_001159c0;
                }
                iVar1 = iswprint(local_4c);
                if (iVar1 == 0) break;
                memcpy(__dest,pbVar5,sVar2);
                __dest = __dest + sVar2;
                pbVar5 = pbVar5 + sVar2;
LAB_00115914:
                if (pbVar6 <= pbVar5) goto LAB_001159a9;
              }
              pbVar7 = pbVar5 + sVar2;
              puVar4 = __dest;
              if (sVar2 == 0) goto LAB_00115914;
              do {
                *puVar4 = 0x5c;
                pbVar9 = pbVar5 + 1;
                puVar4[1] = (*pbVar5 >> 6) + 0x30;
                puVar4[2] = ((byte)((uint)(int)(char)*pbVar5 >> 3) & 7) + 0x30;
                puVar4[3] = (*pbVar5 & 7) + 0x30;
                puVar4 = puVar4 + 4;
                pbVar5 = pbVar9;
              } while (pbVar7 != pbVar9);
              __dest = __dest + sVar2 * 4;
            } while (pbVar9 < pbVar6);
          }
LAB_001159a9:
          *__dest = 0;
          __s = *(char **)(param_1 + 0x28);
        }
      }
      else {
        __s = (char *)0x0;
        FUN_00115200(param_1,sVar2);
      }
    }
  }
  else {
    __s = (char *)0x0;
  }
LAB_001159c0:
  if (local_40 == *(long *)(in_FS_OFFSET + 0x28)) {
    return __s;
  }
                    // WARNING: Subroutine does not return
  __stack_chk_fail();
}



undefined8 FUN_00115ad0(long param_1,uint param_2)

{
  void *__ptr;
  ulong uVar1;
  size_t __size;
  
  uVar1 = (ulong)param_2;
  __ptr = *(void **)(param_1 + 0x18);
  if (*(ulong *)(param_1 + 0x10) <= uVar1) {
    *(ulong *)(param_1 + 0x10) = (ulong)(param_2 + 0x14);
    __size = (ulong)(param_2 + 0x14) << 4;
    if (__ptr == (void *)0x0) {
      __ptr = malloc(__size);
    }
    else {
      __ptr = realloc(__ptr,__size);
    }
    *(void **)(param_1 + 0x18) = __ptr;
    if (__ptr == (void *)0x0) {
      FUN_00115200(param_1,__size);
      return 0xffffffff;
    }
  }
  *(undefined8 *)((long)__ptr + uVar1 * 0x10 + 4) = 0;
  *(undefined4 *)((long)__ptr + uVar1 * 0x10 + 0xc) = 0;
  return 0;
}



size_t FUN_00115b50(long param_1)

{
  size_t sVar1;
  
  if (*(char **)(param_1 + 0x20) != (char *)0x0) {
    sVar1 = strlen(*(char **)(param_1 + 0x20));
    return sVar1;
  }
  return 0;
}



int FUN_00115b70(undefined8 *param_1,char *param_2,int param_3)

{
  int iVar1;
  __locale_t p_Var2;
  
  p_Var2 = newlocale(1,"C",(__locale_t)0x0);
  param_1[2] = p_Var2;
  if (p_Var2 == (__locale_t)0x0) {
                    // WARNING: Subroutine does not return
    __assert_fail("rx->c_lc_ctype != NULL","funcs.c",0x1ef,"file_regcomp");
  }
  p_Var2 = uselocale(p_Var2);
  param_1[1] = p_Var2;
  if (p_Var2 != (__locale_t)0x0) {
    *param_1 = param_2;
    iVar1 = regcomp((regex_t *)(param_1 + 4),param_2,param_3);
    *(int *)(param_1 + 3) = iVar1;
    return 0;
  }
                    // WARNING: Subroutine does not return
  __assert_fail("rx->old_lc_ctype != NULL","funcs.c",0x1f1,"file_regcomp");
}



void FUN_00115c10(long param_1,char *param_2,size_t param_3,regmatch_t *param_4,int param_5)

{
  if (*(int *)(param_1 + 0x18) == 0) {
    regexec((regex_t *)(param_1 + 0x20),param_2,param_3,param_4,param_5);
    return;
  }
  FUN_00114d90();
  if (*(int *)(param_1 + 0x18) == 0) {
    regfree((regex_t *)(param_1 + 0x20));
  }
  uselocale(*(__locale_t *)(param_1 + 8));
  freelocale(*(__locale_t *)(param_1 + 0x10));
  return;
}



void FUN_00115c30(long param_1)

{
  if (*(int *)(param_1 + 0x18) == 0) {
    regfree((regex_t *)(param_1 + 0x20));
  }
  uselocale(*(__locale_t *)(param_1 + 8));
  freelocale(*(__locale_t *)(param_1 + 0x10));
  return;
}



void FUN_00115c70(undefined8 *param_1,int param_2,undefined8 param_3)

{
  long in_FS_OFFSET;
  char acStack_238 [520];
  long local_30;
  
  local_30 = *(long *)(in_FS_OFFSET + 0x28);
  regerror(param_2,(regex_t *)(param_1 + 4),acStack_238,0x200);
  FUN_001150c0(param_3,"regex error %d for `%s\', (%s)");
  if (local_30 == *(long *)(in_FS_OFFSET + 0x28)) {
    return;
  }
                    // WARNING: Subroutine does not return
  __stack_chk_fail();
}



int FUN_00115d00(long param_1,undefined8 param_2,undefined8 param_3)

{
  int iVar1;
  char *__string;
  undefined1 *puVar2;
  int iVar3;
  long in_FS_OFFSET;
  regmatch_t local_b0;
  undefined local_a8 [24];
  int local_90;
  regex_t local_88;
  long local_40;
  
  local_40 = *(long *)(in_FS_OFFSET + 0x28);
  iVar1 = FUN_00115b70(local_a8,param_2,1);
  if (iVar1 == 0) {
    __string = *(char **)(param_1 + 0x20);
    if (local_90 == 0) {
      iVar3 = 0;
      do {
        iVar1 = regexec(&local_88,__string,1,&local_b0,0);
        if (iVar1 != 0) goto LAB_00115ddb;
        puVar2 = &DAT_0011ddf7;
        *(undefined *)(*(long *)(param_1 + 0x20) + (long)local_b0.rm_so) = 0;
        if (local_b0.rm_eo != 0) {
          puVar2 = (undefined1 *)((long)local_b0.rm_eo + *(long *)(param_1 + 0x20));
        }
        iVar1 = FUN_00114fd0(param_1,param_3,puVar2);
        if (iVar1 == -1) {
          iVar3 = -1;
          goto LAB_00115ddb;
        }
        __string = *(char **)(param_1 + 0x20);
        iVar3 = iVar3 + 1;
      } while (local_90 == 0);
    }
    FUN_00114d90();
  }
  else {
    iVar3 = -1;
    FUN_00115c70(local_a8,iVar1,param_1);
LAB_00115ddb:
    FUN_00115c30(local_a8);
    if (local_40 == *(long *)(in_FS_OFFSET + 0x28)) {
      return iVar3;
    }
  }
                    // WARNING: Subroutine does not return
  __stack_chk_fail();
}



undefined8 * FUN_00115e40(long param_1)

{
  undefined4 uVar1;
  undefined8 uVar2;
  undefined8 *puVar3;
  
  if ((*(byte *)(param_1 + 0x3c) & 1) == 0) {
    puVar3 = (undefined8 *)malloc(0x10);
    if (puVar3 != (undefined8 *)0x0) {
      uVar2 = *(undefined8 *)(param_1 + 0x20);
      *(undefined8 *)(param_1 + 0x20) = 0;
      *puVar3 = uVar2;
      uVar1 = *(undefined4 *)(param_1 + 0x30);
      *(undefined4 *)(param_1 + 0x30) = 0;
      *(undefined4 *)(puVar3 + 1) = uVar1;
    }
    return puVar3;
  }
  return (undefined8 *)0x0;
}



undefined8 FUN_00115e90(long param_1,undefined8 *param_2)

{
  undefined4 uVar1;
  undefined8 uVar2;
  
  if ((*(byte *)(param_1 + 0x3c) & 1) == 0) {
    uVar1 = *(undefined4 *)(param_2 + 1);
    uVar2 = *(undefined8 *)(param_1 + 0x20);
    *(void **)(param_1 + 0x20) = (void *)*param_2;
    *(undefined4 *)(param_1 + 0x30) = uVar1;
    free(param_2);
    return uVar2;
  }
  free((void *)*param_2);
  free(param_2);
  return 0;
}



byte * FUN_00115ef0(byte *param_1,long param_2,byte *param_3)

{
  byte *pbVar1;
  byte bVar2;
  long *plVar3;
  byte *pbVar4;
  byte *pbVar5;
  
  pbVar1 = param_1 + param_2 + -1;
  pbVar5 = param_1;
  if (param_1 < pbVar1) {
    do {
      while( true ) {
        bVar2 = *param_3;
        if (bVar2 == 0) goto LAB_00115f8f;
        plVar3 = (long *)FUN_00104d70();
        if ((*(byte *)(*plVar3 + 1 + (ulong)bVar2 * 2) & 0x40) == 0) break;
        *pbVar5 = bVar2;
        pbVar5 = pbVar5 + 1;
        param_3 = param_3 + 1;
        if (pbVar1 <= pbVar5) goto LAB_00115f8f;
      }
      if (pbVar1 + -3 <= pbVar5) break;
      *pbVar5 = 0x5c;
      pbVar4 = pbVar5 + 4;
      pbVar5[1] = (*param_3 >> 6) + 0x30;
      pbVar5[2] = (*param_3 >> 3 & 7) + 0x30;
      pbVar5[3] = (*param_3 & 7) + 0x30;
      pbVar5 = pbVar4;
      param_3 = param_3 + 1;
    } while (pbVar4 < pbVar1);
  }
LAB_00115f8f:
  *pbVar5 = 0;
  return param_1;
}



ulong FUN_00115fb0(long param_1,ulong *param_2,ulong param_3)

{
  byte *pbVar1;
  byte bVar2;
  ulong uVar3;
  ulong uVar4;
  ulong uVar5;
  uint uVar6;
  
  uVar3 = *param_2;
  if (param_3 <= uVar3) {
    return 0xffffffff;
  }
  *param_2 = uVar3 + 1;
  bVar2 = *(byte *)(param_1 + uVar3);
  uVar5 = (ulong)bVar2;
  if ((char)bVar2 < '\0') {
    uVar6 = bVar2 & 0x7f;
    if (param_3 <= (ulong)(bVar2 & 0x7f) + uVar3 + 1) {
      return 0xffffffff;
    }
    if ((char)uVar6 != '\0') {
      uVar5 = uVar3 + 2;
      uVar4 = 0;
      do {
        *param_2 = uVar5;
        pbVar1 = (byte *)(param_1 + -1 + uVar5);
        uVar5 = uVar5 + 1;
        uVar4 = uVar4 << 8 | (ulong)*pbVar1;
      } while (uVar5 != uVar3 + 3 + (ulong)(uVar6 - 1 & 0xff));
      return uVar4;
    }
    uVar5 = 0;
  }
  return uVar5;
}



uint FUN_00116030(long param_1,ulong *param_2,ulong param_3)

{
  ulong uVar1;
  byte bVar2;
  uint uVar3;
  ulong uVar4;
  
  uVar1 = *param_2;
  if (uVar1 < param_3) {
    uVar4 = uVar1 + 1;
    *param_2 = uVar4;
    bVar2 = *(byte *)(param_1 + uVar1) & 0x1f;
    if (bVar2 != 0x1f) {
      return (uint)bVar2;
    }
    uVar3 = 0x1f;
    while (uVar4 < param_3) {
      if (-1 < *(char *)(param_1 + uVar4)) {
        return uVar3;
      }
      uVar4 = uVar4 + 1;
      *param_2 = uVar4;
      uVar3 = uVar3 * 0x80 + -0x80 + (uint)*(byte *)(param_1 + -1 + uVar4);
    }
  }
  return 0xffffffff;
}



long FUN_001160a0(long param_1,ushort *param_2,ulong param_3)

{
  int iVar1;
  uint uVar2;
  long lVar3;
  ulong uVar4;
  long in_FS_OFFSET;
  long local_18;
  long local_10;
  
  local_10 = *(long *)(in_FS_OFFSET + 0x28);
  local_18 = 0;
  uVar4 = *(ulong *)(param_1 + 0x58);
  if (*(ulong *)(param_1 + 0x58) == 0) {
    uVar4 = param_3;
  }
  iVar1 = FUN_00116030(*(undefined8 *)(param_1 + 0x50),&local_18,uVar4);
  if (iVar1 != -1) {
    uVar2 = FUN_00115fb0(param_1, param_2, param_3);
    if (uVar2 != 0xffffffff) {
      lVar3 = (ulong)(uint)(*(int *)(param_2 + 6) + *(int *)(param_1 + 0x30)) + local_18;
      local_18 = lVar3;
      if (*param_2 == 0) goto LAB_00116122;
      if ((ulong)uVar2 + lVar3 <= param_3) {
        *(uint *)((ulong)*param_2 * 0x10 + *(long *)(param_1 + 0x18) + -0x10) = uVar2 + (int)lVar3;
        goto LAB_00116122;
      }
    }
  }
  lVar3 = 0xffffffff;
LAB_00116122:
  if (local_10 == *(long *)(in_FS_OFFSET + 0x28)) {
    return lVar3;
  }
                    // WARNING: Subroutine does not return
  __stack_chk_fail();
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

undefined8 FUN_00116150(long param_1,long param_2)

{
  undefined *puVar1;
  byte bVar2;
  long lVar3;
  uint uVar4;
  uint uVar5;
  uint uVar6;
  uint uVar7;
  int iVar8;
  long *plVar9;
  ulong uVar10;
  undefined8 uVar11;
  uint *puVar12;
  uint *puVar13;
  size_t __n;
  byte *pbVar14;
  byte *__s2;
  ulong uVar15;
  undefined *puVar16;
  ulong uVar17;
  long in_FS_OFFSET;
  bool bVar18;
  long local_d0;
  uint local_c8 [34];
  long local_40;
  
  lVar3 = *(long *)(param_1 + 0x50);
  local_40 = *(long *)(in_FS_OFFSET + 0x28);
  local_d0 = 0;
  uVar4 = FUN_00116030(lVar3,&local_d0,*(undefined8 *)(param_1 + 0x58));
  if (uVar4 != 0xffffffff) {
    uVar5 = FUN_00115fb0(param_1, param_2, 0x00);
    uVar17 = (ulong)uVar5;
    if (uVar5 != 0xffffffff) {
      if (uVar4 < 0x1f) {
        FUN_00119e40(local_c8,(&PTR_DAT_001239a0)[uVar4],0x80);
        bVar2 = *(byte *)(param_1 + 0x38);
      }
      else {
        __snprintf_chk(local_c8,0x80,1,0x80,&DAT_0011eddf,uVar4);
        bVar2 = *(byte *)(param_1 + 0x38);
      }
      if ((bVar2 & 1) != 0) {
        __fprintf_chk(_stderr,1,"%s: tag %p got=%s exp=%s\n","der_cmp",lVar3,local_c8,param_2 + 0x20
                     );
      }
      puVar13 = local_c8;
      do {
        puVar12 = puVar13;
        uVar6 = *puVar12 + 0xfefefeff & ~*puVar12;
        uVar7 = uVar6 & 0x80808080;
        puVar13 = puVar12 + 1;
      } while (uVar7 == 0);
      bVar18 = (uVar6 & 0x8080) == 0;
      if (bVar18) {
        uVar7 = uVar7 >> 0x10;
      }
      if (bVar18) {
        puVar13 = (uint *)((long)puVar12 + 6);
      }
      __n = (long)puVar13 + ((-3 - (ulong)CARRY1((byte)uVar7,(byte)uVar7)) - (long)local_c8);
      iVar8 = strncmp((char *)local_c8,(char *)(param_2 + 0x20),__n);
      pbVar14 = (byte *)((char *)(param_2 + 0x20) + __n);
      if (iVar8 == 0) {
LAB_0011624e:
        bVar2 = *pbVar14;
        if (bVar2 != 0) {
          if (bVar2 == 0x3d) {
            __s2 = pbVar14 + 1;
            puVar16 = (undefined *)(lVar3 + local_d0);
            if ((uVar4 < 0x18) && ((1L << ((byte)uVar4 & 0x3f) & 0xc81000U) != 0)) {
              __snprintf_chk(local_c8,0x80,1,0x80,"%.*s",uVar17,puVar16);
            }
            else if (uVar5 != 0) {
              uVar4 = 0;
              puVar1 = puVar16 + (ulong)(uVar5 - 1) + 1;
              do {
                if (uVar4 < 0x7e) {
                  __snprintf_chk((ulong)uVar4 + (long)local_c8,0x80 - (ulong)uVar4,1,
                                 0xffffffffffffffff,&DAT_0011edfd,*puVar16);
                }
                puVar16 = puVar16 + 1;
                uVar4 = uVar4 + 2;
              } while (puVar1 != puVar16);
            }
            if ((*(byte *)(param_1 + 0x38) & 1) != 0) {
              __fprintf_chk(_stderr,1,"%s: data %s %s\n","der_cmp",local_c8,__s2);
            }
            iVar8 = strcmp((char *)local_c8,(char *)__s2);
            if ((iVar8 == 0) || ((*__s2 == 0x78 && (pbVar14[2] == 0)))) {
              FUN_00119e40(param_1 + 0x70,local_c8,0x60);
              uVar11 = 1;
              goto LAB_001162f5;
            }
          }
          else {
            plVar9 = (long *)FUN_00104d70();
            uVar10 = (ulong)bVar2;
            if ((*(byte *)(*plVar9 + 1 + uVar10 * 2) & 8) != 0) goto code_r0x0011641b;
          }
          goto LAB_001163e8;
        }
        uVar11 = 1;
        goto LAB_001162f5;
      }
LAB_001163e8:
      uVar11 = 0;
      goto LAB_001162f5;
    }
  }
  uVar11 = 0xffffffff;
  goto LAB_001162f5;
code_r0x0011641b:
  uVar15 = 0;
  do {
    pbVar14 = pbVar14 + 1;
    uVar15 = (long)(char)uVar10 + -0x30 + uVar15 * 10;
    uVar10 = (ulong)*pbVar14;
  } while ((*(byte *)(*plVar9 + 1 + uVar10 * 2) & 8) != 0);
  if ((*(byte *)(param_1 + 0x38) & 1) != 0) {
    __fprintf_chk(_stderr,1,"%s: len %zu %u\n","der_cmp",uVar15,uVar17);
  }
  if (uVar17 != uVar15) goto code_r0x00116450;
  goto LAB_0011624e;
code_r0x00116450:
  uVar11 = 0;
LAB_001162f5:
  if (local_40 != *(long *)(in_FS_OFFSET + 0x28)) {
                    // WARNING: Subroutine does not return
    __stack_chk_fail();
  }
  return uVar11;
}



size_t FUN_00116500(int *param_1,long param_2,void *param_3,size_t param_4)

{
  size_t sVar1;
  int *piVar2;
  
  if ((*(long *)(param_1 + 2) != 0) && (param_2 + param_4 <= *(ulong *)(param_1 + 4))) {
    memcpy(param_3,(void *)(*(long *)(param_1 + 2) + param_2),param_4);
    return param_4;
  }
  if (*param_1 == -1) {
    piVar2 = __errno_location();
    *piVar2 = 0x16;
    return 0xffffffffffffffff;
  }
  sVar1 = pread(*param_1,param_3,param_4,param_2);
  if (param_4 == sVar1) {
    return sVar1;
  }
  return 0xffffffffffffffff;
}



void FUN_00116580(void)

{
                    // WARNING: Subroutine does not return
  __assert_fail("ss == sst->sst_ss","cdf.c",0x11d,"cdf_check_stream");
}



undefined4 FUN_001165b0(ulong *param_1,long param_2,long param_3,long param_4)

{
  undefined4 uVar1;
  int *piVar2;
  byte bVar3;
  ushort uVar4;
  undefined2 uVar5;
  long in_FS_OFFSET;
  
  uVar5 = (undefined2)((ulong)param_1 >> 0x10);
  uVar4 = (ushort)param_1;
  if (param_1[2] < (ulong)*(uint *)(param_2 + 0x38)) {
    bVar3 = (byte)*(undefined2 *)(param_2 + 0x20);
  }
  else {
    bVar3 = (byte)*(undefined2 *)(param_2 + 0x1e);
  }
  if (param_1[3] == (long)(1 << (bVar3 & 0x1f))) {
    if (((ulong)(param_3 + param_4) < *param_1) ||
       (uVar1 = 0, param_1[3] * param_1[1] < (param_3 + param_4) - *param_1)) {
      piVar2 = __errno_location();
      *piVar2 = 0x16;
      uVar1 = 0xffffffff;
    }
    return uVar1;
  }
  FUN_00116580();
  if (DAT_001244f8 == 0x1020304) {
    uVar4 = uVar4 << 8 | uVar4 >> 8;
  }
  if (*(long *)(in_FS_OFFSET + 0x28) == *(long *)(in_FS_OFFSET + 0x28)) {
    return CONCAT22(uVar5,uVar4);
  }
                    // WARNING: Subroutine does not return
  __stack_chk_fail();
}



ushort FUN_00116630(ushort param_1)

{
  long in_FS_OFFSET;
  
  if (DAT_001244f8 == 0x1020304) {
    param_1 = param_1 << 8 | param_1 >> 8;
  }
  if (*(long *)(in_FS_OFFSET + 0x28) == *(long *)(in_FS_OFFSET + 0x28)) {
    return param_1;
  }
                    // WARNING: Subroutine does not return
  __stack_chk_fail(param_1,0,0);
}



void FUN_00116680(undefined4 param_1,undefined8 param_2)

{
  long in_FS_OFFSET;
  
  if (*(long *)(in_FS_OFFSET + 0x28) == *(long *)(in_FS_OFFSET + 0x28)) {
    return;
  }
                    // WARNING: Subroutine does not return
  __stack_chk_fail(param_1,param_2,0);
}



void FUN_001166d0(undefined8 param_1,undefined8 param_2)

{
  long in_FS_OFFSET;
  
  if (*(long *)(in_FS_OFFSET + 0x28) == *(long *)(in_FS_OFFSET + 0x28)) {
    return;
  }
                    // WARNING: Subroutine does not return
  __stack_chk_fail(param_1,param_2,0);
}



void FUN_00116720(undefined8 *param_1)

{
  undefined4 uVar1;
  long lVar2;
  undefined8 uVar3;
  int iVar4;
  undefined4 uVar5;
  undefined8 *puVar6;
  long in_FS_OFFSET;
  
  iVar4 = DAT_001244f8;
  lVar2 = *(long *)(in_FS_OFFSET + 0x28);
  uVar5 = *(undefined4 *)(param_1 + 9);
  if (DAT_001244f8 == 0x1020304) {
    uVar3 = *param_1;
    *param_1 = CONCAT17((char)uVar3,
                        CONCAT16((char)((ulong)uVar3 >> 8),
                                 CONCAT15((char)((ulong)uVar3 >> 0x10),
                                          CONCAT14((char)((ulong)uVar3 >> 0x18),
                                                   CONCAT13((char)((ulong)uVar3 >> 0x20),
                                                            CONCAT12((char)((ulong)uVar3 >> 0x28),
                                                                     CONCAT11((char)((ulong)uVar3 >>
                                                                                    0x30),
                                                                              (char)((ulong)uVar3 >>
                                                                                    0x38))))))));
    uVar3 = param_1[1];
    param_1[1] = CONCAT17((char)uVar3,
                          CONCAT16((char)((ulong)uVar3 >> 8),
                                   CONCAT15((char)((ulong)uVar3 >> 0x10),
                                            CONCAT14((char)((ulong)uVar3 >> 0x18),
                                                     CONCAT13((char)((ulong)uVar3 >> 0x20),
                                                              CONCAT12((char)((ulong)uVar3 >> 0x28),
                                                                       CONCAT11((char)((ulong)uVar3
                                                                                      >> 0x30),
                                                                                (char)((ulong)uVar3
                                                                                      >> 0x38)))))))
                         );
    uVar3 = param_1[2];
    param_1[2] = CONCAT17((char)uVar3,
                          CONCAT16((char)((ulong)uVar3 >> 8),
                                   CONCAT15((char)((ulong)uVar3 >> 0x10),
                                            CONCAT14((char)((ulong)uVar3 >> 0x18),
                                                     CONCAT13((char)((ulong)uVar3 >> 0x20),
                                                              CONCAT12((char)((ulong)uVar3 >> 0x28),
                                                                       CONCAT11((char)((ulong)uVar3
                                                                                      >> 0x30),
                                                                                (char)((ulong)uVar3
                                                                                      >> 0x38)))))))
                         );
    *(ushort *)(param_1 + 3) =
         CONCAT11((char)*(undefined2 *)(param_1 + 3),
                  (char)((ushort)*(undefined2 *)(param_1 + 3) >> 8));
    *(ushort *)((long)param_1 + 0x1a) =
         CONCAT11((char)*(undefined2 *)((long)param_1 + 0x1a),
                  (char)((ushort)*(undefined2 *)((long)param_1 + 0x1a) >> 8));
    *(ushort *)((long)param_1 + 0x1c) =
         CONCAT11((char)*(undefined2 *)((long)param_1 + 0x1c),
                  (char)((ushort)*(undefined2 *)((long)param_1 + 0x1c) >> 8));
    *(ushort *)((long)param_1 + 0x1e) =
         CONCAT11((char)*(undefined2 *)((long)param_1 + 0x1e),
                  (char)((ushort)*(undefined2 *)((long)param_1 + 0x1e) >> 8));
    *(ushort *)(param_1 + 4) =
         CONCAT11((char)*(undefined2 *)(param_1 + 4),
                  (char)((ushort)*(undefined2 *)(param_1 + 4) >> 8));
    uVar1 = *(undefined4 *)((long)param_1 + 0x2c);
    *(uint *)((long)param_1 + 0x2c) =
         CONCAT13((char)uVar1,
                  CONCAT12((char)((uint)uVar1 >> 8),
                           CONCAT11((char)((uint)uVar1 >> 0x10),(char)((uint)uVar1 >> 0x18))));
    uVar1 = *(undefined4 *)(param_1 + 6);
    *(uint *)(param_1 + 6) =
         CONCAT13((char)uVar1,
                  CONCAT12((char)((uint)uVar1 >> 8),
                           CONCAT11((char)((uint)uVar1 >> 0x10),(char)((uint)uVar1 >> 0x18))));
    uVar1 = *(undefined4 *)(param_1 + 7);
    *(uint *)(param_1 + 7) =
         CONCAT13((char)uVar1,
                  CONCAT12((char)((uint)uVar1 >> 8),
                           CONCAT11((char)((uint)uVar1 >> 0x10),(char)((uint)uVar1 >> 0x18))));
    uVar1 = *(undefined4 *)((long)param_1 + 0x3c);
    *(uint *)((long)param_1 + 0x3c) =
         CONCAT13((char)uVar1,
                  CONCAT12((char)((uint)uVar1 >> 8),
                           CONCAT11((char)((uint)uVar1 >> 0x10),(char)((uint)uVar1 >> 0x18))));
    uVar1 = *(undefined4 *)(param_1 + 8);
    *(uint *)(param_1 + 8) =
         CONCAT13((char)uVar1,
                  CONCAT12((char)((uint)uVar1 >> 8),
                           CONCAT11((char)((uint)uVar1 >> 0x10),(char)((uint)uVar1 >> 0x18))));
    uVar1 = *(undefined4 *)((long)param_1 + 0x44);
    *(uint *)((long)param_1 + 0x44) =
         CONCAT13((char)uVar1,
                  CONCAT12((char)((uint)uVar1 >> 8),
                           CONCAT11((char)((uint)uVar1 >> 0x10),(char)((uint)uVar1 >> 0x18))));
    uVar5 = CONCAT13((char)uVar5,
                     CONCAT12((char)((uint)uVar5 >> 8),
                              CONCAT11((char)((uint)uVar5 >> 0x10),(char)((uint)uVar5 >> 0x18))));
  }
  *(undefined4 *)(param_1 + 9) = uVar5;
  puVar6 = (undefined8 *)((long)param_1 + 0x4c);
  do {
    uVar5 = *(undefined4 *)puVar6;
    if (iVar4 == 0x1020304) {
      uVar5 = CONCAT13((char)uVar5,
                       CONCAT12((char)((uint)uVar5 >> 8),
                                CONCAT11((char)((uint)uVar5 >> 0x10),(char)((uint)uVar5 >> 0x18))));
    }
    *(undefined4 *)puVar6 = uVar5;
    puVar6 = (undefined8 *)((long)puVar6 + 4);
  } while (param_1 + 0x40 != puVar6);
  if (lVar2 == *(long *)(in_FS_OFFSET + 0x28)) {
    return;
  }
                    // WARNING: Subroutine does not return
  __stack_chk_fail();
}



void FUN_00116a10(undefined8 *param_1,undefined8 *param_2)

{
  undefined8 uVar1;
  long lVar2;
  
  *param_1 = *param_2;
  uVar1 = param_2[2];
  param_1[1] = param_2[1];
  param_1[2] = uVar1;
  *(undefined2 *)(param_1 + 3) = *(undefined2 *)(param_2 + 3);
  *(undefined2 *)((long)param_1 + 0x1a) = *(undefined2 *)((long)param_2 + 0x1a);
  *(undefined2 *)((long)param_1 + 0x1c) = *(undefined2 *)((long)param_2 + 0x1c);
  *(undefined2 *)((long)param_1 + 0x1e) = *(undefined2 *)((long)param_2 + 0x1e);
  *(undefined2 *)(param_1 + 4) = *(undefined2 *)(param_2 + 4);
  *(undefined8 *)((long)param_1 + 0x22) = *(undefined8 *)((long)param_2 + 0x22);
  *(undefined2 *)((long)param_1 + 0x2a) = *(undefined2 *)((long)param_2 + 0x2a);
  *(undefined4 *)((long)param_1 + 0x2c) = *(undefined4 *)((long)param_2 + 0x2c);
  *(undefined4 *)(param_1 + 6) = *(undefined4 *)(param_2 + 6);
  *(undefined4 *)((long)param_1 + 0x34) = *(undefined4 *)((long)param_2 + 0x34);
  *(undefined4 *)(param_1 + 7) = *(undefined4 *)(param_2 + 7);
  *(undefined4 *)((long)param_1 + 0x3c) = *(undefined4 *)((long)param_2 + 0x3c);
  *(undefined4 *)(param_1 + 8) = *(undefined4 *)(param_2 + 8);
  *(undefined4 *)((long)param_1 + 0x44) = *(undefined4 *)((long)param_2 + 0x44);
  *(undefined4 *)(param_1 + 9) = *(undefined4 *)(param_2 + 9);
  lVar2 = 0x4c;
  do {
    *(undefined4 *)((long)param_1 + lVar2) = *(undefined4 *)((long)param_2 + lVar2);
    lVar2 = lVar2 + 4;
  } while (lVar2 != 0x200);
  return;
}



void FUN_00116ab0(long param_1)

{
  undefined4 uVar1;
  undefined4 uVar2;
  long lVar3;
  undefined8 uVar4;
  long in_FS_OFFSET;
  
  uVar1 = *(undefined4 *)(param_1 + 0x7c);
  lVar3 = *(long *)(in_FS_OFFSET + 0x28);
  if (DAT_001244f8 == 0x1020304) {
    *(ushort *)(param_1 + 0x40) =
         CONCAT11((char)*(undefined2 *)(param_1 + 0x40),
                  (char)((ushort)*(undefined2 *)(param_1 + 0x40) >> 8));
    uVar2 = *(undefined4 *)(param_1 + 0x44);
    *(uint *)(param_1 + 0x44) =
         CONCAT13((char)uVar2,
                  CONCAT12((char)((uint)uVar2 >> 8),
                           CONCAT11((char)((uint)uVar2 >> 0x10),(char)((uint)uVar2 >> 0x18))));
    uVar2 = *(undefined4 *)(param_1 + 0x48);
    *(uint *)(param_1 + 0x48) =
         CONCAT13((char)uVar2,
                  CONCAT12((char)((uint)uVar2 >> 8),
                           CONCAT11((char)((uint)uVar2 >> 0x10),(char)((uint)uVar2 >> 0x18))));
    uVar2 = *(undefined4 *)(param_1 + 0x4c);
    *(uint *)(param_1 + 0x4c) =
         CONCAT13((char)uVar2,
                  CONCAT12((char)((uint)uVar2 >> 8),
                           CONCAT11((char)((uint)uVar2 >> 0x10),(char)((uint)uVar2 >> 0x18))));
    uVar4 = *(undefined8 *)(param_1 + 0x50);
    *(ulong *)(param_1 + 0x50) =
         CONCAT17((char)uVar4,
                  CONCAT16((char)((ulong)uVar4 >> 8),
                           CONCAT15((char)((ulong)uVar4 >> 0x10),
                                    CONCAT14((char)((ulong)uVar4 >> 0x18),
                                             CONCAT13((char)((ulong)uVar4 >> 0x20),
                                                      CONCAT12((char)((ulong)uVar4 >> 0x28),
                                                               CONCAT11((char)((ulong)uVar4 >> 0x30)
                                                                        ,(char)((ulong)uVar4 >> 0x38
                                                                               ))))))));
    uVar4 = *(undefined8 *)(param_1 + 0x58);
    *(ulong *)(param_1 + 0x58) =
         CONCAT17((char)uVar4,
                  CONCAT16((char)((ulong)uVar4 >> 8),
                           CONCAT15((char)((ulong)uVar4 >> 0x10),
                                    CONCAT14((char)((ulong)uVar4 >> 0x18),
                                             CONCAT13((char)((ulong)uVar4 >> 0x20),
                                                      CONCAT12((char)((ulong)uVar4 >> 0x28),
                                                               CONCAT11((char)((ulong)uVar4 >> 0x30)
                                                                        ,(char)((ulong)uVar4 >> 0x38
                                                                               ))))))));
    uVar2 = *(undefined4 *)(param_1 + 0x60);
    *(uint *)(param_1 + 0x60) =
         CONCAT13((char)uVar2,
                  CONCAT12((char)((uint)uVar2 >> 8),
                           CONCAT11((char)((uint)uVar2 >> 0x10),(char)((uint)uVar2 >> 0x18))));
    uVar4 = *(undefined8 *)(param_1 + 0x68);
    *(ulong *)(param_1 + 0x68) =
         CONCAT17((char)uVar4,
                  CONCAT16((char)((ulong)uVar4 >> 8),
                           CONCAT15((char)((ulong)uVar4 >> 0x10),
                                    CONCAT14((char)((ulong)uVar4 >> 0x18),
                                             CONCAT13((char)((ulong)uVar4 >> 0x20),
                                                      CONCAT12((char)((ulong)uVar4 >> 0x28),
                                                               CONCAT11((char)((ulong)uVar4 >> 0x30)
                                                                        ,(char)((ulong)uVar4 >> 0x38
                                                                               ))))))));
    uVar4 = *(undefined8 *)(param_1 + 0x70);
    *(ulong *)(param_1 + 0x70) =
         CONCAT17((char)uVar4,
                  CONCAT16((char)((ulong)uVar4 >> 8),
                           CONCAT15((char)((ulong)uVar4 >> 0x10),
                                    CONCAT14((char)((ulong)uVar4 >> 0x18),
                                             CONCAT13((char)((ulong)uVar4 >> 0x20),
                                                      CONCAT12((char)((ulong)uVar4 >> 0x28),
                                                               CONCAT11((char)((ulong)uVar4 >> 0x30)
                                                                        ,(char)((ulong)uVar4 >> 0x38
                                                                               ))))))));
    uVar2 = *(undefined4 *)(param_1 + 0x78);
    *(uint *)(param_1 + 0x78) =
         CONCAT13((char)uVar2,
                  CONCAT12((char)((uint)uVar2 >> 8),
                           CONCAT11((char)((uint)uVar2 >> 0x10),(char)((uint)uVar2 >> 0x18))));
    uVar1 = CONCAT13((char)uVar1,
                     CONCAT12((char)((uint)uVar1 >> 8),
                              CONCAT11((char)((uint)uVar1 >> 0x10),(char)((uint)uVar1 >> 0x18))));
  }
  *(undefined4 *)(param_1 + 0x7c) = uVar1;
  if (lVar3 == *(long *)(in_FS_OFFSET + 0x28)) {
    return;
  }
                    // WARNING: Subroutine does not return
  __stack_chk_fail();
}



void FUN_00116d40(undefined4 *param_1)

{
  undefined2 uVar1;
  undefined4 uVar2;
  long lVar3;
  undefined2 uVar4;
  long in_FS_OFFSET;
  undefined4 local_14;
  
  lVar3 = *(long *)(in_FS_OFFSET + 0x28);
  uVar1 = *(undefined2 *)((long)param_1 + 6);
  *(undefined2 *)(local_14 + 0) = uVar1;
  if (DAT_001244f8 == 0x1020304) {
    uVar2 = *param_1;
    uVar4 = CONCAT11((char)uVar2,(char)((uint)uVar2 >> 8));
    *(undefined2 *)(local_14 + 0) = CONCAT11((char)((uint)uVar2 >> 0x10),(char)((uint)uVar2 >> 0x18));
    local_14 = CONCAT22(uVar4,(undefined2)local_14);
    *param_1 = local_14;
    local_14 = CONCAT31(CONCAT21(uVar4,(char)*(undefined2 *)(param_1 + 1)),
                        (char)((ushort)*(undefined2 *)(param_1 + 1) >> 8));
    *(undefined2 *)(param_1 + 1) = (undefined2)local_14;
    local_14 = CONCAT31(CONCAT21(uVar4,(char)uVar1),(char)((ushort)uVar1 >> 8));
  }
  *(undefined2 *)((long)param_1 + 6) = (undefined2)local_14;
  if (lVar3 == *(long *)(in_FS_OFFSET + 0x28)) {
    return;
  }
                    // WARNING: Subroutine does not return
  __stack_chk_fail();
}



void FUN_00116dd0(undefined8 *param_1,undefined8 *param_2)

{
  undefined8 uVar1;
  
  uVar1 = param_2[1];
  *param_1 = *param_2;
  param_1[1] = uVar1;
  uVar1 = param_2[3];
  param_1[2] = param_2[2];
  param_1[3] = uVar1;
  uVar1 = param_2[5];
  param_1[4] = param_2[4];
  param_1[5] = uVar1;
  uVar1 = param_2[7];
  param_1[6] = param_2[6];
  param_1[7] = uVar1;
  *(undefined2 *)(param_1 + 8) = *(undefined2 *)(param_2 + 8);
  *(undefined *)((long)param_1 + 0x42) = *(undefined *)((long)param_2 + 0x42);
  *(undefined *)((long)param_1 + 0x43) = *(undefined *)((long)param_2 + 0x43);
  *(undefined4 *)((long)param_1 + 0x44) = *(undefined4 *)((long)param_2 + 0x44);
  *(undefined4 *)(param_1 + 9) = *(undefined4 *)(param_2 + 9);
  *(undefined4 *)((long)param_1 + 0x4c) = *(undefined4 *)((long)param_2 + 0x4c);
  uVar1 = param_2[0xb];
  param_1[10] = param_2[10];
  param_1[0xb] = uVar1;
  *(undefined4 *)(param_1 + 0xc) = *(undefined4 *)(param_2 + 0xc);
  param_1[0xd] = *(undefined8 *)((long)param_2 + 100);
  param_1[0xe] = *(undefined8 *)((long)param_2 + 0x6c);
  *(undefined4 *)(param_1 + 0xf) = *(undefined4 *)((long)param_2 + 0x74);
  *(undefined4 *)((long)param_1 + 0x7c) = *(undefined4 *)(param_2 + 0xf);
  *(undefined4 *)(param_1 + 0x10) = *(undefined4 *)((long)param_2 + 0x7c);
  return;
}



undefined8 FUN_00116e60(undefined8 param_1,long *param_2)

{
  long lVar1;
  int *piVar2;
  undefined8 uVar3;
  long in_FS_OFFSET;
  undefined auStack_228 [520];
  long local_20;
  
  local_20 = *(long *)(in_FS_OFFSET + 0x28);
  DAT_001244f8 = 0x4030201;
  lVar1 = FUN_00116500(param_1,0,auStack_228,0x200);
  if (lVar1 == -1) {
    uVar3 = 0xffffffff;
  }
  else {
    FUN_00116a10(param_2,auStack_228);
    FUN_00116720(param_1);
    if (((*param_2 == -0x1ee54e5e1fee3030) && (*(ushort *)((long)param_2 + 0x1e) < 0x15)) &&
       (*(ushort *)(param_2 + 4) < 0x15)) {
      uVar3 = 0;
    }
    else {
      piVar2 = __errno_location();
      *piVar2 = 0x16;
      uVar3 = 0xffffffff;
    }
  }
  if (local_20 == *(long *)(in_FS_OFFSET + 0x28)) {
    return uVar3;
  }
                    // WARNING: Subroutine does not return
  __stack_chk_fail();
}



int FUN_00116f20(undefined8 param_1,long param_2,long param_3,long param_4,long param_5,int param_6
                 )

{
  long lVar1;
  
  lVar1 = (long)(1 << ((byte)*(undefined2 *)(param_5 + 0x1e) & 0x1f));
  if (lVar1 == param_4) {
    FUN_00116500(param_1,((long)param_6 + 1) * lVar1,param_3 + param_2, 0x200);
    return 0;
  }
                    // WARNING: Subroutine does not return
  __assert_fail("ss == len","cdf.c",0x173,"cdf_read_sector");
}



size_t FUN_00116f80(long *param_1,long param_2,long param_3,size_t param_4,long param_5,int param_6)

{
  int *piVar1;
  size_t __n;
  
  __n = (size_t)(1 << ((byte)*(undefined2 *)(param_5 + 0x20) & 0x1f));
  if (__n == param_4) {
    if ((ulong)((long)(1 << ((byte)*(undefined2 *)(param_5 + 0x1e) & 0x1f)) * param_1[1]) <
        (long)param_6 * __n + __n) {
      piVar1 = __errno_location();
      *piVar1 = 0x16;
      __n = 0xffffffffffffffff;
    }
    else {
      memcpy((void *)(param_2 + param_3),(void *)(*param_1 + (long)param_6 * __n),__n);
    }
    return __n;
  }
                    // WARNING: Subroutine does not return
  __assert_fail("ss == len","cdf.c",0x17d,"cdf_read_short_sector");
}



undefined8 FUN_00117030(undefined8 param_1,long param_2,undefined8 *param_3)

{
  int iVar1;
  long lVar2;
  undefined auVar3 [16];
  ulong uVar4;
  ulong uVar5;
  void *pvVar6;
  ulong uVar7;
  undefined8 uVar8;
  int *piVar9;
  void *__ptr;
  size_t __nmemb;
  ulong __size;
  long lVar10;
  long lVar11;
  ulong uVar12;
  long in_FS_OFFSET;
  ulong local_58;
  undefined4 local_44;
  
  uVar12 = 0;
  lVar2 = *(long *)(in_FS_OFFSET + 0x28);
  __size = (ulong)(1 << ((byte)*(undefined2 *)(param_2 + 0x1e) & 0x1f));
  uVar4 = (__size >> 2) - 1;
  do {
    if (*(int *)(param_2 + 0x4c + uVar12 * 4) == -1) break;
    uVar12 = uVar12 + 1;
  } while (uVar12 != 0x6d);
  *(undefined8 *)(auVar3 + 8) = 0;
  *(undefined8 *)(auVar3 + 0)  = __size * 4;
  uVar5 = SUB168((ZEXT816(0) << 0x40 | ZEXT816(0xffffffff)) / auVar3,0);
  if (((uVar4 == 0) || ((ulong)*(uint *)(param_2 + 0x48) <= uVar5 / uVar4)) && (uVar12 <= uVar5)) {
    __nmemb = uVar12 + *(uint *)(param_2 + 0x48) * uVar4;
    param_3[1] = __nmemb;
    pvVar6 = calloc(__nmemb,__size);
    *param_3 = pvVar6;
    if (pvVar6 == (void *)0x0) {
      uVar8 = 0xffffffff;
    }
    else {
      lVar10 = 0;
      uVar12 = 0;
      do {
        if (*(int *)(param_2 + 0x4c + uVar12 * 4) < 0) break;
        uVar5 = FUN_00116f20(param_1,*param_3,lVar10,__size,param_2, 0x00);
        if (uVar5 != __size) goto LAB_00117270;
        uVar12 = uVar12 + 1;
        lVar10 = lVar10 + __size;
      } while (uVar12 != 0x6d);
      pvVar6 = calloc(1,__size);
      if (pvVar6 == (void *)0x0) {
LAB_00117270:
        __ptr = (void *)*param_3;
      }
      else {
        if ((*(int *)(param_2 + 0x48) == 0) || (*(int *)(param_2 + 0x44) < 0)) {
LAB_0011725b:
          param_3[1] = uVar12;
          free(pvVar6);
          uVar8 = 0;
          goto LAB_00117280;
        }
        local_58 = 0;
        do {
          uVar5 = FUN_00116f20(param_1,pvVar6,0,__size,param_2, 0x00);
          if (uVar5 != __size) {
LAB_0011733b:
            __ptr = (void *)*param_3;
            goto LAB_0011733e;
          }
          if (uVar4 != 0) {
            uVar5 = uVar4 + uVar12;
            lVar11 = __size * uVar12;
            lVar10 = uVar12 * -4;
            do {
              iVar1 = *(int *)((long)pvVar6 + uVar12 * 4 + lVar10);
              local_44 = iVar1;
              if (DAT_001244f8 == 0x1020304) {
            *(undefined2 *)&local_44 = CONCAT11((char)((uint)iVar1 >> 0x10),(char)((uint)iVar1 >> 0x18));
            *((undefined *)&local_44 + 3) = (undefined)iVar1;
            *(undefined4 *)&local_44 = CONCAT12((char)((uint)iVar1 >> 8),(undefined2)local_44);
              }
              if (local_44 < 0) goto LAB_0011725b;
              __ptr = (void *)*param_3;
              if ((ulong)param_3[1] <= uVar12) goto LAB_00117320;
              uVar7 = FUN_00116f20(param_1,__ptr,lVar11,__size,param_2, 0x00);
              if (uVar7 != __size) goto LAB_0011733b;
              uVar12 = uVar12 + 1;
              lVar11 = lVar11 + __size;
            } while (uVar5 != uVar12);
          }
          iVar1 = *(int *)((long)pvVar6 + uVar4 * 4);
          local_44 = iVar1;
          if (DAT_001244f8 == 0x1020304) {
            *(undefined2 *)&local_44 = CONCAT11((char)((uint)iVar1 >> 0x10),(char)((uint)iVar1 >> 0x18));
            *((undefined *)&local_44 + 3) = (undefined)iVar1;
            *(undefined4 *)&local_44 = CONCAT12((char)((uint)iVar1 >> 8),(undefined2)local_44);
          }
          local_58 = local_58 + 1;
          if ((*(uint *)(param_2 + 0x48) <= local_58) || (local_44 < 0)) goto LAB_0011725b;
        } while (local_58 != 10000);
        __ptr = (void *)*param_3;
LAB_00117320:
        piVar9 = __errno_location();
        *piVar9 = 0x16;
LAB_0011733e:
        free(pvVar6);
      }
      free(__ptr);
      uVar8 = 0xffffffff;
    }
  }
  else {
    piVar9 = __errno_location();
    *piVar9 = 0x16;
    uVar8 = 0xffffffff;
  }
LAB_00117280:
  if (lVar2 != *(long *)(in_FS_OFFSET + 0x28)) {
                    // WARNING: Subroutine does not return
    __stack_chk_fail();
  }
  return uVar8;
}



long FUN_00117380(long *param_1,int param_2,long param_3)

{
  long lVar1;
  uint uVar2;
  uint uVar3;
  uint uVar4;
  undefined uVar5;
  long lVar6;
  int *piVar7;
  int iVar8;
  long lVar9;
  long in_FS_OFFSET;
  undefined4 local_14;
  
  lVar6 = (long)param_2;
  lVar9 = 0;
  lVar1 = *(long *)(in_FS_OFFSET + 0x28);
  if (param_2 != -2) {
    if ((-1 < param_2) && (iVar8 = (int)((ulong)(param_3 * param_1[1]) >> 2), param_2 < iVar8)) {
      do {
        local_14 = *(int *)(*param_1 + lVar6 * 4);
        if (DAT_001244f8 == 0x1020304) {
          uVar2 = (uint)local_14 >> 8;
          uVar5 = (undefined)local_14;
          uVar3 = (uint)local_14 >> 0x18;
          uVar4 = (uint)local_14 >> 0x10;
          local_14 = CONCAT22(CONCAT11(uVar5,(char)uVar2),CONCAT11((char)uVar4,(char)uVar3));
        }
        lVar6 = (long)local_14;
        lVar9 = lVar9 + 1;
        if (local_14 < 0) goto LAB_0011740a;
      } while ((local_14 < iVar8) && (lVar9 != 10000));
    }
    piVar7 = __errno_location();
    lVar9 = -1;
    *piVar7 = 0x16;
  }
LAB_0011740a:
  if (lVar1 == *(long *)(in_FS_OFFSET + 0x28)) {
    return lVar9;
  }
                    // WARNING: Subroutine does not return
  __stack_chk_fail();
}



undefined8
FUN_00117450(undefined8 param_1,long param_2,long *param_3,int param_4,undefined8 param_5,
            undefined8 *param_6)

{
  long lVar1;
  uint uVar2;
  uint uVar3;
  uint uVar4;
  ulong __nmemb;
  void *__ptr;
  size_t sVar5;
  int *piVar6;
  undefined8 uVar7;
  undefined uVar8;
  ulong uVar9;
  long lVar10;
  size_t __size;
  long in_FS_OFFSET;
  undefined4 local_44;
  
  __size = (size_t)(1 << ((byte)*(undefined2 *)(param_2 + 0x1e) & 0x1f));
  lVar1 = *(long *)(in_FS_OFFSET + 0x28);
  *param_6 = 0;
  __nmemb = FUN_00117380(param_3,param_4,__size);
  param_6[2] = param_5;
  param_6[1] = __nmemb;
  param_6[3] = __size;
  if (__nmemb == 0xffffffffffffffff) {
LAB_001175e3:
    __ptr = (void *)*param_6;
  }
  else {
    __ptr = calloc(__nmemb,__size);
    *param_6 = __ptr;
    if (__ptr == (void *)0x0) {
      param_6[1] = 0;
      uVar7 = 0xffffffff;
      param_6[2] = 0;
      param_6[3] = 0;
      goto LAB_001175c4;
    }
    lVar10 = 0;
    uVar9 = 0;
    if (param_4 < 0) {
LAB_001175c2:
      uVar7 = 0;
      goto LAB_001175c4;
    }
    while (uVar9 < __nmemb) {
      sVar5 = FUN_00116f20(param_1,__ptr,lVar10,__size,param_2,param_4);
      if (__size != sVar5) {
        if ((param_6[1] - 1 != uVar9) || ((long)sVar5 < 1)) goto LAB_001175e3;
        goto LAB_001175c2;
      }
      local_44 = *(int *)(*param_3 + (long)param_4 * 4);
      if (DAT_001244f8 == 0x1020304) {
        uVar2 = (uint)local_44 >> 8;
        uVar8 = (undefined)local_44;
        uVar3 = (uint)local_44 >> 0x18;
        uVar4 = (uint)local_44 >> 0x10;
        local_44 = CONCAT22(CONCAT11(uVar8,(char)uVar2),CONCAT11((char)uVar4,(char)uVar3));
      }
      uVar9 = uVar9 + 1;
      if (local_44 < 0) goto LAB_001175c2;
      __ptr = (void *)*param_6;
      lVar10 = lVar10 + __size;
      if (uVar9 == 10000) break;
      param_4 = local_44;
      __nmemb = param_6[1];
    }
  }
  piVar6 = __errno_location();
  *piVar6 = 0x16;
  param_6[1] = 0;
  param_6[2] = 0;
  param_6[3] = 0;
  free(__ptr);
  *param_6 = 0;
  uVar7 = 0xffffffff;
LAB_001175c4:
  if (lVar1 != *(long *)(in_FS_OFFSET + 0x28)) {
                    // WARNING: Subroutine does not return
    __stack_chk_fail();
  }
  return uVar7;
}



undefined8 FUN_00117610(long param_1,long *param_2,undefined8 param_3,int param_4,undefined8 param_5, undefined8 *param_6)

{
  undefined2 uVar1;
  undefined2 uVar2;
  long lVar3;
  uint uVar4;
  uint uVar5;
  uint uVar6;
  ulong __nmemb;
  void *__ptr;
  size_t sVar7;
  int *piVar8;
  undefined8 uVar9;
  undefined uVar10;
  ulong uVar11;
  size_t __size;
  long lVar12;
  long in_FS_OFFSET;
  undefined4 local_44;
  
  uVar1 = *(undefined2 *)(param_1 + 0x20);
  uVar2 = *(undefined2 *)(param_1 + 0x1e);
  lVar3 = *(long *)(in_FS_OFFSET + 0x28);
  *param_6 = 0;
  __size = (size_t)(1 << ((byte)uVar1 & 0x1f));
  __nmemb = FUN_00117380(param_2,param_4,(long)(1 << ((byte)uVar2 & 0x1f)));
  param_6[2] = param_5;
  param_6[1] = __nmemb;
  param_6[3] = __size;
  if (__nmemb == 0xffffffffffffffff) {
LAB_001177a0:
    __ptr = (void *)*param_6;
  }
  else {
    __ptr = calloc(__nmemb,__size);
    *param_6 = __ptr;
    if (__ptr == (void *)0x0) {
      param_6[1] = 0;
      uVar9 = 0xffffffff;
      param_6[2] = 0;
      param_6[3] = 0;
      goto LAB_00117774;
    }
    lVar12 = 0;
    uVar11 = 0;
    if (param_4 < 0) {
LAB_00117798:
      uVar9 = 0;
      goto LAB_00117774;
    }
    while (uVar11 < __nmemb) {
      sVar7 = FUN_00116f80(param_3,__ptr,lVar12,__size,param_1,param_4);
      if (sVar7 != __size) goto LAB_001177a0;
      local_44 = *(int *)(*param_2 + (long)param_4 * 4);
      if (DAT_001244f8 == 0x1020304) {
        uVar4 = (uint)local_44 >> 8;
        uVar10 = (undefined)local_44;
        uVar5 = (uint)local_44 >> 0x18;
        uVar6 = (uint)local_44 >> 0x10;
        local_44 = CONCAT22(CONCAT11(uVar10,(char)uVar4),CONCAT11((char)uVar6,(char)uVar5));
      }
      uVar11 = uVar11 + 1;
      if (local_44 < 0) goto LAB_00117798;
      __ptr = (void *)*param_6;
      lVar12 = lVar12 + __size;
      if (uVar11 == 10000) break;
      param_4 = local_44;
      __nmemb = param_6[1];
    }
  }
  piVar8 = __errno_location();
  *piVar8 = 0x16;
  param_6[1] = 0;
  param_6[2] = 0;
  param_6[3] = 0;
  free(__ptr);
  *param_6 = 0;
  uVar9 = 0xffffffff;
LAB_00117774:
  if (lVar3 != *(long *)(in_FS_OFFSET + 0x28)) {
                    // WARNING: Subroutine does not return
    __stack_chk_fail();
  }
  return uVar9;
}



void FUN_001177d0(undefined8 param_1,long param_2,undefined8 param_3,undefined8 param_4,
                 long *param_5,undefined4 param_6,ulong param_7,undefined8 param_8)

{
  if ((param_7 < *(uint *)(param_2 + 0x38)) && (*param_5 != 0)) {
    FUN_00117610(param_2,param_4,param_1, param_3, param_5, param_6);
    return;
  }
  FUN_00117450(param_1,param_2,param_3,param_6,param_7,param_8);
  return;
}



undefined8 FUN_00117820(undefined8 param_1,long param_2,long *param_3,long *param_4)

{
  int iVar1;
  long lVar2;
  long lVar3;
  void *pvVar4;
  void *__ptr;
  ulong uVar5;
  ulong uVar6;
  int *piVar7;
  undefined8 uVar8;
  long lVar9;
  long extraout_RDX;
  ulong uVar10;
  long lVar11;
  ulong uVar12;
  long in_FS_OFFSET;
  long local_80;
  undefined2 local_44;
  
  iVar1 = *(int *)(param_2 + 0x30);
  uVar12 = (ulong)(1 << ((byte)*(undefined2 *)(param_2 + 0x1e) & 0x1f));
  lVar2 = *(long *)(in_FS_OFFSET + 0x28);
  lVar3 = FUN_00117380(param_3,iVar1,uVar12);
  if (lVar3 != -1) {
    uVar10 = uVar12 >> 7;
    param_4[1] = lVar3 * uVar10;
    pvVar4 = calloc(lVar3 * uVar10,0x88);
    *param_4 = (long)pvVar4;
    if (pvVar4 != (void *)0x0) {
      __ptr = malloc(uVar12);
      if (__ptr == (void *)0x0) {
        free(pvVar4);
        uVar8 = 0xffffffff;
        goto LAB_001179ea;
      }
      if (lVar3 == 0) {
LAB_00117a10:
        free(__ptr);
        uVar8 = 0;
        goto LAB_001179ea;
      }
      local_80 = 0;
      uVar5 = 1;
      if (uVar10 != 0) {
        uVar5 = uVar10 + 1;
      }
      lVar11 = 0;
      do {
        uVar6 = FUN_00116f20(param_1,__ptr,0,uVar12,param_2,iVar1);
        if (uVar6 != uVar12) break;
        if (uVar10 != 0) {
          lVar9 = lVar11 * 0x88;
          pvVar4 = __ptr;
          do {
            FUN_00116dd0(*param_4 + lVar9,pvVar4);
            pvVar4 = (void *)(extraout_RDX + 0x80);
            lVar9 = lVar9 + 0x88;
          } while ((void *)(uVar10 * 0x80 + (long)__ptr) != pvVar4);
        }
        iVar1 = *(int *)(*param_3 + (long)iVar1 * 4);
        if (DAT_001244f8 == 0x1020304) {
          local_44 = CONCAT11((char)((uint)iVar1 >> 0x10),(char)((uint)iVar1 >> 0x18));
          iVar1 = CONCAT22(CONCAT11((char)iVar1,(char)((uint)iVar1 >> 8)),local_44);
        }
        local_80 = local_80 + 1;
        if (lVar3 == local_80) {
          if ((DAT_001244f8 == 0x1020304) && (param_4[1] != 0)) {
            uVar12 = 0;
            do {
              uVar10 = uVar12 + 1;
              FUN_00116ab0(*param_4 + uVar12 * 0x88);
              uVar12 = uVar10;
            } while (uVar10 < (ulong)param_4[1]);
            free(__ptr);
            uVar8 = 0;
            goto LAB_001179ea;
          }
          goto LAB_00117a10;
        }
        lVar11 = lVar11 + uVar10;
      } while (uVar5 < 10000);
      free((void *)*param_4);
      free(__ptr);
      piVar7 = __errno_location();
      *piVar7 = 0x16;
    }
  }
  uVar8 = 0xffffffff;
LAB_001179ea:
  if (lVar2 == *(long *)(in_FS_OFFSET + 0x28)) {
    return uVar8;
  }
                    // WARNING: Subroutine does not return
  __stack_chk_fail();
}



undefined8 FUN_00117a70(undefined8 param_1,long param_2,long *param_3,undefined8 *param_4)

{
  undefined2 uVar1;
  long lVar2;
  uint uVar3;
  uint uVar4;
  uint uVar5;
  ulong __nmemb;
  void *__ptr;
  size_t sVar6;
  int *piVar7;
  undefined8 uVar8;
  undefined uVar9;
  ulong uVar10;
  size_t __size;
  long lVar11;
  long in_FS_OFFSET;
  undefined4 local_44;
  
  uVar1 = *(undefined2 *)(param_2 + 0x1e);
  local_44 = *(int *)(param_2 + 0x3c);
  lVar2 = *(long *)(in_FS_OFFSET + 0x28);
  *param_4 = 0;
  __size = (size_t)(1 << ((byte)uVar1 & 0x1f));
  __nmemb = FUN_00117380(param_3,local_44,__size);
  param_4[1] = __nmemb;
  if (__nmemb == 0xffffffffffffffff) {
    __ptr = (void *)*param_4;
LAB_00117b85:
    piVar7 = __errno_location();
    *piVar7 = 0x16;
  }
  else {
    __ptr = calloc(__nmemb,__size);
    *param_4 = __ptr;
    if (__ptr != (void *)0x0) {
      lVar11 = 0;
      uVar10 = 0;
      if (local_44 < 0) {
LAB_00117bd0:
        uVar8 = 0;
        goto LAB_00117ba7;
      }
      while (uVar10 < __nmemb) {
        sVar6 = FUN_00116f20(param_1,__ptr,lVar11,__size,param_2,local_44);
        if (sVar6 != __size) {
          __ptr = (void *)*param_4;
          goto LAB_00117b9a;
        }
        local_44 = *(int *)(*param_3 + (long)local_44 * 4);
        if (DAT_001244f8 == 0x1020304) {
          uVar3 = (uint)local_44 >> 8;
          uVar9 = (undefined)local_44;
          uVar4 = (uint)local_44 >> 0x18;
          uVar5 = (uint)local_44 >> 0x10;
          local_44 = CONCAT22(CONCAT11(uVar9,(char)uVar3),CONCAT11((char)uVar5,(char)uVar4));
        }
        uVar10 = uVar10 + 1;
        if (local_44 < 0) goto LAB_00117bd0;
        __ptr = (void *)*param_4;
        lVar11 = lVar11 + __size;
        if (uVar10 == 10000) break;
        __nmemb = param_4[1];
      }
      goto LAB_00117b85;
    }
  }
LAB_00117b9a:
  free(__ptr);
  uVar8 = 0xffffffff;
LAB_00117ba7:
  if (lVar2 != *(long *)(in_FS_OFFSET + 0x28)) {
                    // WARNING: Subroutine does not return
    __stack_chk_fail();
  }
  return uVar8;
}



undefined8 FUN_00117bf0(long local_708,long  local_688,long  local_748,long local_728,long  local_6e8,long  local_760)

{
  int iVar1;
  long lVar2;
  long lVar3;
  undefined8 uVar4;
  long *in_RCX;
  long lVar5;
  undefined8 *in_R8;
  long *in_R9;
  
  lVar2 = in_RCX[1];
  *in_R9 = 0;
  if (lVar2 != 0) {
    lVar3 = *in_RCX;
    lVar5 = 0;
    do {
      if (*(char *)(lVar3 + 0x42) == '\x05') {
        iVar1 = *(int *)(lVar3 + 0x78);
        *in_R9 = lVar3;
        if (-1 < iVar1) {
          uVar4 = FUN_00117450(local_708, local_688, local_748, local_728, 0,0);
          return uVar4;
        }
        break;
      }
      lVar5 = lVar5 + 1;
      lVar3 = lVar3 + 0x88;
    } while (lVar2 != lVar5);
  }
  *in_R8 = 0;
  in_R8[1] = 0;
  in_R8[2] = 0;
  in_R8[3] = 0;
  return 0;
}



long FUN_00117c70(long *param_1,char *param_2,uint param_3)

{
  long lVar1;
  size_t sVar2;
  long lVar3;
  int *piVar4;
  size_t sVar5;
  ushort uVar6;
  long lVar7;
  ushort uVar8;
  long in_FS_OFFSET;
  bool bVar9;
  
  lVar1 = *(long *)(in_FS_OFFSET + 0x28);
  sVar2 = strlen(param_2);
  lVar3 = param_1[1];
  if (lVar3 != 0) {
    lVar7 = *param_1 + -0x88 + lVar3 * 0x88;
    do {
      if (*(byte *)(lVar7 + 0x42) == param_3) {
        sVar5 = 0;
        while( true ) {
          uVar8 = *(ushort *)(lVar7 + sVar5 * 2);
          uVar6 = uVar8;
          if (DAT_001244f8 == 0x1020304) {
            uVar6 = uVar8 << 8 | uVar8 >> 8;
          }
          if ((int)param_2[sVar5] != (uint)uVar6) break;
          bVar9 = sVar2 == sVar5;
          sVar5 = sVar5 + 1;
          if (bVar9) goto LAB_00117d50;
        }
        if (DAT_001244f8 == 0x1020304) {
          uVar8 = uVar8 << 8 | uVar8 >> 8;
        }
        if ((byte)param_2[sVar5] == uVar8) goto LAB_00117d50;
      }
      lVar7 = lVar7 + -0x88;
      lVar3 = lVar3 + -1;
    } while (lVar3 != 0);
  }
  piVar4 = __errno_location();
  *piVar4 = 3;
  lVar3 = 0;
LAB_00117d50:
  if (lVar1 != *(long *)(in_FS_OFFSET + 0x28)) {
                    // WARNING: Subroutine does not return
    __stack_chk_fail();
  }
  return lVar3;
}



undefined8
FUN_00117d90(undefined8 param_1,undefined8 param_2,undefined8 param_3,undefined8 param_4,
            undefined8 param_5,long *param_6,undefined8 param_7)

{
  int iVar1;
  undefined8 uVar2;
  
  iVar1 = FUN_00117c70(param_6,param_7,2);
  if (0 < iVar1) {
    uVar2 = FUN_001177d0(param_1,param_2,param_3,param_4,param_5, *(undefined4 *)(*param_6 + (long)iVar1 * 0x88 + -0x10), 0x00, 0x00);
    return uVar2;
  }
  
  return 0xffffffff;
}



int FUN_00117e50(undefined8 param_1,undefined8 param_2,undefined8 param_3,undefined8 param_4,
            undefined8 param_5,long *param_6,undefined8 param_7)

{
  FUN_00117d90(param_1, param_2, param_3, param_4, param_5,param_6, param_7);
  return 0;
}



undefined8
FUN_00117e70(long *param_1,undefined8 param_2,uint param_3,undefined8 *param_4,long *param_5,
            ulong *param_6)

{
  uint *puVar1;
  long lVar2;
  uint3 uVar3;
  int iVar4;
  undefined2 uVar5;
  int iVar6;
  int *piVar7;
  undefined8 uVar8;
  ulong uVar9;
  void *pvVar10;
  long lVar11;
  uint uVar12;
  uint *puVar13;
  ulong uVar14;
  uint *puVar15;
  uint uVar16;
  void *__ptr;
  ulong uVar17;
  uint *puVar18;
  long lVar19;
  uint uVar20;
  long in_FS_OFFSET;
  void *local_90;
  ulong local_88;
  
  lVar2 = *(long *)(in_FS_OFFSET + 0x28);
  if (0x3fffffff < param_3) goto LAB_00118462;
  puVar13 = (uint *)(*param_1 + (ulong)param_3);
  iVar6 = FUN_001165b0(param_1,param_2,puVar13,8);
  iVar4 = DAT_001244f8;
  if (iVar6 == -1) goto LAB_00118240;
  uVar12 = *puVar13;
  if (DAT_001244f8 == 0x1020304) {
    uVar12 = CONCAT13((char)uVar12,
                      CONCAT12((char)(uVar12 >> 8),
                               CONCAT11((char)(uVar12 >> 0x10),(char)(uVar12 >> 0x18))));
    if (0x1fffffff < uVar12) goto LAB_00118462;
    uVar20 = puVar13[1];
    uVar20 = CONCAT13((char)uVar20,
                      CONCAT12((char)(uVar20 >> 8),
                               CONCAT11((char)(uVar20 >> 0x10),(char)(uVar20 >> 0x18))));
LAB_00117ef5:
    if (0x2aaaaaa < uVar20) {
LAB_00118240:
      piVar7 = __errno_location();
      __ptr = (void *)*param_4;
      goto LAB_0011824d;
    }
    uVar14 = *param_6;
    if (uVar14 == 0) {
      *param_6 = (ulong)uVar20;
      local_90 = malloc((ulong)uVar20 * 0x18);
    }
    else {
      __ptr = (void *)*param_4;
      if (0x2aaaaaa < uVar14) {
LAB_0011847a:
        piVar7 = __errno_location();
        goto LAB_0011824d;
      }
      *param_6 = uVar14 + uVar20;
      local_90 = realloc(__ptr,(uVar14 + uVar20) * 0x18);
    }
    local_88 = (ulong)uVar20;
    if (local_90 != (void *)0x0) {
      lVar19 = *param_5;
      *param_4 = local_90;
      local_90 = (void *)((long)local_90 + lVar19 * 0x18);
      *param_5 = lVar19 + local_88;
      puVar1 = (uint *)(*param_1 + 8 + (ulong)param_3);
      puVar13 = (uint *)((long)puVar13 + (ulong)uVar12);
      iVar6 = FUN_001165b0(param_1,param_2,puVar13,0);
      if (iVar6 != -1) {
        if (uVar20 != 0) {
          uVar14 = 0;
          do {
            lVar19 = uVar14 * 2;
            iVar6 = FUN_001165b0(param_1,param_2,puVar1,(lVar19 + 1) * 4);
            if (iVar6 == -1) goto LAB_00118240;
            uVar12 = puVar1[lVar19 + 1];
            if (iVar4 == 0x1020304) {
              puVar18 = (uint *)((long)puVar1 +
                                ((ulong)CONCAT13((char)uVar12,
                                                 CONCAT12((char)(uVar12 >> 8),
                                                          CONCAT11((char)(uVar12 >> 0x10),
                                                                   (char)(uVar12 >> 0x18)))) - 8));
              if ((puVar18 < puVar1) || (puVar13 < puVar18)) goto LAB_00118240;
              puVar15 = (uint *)((long)local_90 + uVar14 * 0x18);
              uVar12 = puVar1[lVar19];
              *puVar15 = CONCAT13((char)uVar12,
                                  CONCAT12((char)(uVar12 >> 8),
                                           CONCAT11((char)(uVar12 >> 0x10),(char)(uVar12 >> 0x18))))
              ;
              uVar20 = *puVar18;
              uVar3 = CONCAT12((char)(uVar20 >> 8),
                               CONCAT11((char)(uVar20 >> 0x10),(char)(uVar20 >> 0x18)));
              uVar12 = CONCAT13((char)uVar20,uVar3);
              puVar15[1] = uVar12;
              uVar16 = uVar3 & 0x1000;
              if ((uVar20 & 0x100000) == 0) goto LAB_00118150;
              uVar20 = puVar18[1];
              uVar20 = CONCAT13((char)uVar20,
                                CONCAT12((char)(uVar20 >> 8),
                                         CONCAT11((char)(uVar20 >> 0x10),(char)(uVar20 >> 0x18))));
LAB_00118043:
              uVar17 = (ulong)uVar20;
              if (uVar17 == 0) goto LAB_00118240;
              lVar19 = 8;
              lVar11 = 2;
            }
            else {
              puVar18 = (uint *)((long)puVar1 + ((ulong)uVar12 - 8));
              if ((puVar18 < puVar1) || (puVar13 < puVar18)) goto LAB_00118240;
              puVar15 = (uint *)((long)local_90 + uVar14 * 0x18);
              *puVar15 = puVar1[lVar19];
              uVar12 = *puVar18;
              puVar15[1] = uVar12;
              uVar16 = uVar12 & 0x1000;
              if (uVar16 != 0) {
                uVar20 = puVar18[1];
                goto LAB_00118043;
              }
LAB_00118150:
              lVar19 = 4;
              uVar17 = 1;
              lVar11 = 1;
            }
            if (((uVar12 & 0xe000) != 0) || (false)) {
switchD_00118074_caseD_0:
              uVar14 = uVar14 + 1;
            }
            else {
              switch(uVar12 & 0xfff) {
              default:
                goto switchD_00118074_caseD_0;
              case 2:
                uVar14 = uVar14 + 1;
                if (uVar16 == 0) {
                  uVar5 = *(undefined2 *)((long)puVar18 + lVar19);
                  if (iVar4 == 0x1020304) {
                    uVar5 = CONCAT11((char)uVar5,(char)((ushort)uVar5 >> 8));
                  }
                  *(undefined2 *)(puVar15 + 2) = uVar5;
                }
                break;
              case 3:
              case 4:
              case 0xb:
              case 0x13:
                uVar14 = uVar14 + 1;
                if (uVar16 == 0) {
                  uVar12 = *(uint *)((long)puVar18 + lVar19);
                  if (iVar4 == 0x1020304) {
                    uVar12 = CONCAT13((char)uVar12,
                                      CONCAT12((char)(uVar12 >> 8),
                                               CONCAT11((char)(uVar12 >> 0x10),
                                                        (char)(uVar12 >> 0x18))));
                  }
                  puVar15[2] = uVar12;
                }
                break;
              case 5:
              case 0x14:
              case 0x15:
              case 0x40:
                uVar14 = uVar14 + 1;
                if (uVar16 == 0) {
                  uVar8 = *(undefined8 *)((long)puVar18 + lVar19);
                  if (iVar4 == 0x1020304) {
                    uVar8 = CONCAT17((char)uVar8,
                                     CONCAT16((char)((ulong)uVar8 >> 8),
                                              CONCAT15((char)((ulong)uVar8 >> 0x10),
                                                       CONCAT14((char)((ulong)uVar8 >> 0x18),
                                                                CONCAT13((char)((ulong)uVar8 >> 0x20
                                                                               ),CONCAT12((char)((
                                                  ulong)uVar8 >> 0x28),
                                                  CONCAT11((char)((ulong)uVar8 >> 0x30),
                                                           (char)((ulong)uVar8 >> 0x38))))))));
                  }
                  *(undefined8 *)(puVar15 + 2) = uVar8;
                }
                break;
              case 0x1e:
              case 0x1f:
                if (uVar17 != 1) {
                  __ptr = (void *)*param_4;
                  if ((0x2aaaaaa < uVar17) || (0x2aaaaaa < *param_6)) goto LAB_0011847a;
                  uVar9 = *param_6 + uVar17;
                  *param_6 = uVar9;
                  pvVar10 = realloc(__ptr,uVar9 * 0x18);
                  if (pvVar10 == (void *)0x0) goto LAB_0011848c;
                  *param_4 = pvVar10;
                  local_90 = (void *)((long)pvVar10 + ((long)local_90 - (long)__ptr));
                }
                uVar17 = uVar17 + uVar14;
                puVar15 = (uint *)((long)local_90 + uVar14 * 0x18 + 8);
                do {
                  if (local_88 <= uVar14) {
                    uVar8 = 0;
                    goto LAB_0011825d;
                  }
                  uVar12 = puVar18[lVar11];
                  if (iVar4 == 0x1020304) {
                    uVar12 = CONCAT13((char)uVar12,
                                      CONCAT12((char)(uVar12 >> 8),
                                               CONCAT11((char)(uVar12 >> 0x10),
                                                        (char)(uVar12 >> 0x18))));
                  }
                  *puVar15 = uVar12;
                  *(long *)(puVar15 + 2) = (long)puVar18 + lVar19 + 4;
                  lVar11 = lVar11 + (ulong)((uVar12 + 1) - (uint)((uVar12 & 1) == 0) >> 1);
                  if (puVar13 <= (uint *)((long)puVar18 + lVar11)) goto LAB_00118240;
                  uVar14 = uVar14 + 1;
                  lVar19 = lVar11 * 4;
                  puVar15 = puVar15 + 6;
                } while (uVar14 != uVar17);
              }
            }
          } while (uVar14 < local_88);
        }
        uVar8 = 0;
        goto LAB_0011825d;
      }
      goto LAB_00118240;
    }
LAB_0011848c:
    __ptr = (void *)*param_4;
  }
  else {
    if (uVar12 < 0x20000000) {
      uVar20 = puVar13[1];
      goto LAB_00117ef5;
    }
LAB_00118462:
    piVar7 = __errno_location();
    *piVar7 = 0x16;
    __ptr = (void *)*param_4;
LAB_0011824d:
    *piVar7 = 0x16;
  }
  free(__ptr);
  uVar8 = 0xffffffff;
LAB_0011825d:
  if (lVar2 != *(long *)(in_FS_OFFSET + 0x28)) {
                    // WARNING: Subroutine does not return
    __stack_chk_fail();
  }
  return uVar8;
}



int FUN_001184a0(undefined8 *param_1,undefined8 param_2,undefined2 *param_3,undefined8 *param_4,
                undefined8 *param_5)

{
  undefined2 uVar1;
  undefined2 uVar2;
  undefined2 uVar3;
  undefined4 uVar4;
  undefined2 *puVar5;
  undefined8 uVar6;
  undefined8 uVar7;
  int iVar8;
  long in_FS_OFFSET;
  undefined4 local_4c;
  undefined8 local_48;
  long local_40;
  
  puVar5 = (undefined2 *)*param_1;
  local_40 = *(long *)(in_FS_OFFSET + 0x28);
  iVar8 = FUN_001165b0(param_1,param_2,puVar5,0x1c);
  if (iVar8 != -1) {
    iVar8 = FUN_001165b0(param_1,param_2,puVar5 + 0xe,0x14);
    if (iVar8 != -1) {
      uVar1 = *puVar5;
      uVar2 = puVar5[2];
      uVar3 = puVar5[3];
      if (DAT_001244f8 == 0x1020304) {
        local_48 = CONCAT71(CONCAT61((local_48 + 2),(char)uVar1),(char)((ushort)uVar1 >> 8));
        *param_3 = (undefined2)local_48;
        local_48 = CONCAT71(CONCAT61((local_48 + 2),(char)uVar2),(char)((ushort)uVar2 >> 8));
        param_3[2] = (undefined2)local_48;
        local_48 = CONCAT71(CONCAT61((local_48 + 2),(char)uVar3),(char)((ushort)uVar3 >> 8));
        uVar6 = *(undefined8 *)(puVar5 + 4);
        uVar7 = *(undefined8 *)(puVar5 + 8);
        param_3[3] = (undefined2)local_48;
        *(undefined8 *)(param_3 + 4) = uVar6;
        *(undefined8 *)(param_3 + 8) = uVar7;
        FUN_00116d40(param_3 + 4);
        uVar4 = *(undefined4 *)(puVar5 + 0xc);
        *(undefined2 *)(local_48 + 0) = CONCAT11((char)((uint)uVar4 >> 0x10),(char)((uint)uVar4 >> 0x18));
        *(uint *)(param_3 + 0xc) =
             CONCAT22(CONCAT11((char)uVar4,(char)((uint)uVar4 >> 8)),(undefined2)local_48);
        uVar4 = *(undefined4 *)(puVar5 + 0x16);
        *param_5 = 0;
        *param_4 = 0;
        local_4c = CONCAT22(CONCAT11((char)uVar4,(char)((uint)uVar4 >> 8)),
                            CONCAT11((char)((uint)uVar4 >> 0x10),(char)((uint)uVar4 >> 0x18)));
      }
      else {
        param_3[2] = uVar2;
        uVar6 = *(undefined8 *)(puVar5 + 4);
        uVar7 = *(undefined8 *)(puVar5 + 8);
        param_3[3] = uVar3;
        *param_3 = uVar1;
        *(undefined8 *)(param_3 + 4) = uVar6;
        *(undefined8 *)(param_3 + 8) = uVar7;
        FUN_00116d40(param_3 + 4);
        local_4c = *(undefined4 *)(puVar5 + 0x16);
        *(undefined4 *)(param_3 + 0xc) = *(undefined4 *)(puVar5 + 0xc);
        *param_5 = 0;
        *param_4 = 0;
      }
      local_48 = 0;
      iVar8 = FUN_00117e70(param_1,param_2,local_4c,param_4,param_5,&local_48);
      iVar8 = -(uint)(iVar8 == -1);
      goto LAB_0011858e;
    }
  }
  iVar8 = -1;
LAB_0011858e:
  if (local_40 == *(long *)(in_FS_OFFSET + 0x28)) {
    return iVar8;
  }
                    // WARNING: Subroutine does not return
  __stack_chk_fail();
}



undefined8 FUN_00118680(long param_1,undefined8 *param_2,undefined8 *param_3)

{
  ushort uVar1;
  uint uVar2;
  undefined4 uVar3;
  long lVar4;
  int iVar5;
  ulong *puVar6;
  ushort *puVar7;
  ushort *puVar8;
  ulong uVar9;
  undefined8 uVar10;
  byte bVar11;
  ushort *puVar12;
  ushort *puVar13;
  long lVar14;
  ulong uVar15;
  ushort *puVar16;
  ulong uVar17;
  ulong uVar18;
  ushort uVar19;
  long in_FS_OFFSET;
  
  iVar5 = DAT_001244f8;
  lVar4 = *(long *)(in_FS_OFFSET + 0x28);
  if ((ulong)param_2[2] < (ulong)*(uint *)(param_1 + 0x38)) {
    bVar11 = (byte)*(undefined2 *)(param_1 + 0x20);
  }
  else {
    bVar11 = (byte)*(undefined2 *)(param_1 + 0x1e);
  }
  if (param_2[3] != (long)(1 << (bVar11 & 0x1f))) {
    FUN_00116580();
    goto LAB_00118a09;
  }
  puVar16 = (ushort *)*param_2;
  lVar14 = 0;
  puVar13 = (ushort *)(param_2[3] * param_2[1] + (long)puVar16);
  while( true ) {
    uVar1 = *puVar16;
    if (DAT_001244f8 == 0x1020304) {
      uVar1 = CONCAT11((char)uVar1,(char)(uVar1 >> 8));
    }
    if ((uVar1 == 0) || (puVar16 = (ushort *)((long)puVar16 + (ulong)uVar1), puVar13 < puVar16))
    break;
    lVar14 = lVar14 + 1;
  }
  if (lVar14 == 0) {
LAB_001189f2:
    uVar10 = 0xffffffff;
  }
  else {
    uVar15 = lVar14 - 1;
    puVar6 = (ulong *)malloc(uVar15 * 0x210 + 0x218);
    *param_3 = puVar6;
    if (puVar6 == (ulong *)0x0) goto LAB_001189f2;
    puVar7 = (ushort *)memset(puVar6 + 1,0,uVar15 * 0x210);
    puVar16 = (ushort *)*param_2;
    if (uVar15 == 0) {
      uVar9 = 0;
    }
    else {
      uVar9 = 0;
      puVar12 = puVar7;
      if (puVar16 + 1 <= puVar13) {
        uVar17 = 0;
        do {
          uVar1 = *puVar16;
          *puVar12 = uVar1;
          puVar8 = puVar7 + uVar17 * 0x108;
          if (iVar5 == 0x1020304) {
            *puVar8 = CONCAT11((char)uVar1,(char)(uVar1 >> 8));
            if (puVar13 < puVar16 + 4) break;
            uVar3 = *(undefined4 *)(puVar16 + 2);
            *(undefined4 *)(puVar12 + 2) = uVar3;
            *(uint *)(puVar8 + 2) =
                 (uint)CONCAT11((char)((uint)uVar3 >> 0x10),(char)((uint)uVar3 >> 0x18));
            if (puVar13 < puVar16 + 8) break;
            uVar10 = *(undefined8 *)(puVar16 + 4);
            *(undefined8 *)(puVar12 + 4) = uVar10;
            uVar10 = CONCAT17((char)uVar10,
                              CONCAT16((char)((ulong)uVar10 >> 8),
                                       CONCAT15((char)((ulong)uVar10 >> 0x10),
                                                CONCAT14((char)((ulong)uVar10 >> 0x18),
                                                         CONCAT13((char)((ulong)uVar10 >> 0x20),
                                                                  CONCAT12((char)((ulong)uVar10 >>
                                                                                 0x28),
                                                                           CONCAT11((char)((ulong)
                                                  uVar10 >> 0x30),(char)((ulong)uVar10 >> 0x38))))))
                                      ));
          }
          else {
            *puVar8 = uVar1;
            if (puVar13 < puVar16 + 4) break;
            uVar2 = *(uint *)(puVar16 + 2);
            *(uint *)(puVar12 + 2) = uVar2;
            *(uint *)(puVar8 + 2) = uVar2 & 0xffff;
            if (puVar13 < puVar16 + 8) break;
            uVar10 = *(undefined8 *)(puVar16 + 4);
            *(undefined8 *)(puVar12 + 4) = uVar10;
          }
          *(undefined8 *)(puVar8 + 4) = uVar10;
          uVar1 = *puVar12;
          if (uVar1 < 0xe) {
            *puVar12 = 0;
            uVar18 = uVar17;
          }
          else {
            uVar19 = uVar1 - 0xe;
            *puVar12 = 0xff;
            if (uVar19 < 0xff) {
              uVar18 = (ulong)uVar19;
              *puVar12 = uVar19;
              if (puVar13 < puVar16 + uVar18 + 8) break;
              if (uVar19 != 0) goto LAB_0011886b;
            }
            else {
              if (puVar13 < puVar16 + 0x107) break;
              uVar18 = 0xff;
              uVar19 = 0xff;
LAB_0011886b:
              uVar9 = 0;
              do {
                puVar12[uVar9 + 8] = puVar16[uVar9 + 8];
                uVar9 = uVar9 + 1;
              } while (uVar9 < uVar18);
            }
            puVar12[(ulong)uVar19 + 8] = 0;
            uVar18 = uVar17 + 1;
            uVar9 = uVar17;
          }
          uVar17 = uVar18;
          if (uVar15 <= uVar17) goto LAB_001188a8;
          puVar16 = (ushort *)((long)puVar16 + (ulong)uVar1);
          puVar12 = puVar7 + uVar9 * 0x108;
        } while (puVar16 + 1 <= puVar13);
      }
      *puVar12 = 0;
    }
LAB_001188a8:
    *puVar6 = uVar9;
    uVar10 = 0;
  }
  if (lVar4 == *(long *)(in_FS_OFFSET + 0x28)) {
    return uVar10;
  }
LAB_00118a09:
                    // WARNING: Subroutine does not return
  __stack_chk_fail();
}



void FUN_00118a10(undefined8 param_1,undefined8 param_2,undefined4 *param_3)

{
  __snprintf_chk(param_1,param_2,1,0xffffffffffffffff,
                 "%.8x-%.4x-%.4x-%.2x%.2x-%.2x%.2x%.2x%.2x%.2x%.2x",*param_3,
                 *(undefined2 *)(param_3 + 1),*(undefined2 *)((long)param_3 + 6),
                 *(undefined *)(param_3 + 2),*(undefined *)((long)param_3 + 9),
                 *(undefined *)((long)param_3 + 10),*(undefined *)((long)param_3 + 0xb),
                 *(undefined *)(param_3 + 3),*(undefined *)((long)param_3 + 0xd),
                 *(undefined *)((long)param_3 + 0xe),*(undefined *)((long)param_3 + 0xf));
  return;
}



void FUN_00118a70(char *param_1,size_t param_2,int param_3)

{
  long lVar1;
  int *piVar2;
  int iVar3;
  
  piVar2 = &DAT_00123ab0;
  iVar3 = 1;
  lVar1 = 0;
  while( true ) {
    if (param_3 == iVar3) {
      snprintf(param_1,param_2,"%s",(&PTR_s_Code_page_00123aa8)[lVar1 * 2]);
      return;
    }
    lVar1 = lVar1 + 1;
    if (lVar1 == 0x14) break;
    iVar3 = *piVar2;
    piVar2 = piVar2 + 4;
  }
  __snprintf_chk(param_1,param_2,1,0xffffffffffffffff,&DAT_0011ef8a,param_3);
  return;
}



ulong FUN_00118ae0(long param_1,ulong param_2,long param_3)

{
  long lVar1;
  int iVar2;
  ulong uVar3;
  ulong uVar4;
  ulong uVar5;
  long lVar6;
  uint uVar7;
  
  param_3 = param_3 / 10000000;
  lVar1 = param_3 / 0x3c;
  lVar6 = (lVar1 / 0x3c) / 0x18;
  uVar3 = (lVar1 / 0x3c) % 0x18;
  if (lVar6 == 0) {
    uVar7 = 0;
    uVar5 = param_2;
    uVar4 = param_2;
    lVar6 = param_1;
    if (uVar3 != 0) goto LAB_00118c92;
  }
  else {
    uVar7 = __snprintf_chk(param_1,param_2,1,0xffffffffffffffff,&DAT_0011ef8f,lVar6);
    uVar5 = (ulong)(int)uVar7;
    if (param_2 <= uVar5) goto LAB_00118bf2;
    uVar4 = param_2 - uVar5;
    lVar6 = uVar5 + param_1;
LAB_00118c92:
    iVar2 = __snprintf_chk(lVar6,uVar4,1,0xffffffffffffffff,"%.2d:",uVar3 & 0xffffffff);
    uVar7 = uVar7 + iVar2;
    uVar5 = (ulong)uVar7;
    uVar3 = (ulong)(int)uVar7;
    if (param_2 <= uVar3) goto LAB_00118bf2;
    uVar5 = param_2 - uVar3;
    lVar6 = uVar3 + param_1;
  }
  iVar2 = __snprintf_chk(lVar6,uVar5,1,0xffffffffffffffff,"%.2d:",
                         (int)lVar1 + (int)(lVar1 / 0x3c) * -0x3c);
  uVar7 = uVar7 + iVar2;
  uVar5 = (ulong)uVar7;
  uVar3 = (ulong)(int)uVar7;
  if (uVar3 < param_2) {
    iVar2 = __snprintf_chk(uVar3 + param_1,param_2 - uVar3,1,0xffffffffffffffff,&DAT_0011ef9a,
                           (int)param_3 + (int)(param_3 / 0x3c) * -0x3c);
    uVar5 = (ulong)(uVar7 + iVar2);
  }
LAB_00118bf2:
  return uVar5 & 0xffffffff;
}



int FUN_00118cd0(undefined *param_1,long param_2,long param_3)

{
  short sVar1;
  long lVar2;
  undefined *puVar3;
  
  lVar2 = 0;
  puVar3 = param_1;
  if (param_2 != 0) {
    while( true ) {
      sVar1 = *(short *)(param_3 + lVar2 * 2);
      puVar3 = param_1 + lVar2;
      if (sVar1 == 0) break;
      param_1[lVar2] = (char)sVar1;
      lVar2 = lVar2 + 1;
      if (param_2 == lVar2) {
        param_1[param_2] = 0;
        return;
      }
    }
  }
  *puVar3 = 0;
  return 0;
}



undefined8 FUN_00118d10(time_t *param_1,long param_2)

{
  uint uVar1;
  long lVar2;
  time_t tVar3;
  int *piVar4;
  undefined8 uVar5;
  ulong uVar6;
  int iVar7;
  ulong uVar8;
  int iVar9;
  long lVar10;
  uint uVar11;
  long in_FS_OFFSET;
  tm local_58;
  long local_20;
  
  local_20 = *(long *)(in_FS_OFFSET + 0x28);
  param_1[1] = (param_2 % 10000000) * 100;
  lVar2 = (param_2 / 10000000) / 0x3c;
  local_58.tm_min = (int)lVar2;
  local_58.tm_sec = (int)(param_2 / 10000000) + local_58.tm_min * -0x3c;
  lVar2 = lVar2 / 0x3c;
  local_58.tm_hour = (int)lVar2;
  local_58.tm_min = local_58.tm_min + local_58.tm_hour * -0x3c;
  lVar2 = lVar2 / 0x18;
  local_58.tm_hour = local_58.tm_hour + (int)lVar2 * -0x18;
  local_58.tm_year = (int)(param_2 / 0x11ed178c6c000);
  uVar11 = local_58.tm_year + 0x641;
  if ((int)uVar11 < 0x642) {
    lVar10 = -1;
  }
  else {
    iVar9 = 0;
    uVar1 = 0x641;
    do {
      iVar7 = 0x16d;
      if ((uVar1 & 3) == 0) {
        iVar7 = 0x16e;
        if ((uVar1 * -0x3d70a3d7 >> 2 | uVar1 * 0x40000000) < 0x28f5c29) {
          iVar7 = ((uVar1 * -0x3d70a3d7 >> 4 | uVar1 * -0x70000000) < 0xa3d70b) + 0x16d;
        }
      }
      uVar1 = uVar1 + 1;
      iVar9 = iVar9 + iVar7;
    } while (uVar11 != uVar1);
    lVar10 = (long)(iVar9 + -1);
  }
  uVar6 = lVar2 - lVar10;
  uVar8 = uVar6 & 0xffffffff;
  iVar9 = 0x1f;
  lVar2 = 1;
  do {
    local_58.tm_mday = (int)uVar6;
    if (lVar2 == 2) {
      if (((uVar11 & 3) == 0) && (((int)uVar11 % 100 != 0 || ((int)uVar11 % 400 == 0)))) {
        iVar9 = iVar9 + 1;
      }
      if (local_58.tm_mday < iVar9) break;
      local_58.tm_mday = local_58.tm_mday - iVar9;
    }
    else if ((local_58.tm_mday < iVar9) ||
            (local_58.tm_mday = local_58.tm_mday - iVar9, lVar2 == 0xc)) break;
    uVar6 = (ulong)(uint)local_58.tm_mday;
    iVar9 = *(int *)(&DAT_0011f2c0 + lVar2 * 4);
    lVar2 = lVar2 + 1;
  } while( true );
  lVar2 = 0;
  iVar9 = 0x1f;
  do {
    uVar1 = (int)uVar8 - iVar9;
    uVar8 = (ulong)uVar1;
    if (lVar2 == 1) {
      if (((uVar11 & 3) == 0) && (((int)uVar11 % 100 != 0 || ((int)uVar11 % 400 == 0)))) {
        uVar8 = (ulong)(uVar1 - 1);
      }
      if ((int)uVar8 < 1) goto LAB_00118f95;
      lVar2 = 2;
    }
    else {
      if ((int)uVar1 < 1) goto LAB_00118f95;
      lVar2 = lVar2 + 1;
      if (lVar2 == 0xc) {
        lVar2 = 0xc;
LAB_00118f95:
        local_58.tm_mon = (int)lVar2;
        local_58.tm_year = local_58.tm_year + -299;
        local_58.tm_wday = 0;
        local_58.tm_yday = 0;
        local_58.tm_isdst = 0;
        local_58.tm_zone = &DAT_001244c0;
        tVar3 = mktime(&local_58);
        *param_1 = tVar3;
        if (tVar3 == -1) {
          piVar4 = __errno_location();
          *piVar4 = 0x16;
          uVar5 = 0xffffffff;
        }
        else {
          uVar5 = 0;
        }
        if (local_20 == *(long *)(in_FS_OFFSET + 0x28)) {
          return uVar5;
        }
                    // WARNING: Subroutine does not return
        __stack_chk_fail();
      }
    }
    iVar9 = *(int *)(&DAT_0011f2c0 + lVar2 * 4);
  } while( true );
}



undefined8 FUN_00119030(void)

{
  return 0;
}



char * FUN_00119040(time_t *param_1,char *param_2)

{
  char *pcVar1;
  
  pcVar1 = ctime_r(param_1,param_2);
  if (pcVar1 != (char *)0x0) {
    return param_2;
  }
  __snprintf_chk(param_2,0x1a,1,0xffffffffffffffff,"*Bad* 0x%16.16llx\n",*param_1);
  return param_2;
}



char * FUN_001190a0(char *param_1,undefined8 *param_2)

{
  __locale_t __dataset;
  __locale_t __dataset_00;
  char *pcVar1;
  
  __dataset = newlocale(1,"C",(__locale_t)0x0);
  if (__dataset == (__locale_t)0x0) {
                    // WARNING: Subroutine does not return
    __assert_fail("c_lc_ctype != NULL","readcdf.c",0x7b,"cdf_app_to_mime");
  }
  __dataset_00 = uselocale(__dataset);
  if (__dataset_00 == (__locale_t)0x0) {
                    // WARNING: Subroutine does not return
    __assert_fail("old_lc_ctype != NULL","readcdf.c",0x7d,"cdf_app_to_mime");
  }
  do {
    pcVar1 = (char *)*param_2;
    if (pcVar1 == (char *)0x0) {
LAB_00119101:
      uselocale(__dataset_00);
      freelocale(__dataset);
      return pcVar1;
    }
    pcVar1 = strcasestr(param_1,pcVar1);
    if (pcVar1 != (char *)0x0) {
      pcVar1 = (char *)param_2[1];
      goto LAB_00119101;
    }
    param_2 = param_2 + 2;
  } while( true );
}



uint FUN_00119180(long param_1,undefined4 param_2,undefined8 param_3,undefined8 param_4)

{
  void *pvVar1;
  undefined uVar2;
  byte bVar3;
  undefined uVar10;
  int iVar4;
  uint uVar5;
  int *piVar6;
  long *plVar7;
  undefined8 uVar8;
  byte *pbVar9;
  undefined uVar11;
  int iVar12;
  char *pcVar13;
  undefined *puVar14;
  byte *pbVar15;
  char *pcVar16;
  ulong *puVar17;
  undefined **ppuVar18;
  long lVar19;
  ulong uVar20;
  ulong uVar21;
  long in_FS_OFFSET;
  double dVar22;
  char *local_7a8;
  char *local_760;
  int *local_758;
  ulong local_750;
  void *local_748 [2];
  void *local_738 [2];
  void *local_728;
  ulong local_720;
  ulong *local_718 [2];
  undefined4 local_708 [2];
  undefined8 local_700;
  undefined8 local_6f8;
  void *local_6e8 [4];
  long *local_6c8;
  undefined8 local_6c0;
  ulong local_6b8;
  short local_6a8 [3];
  short local_6a2;
  undefined local_688 [512];
  undefined local_488 [64];
  byte local_448 [1032];
  long local_40;
  
  local_40 = *(long *)(in_FS_OFFSET + 0x28);
  local_708[0] = param_2;
  local_700 = param_3;
  local_6f8 = param_4;
  if ((*(uint *)(param_1 + 0x38) & 0x1000800) == 0) {
    iVar4 = FUN_00116e60(local_708,local_688);
    if (iVar4 != -1) {
      iVar4 = FUN_00117030(local_708,local_688,local_748);
      if (iVar4 == -1) {
        pcVar13 = "Can\'t read SAT";
LAB_001193e1:
        if ((*(uint *)(param_1 + 0x38) & 0x410) == 0) {
          iVar4 = FUN_00114fd0(param_1,"Composite Document File V2 Document", "");
          if (iVar4 == -1) goto LAB_00119466;
          if (*pcVar13 == '\0') goto LAB_0011940d;
          iVar4 = FUN_00114fd0(param_1,", %s", "");
        }
        else {
          iVar4 = FUN_00114fd0(param_1,"application/CDFV2-unknown", "");
        }
        if (iVar4 != -1) goto LAB_0011940d;
      }
      else {
        iVar4 = FUN_00117a70(local_708,local_688,local_748,local_738);
        if (iVar4 == -1) {
          free(local_748[0]);
          pcVar13 = "Can\'t read SSAT";
          goto LAB_001193e1;
        }
        iVar4 = FUN_00117820(local_708,local_688,local_748,&local_728);
        if (iVar4 == -1) {
          free(local_738[0]);
          free(local_748[0]);
          pcVar13 = "Can\'t read directory";
          goto LAB_001193e1;
        }
        iVar4 = FUN_00117bf0(local_708,local_688,local_748,&local_728,local_6e8,&local_760);
        if (iVar4 == -1) {
          free(local_728);
          free(local_738[0]);
          free(local_748[0]);
          pcVar13 = "Cannot read short stream";
          goto LAB_001193e1;
        }
        iVar4 = FUN_00117d90(local_708,local_688,local_748,local_738,local_6e8,&local_728,"FileHeader");
        if (iVar4 == -1) {
LAB_0011934d:
          iVar4 = FUN_00117e50(local_708,local_688,local_748,local_738,local_6e8,&local_728,
                               &local_6c8);
          if (iVar4 == -1) {
            piVar6 = __errno_location();
            pcVar13 = "Cannot read summary info";
            if (*piVar6 == 3) {
              pcVar13 = "Catalog";
              iVar4 = FUN_00117d90(local_708,local_688,local_748,local_738,local_6e8,&local_728,"FileHeader");
              if (iVar4 == -1) {
LAB_00119b4e:
                pcVar13 = "EncryptedPackage";
                ppuVar18 = &PTR_s_Encrypted_00123be0;
                do {
                  iVar4 = FUN_00117c70(&local_728,pcVar13,*(undefined4 *)(ppuVar18 + 7));
                  if (iVar4 < 1) {
                    pcVar13 = "mfbu_header";
                    lVar19 = 0;
                    goto LAB_00119bb9;
                  }
                  ppuVar18 = (undefined **)((long)ppuVar18 + 4);
                  pcVar13 = *(char **)((long)ppuVar18 * 2 + -0x123bd0);
                } while (pcVar13 != (char *)0x0);
                lVar19 = 0;
                goto LAB_00119d72;
              }
              if ((*(uint *)(param_1 + 0x38) & 0x410) == 0) {
                iVar4 = FUN_00114fd0(param_1,"Microsoft Thumbs.db [",&local_6c8);
                if ((iVar4 == -1) ||
                   (iVar4 = FUN_00118680(local_688,&local_6c8,local_718), iVar4 == -1))
                goto LAB_00119b4e;
                uVar20 = *local_718[0];
                if (1 < uVar20) {
                  puVar17 = local_718[0] + 0x45;
                  uVar21 = 1;
                  do {
                    pcVar13 = ", ";
                    if (uVar20 - 1 == uVar21) {
                      pcVar13 = "]";
                    }
                    uVar8 = FUN_00118cd0(local_448,*(undefined2 *)(puVar17 + -2),puVar17);
                    iVar4 = FUN_00114fd0(param_1,uVar8,pcVar13);
                    if (iVar4 == -1) {
                      free(local_718[0]);
                      goto LAB_00119b4e;
                    }
                    uVar21 = uVar21 + 1;
                    puVar17 = puVar17 + 0x42;
                    uVar20 = *local_718[0];
                  } while (uVar21 < uVar20);
                }
                free(local_718[0]);
              }
              else {
                iVar4 = FUN_00114fd0(param_1,"application/CDFV2",&local_6c8);
                if (iVar4 == -1) goto LAB_00119b4e;
              }
              goto LAB_00119cb0;
            }
            goto LAB_00119392;
          }
          local_7a8 = local_760;
          iVar4 = FUN_001184a0(&local_6c8,local_688,local_6a8,&local_758,&local_750);
          if (iVar4 == -1) {
LAB_00119de9:
            free(local_6c8);
            free(local_6e8[0]);
            free(local_728);
            free(local_738[0]);
            free(local_748[0]);
            pcVar13 = "Can\'t expand summary_info";
            goto LAB_001193e1;
          }
          if ((*(uint *)(param_1 + 0x38) & 0x410) != 0) {
            if (local_760 == (char *)0x0) {
              uVar20 = local_750;
              if (local_750 != 0) goto LAB_001195b1;
LAB_0011997f:
              uVar20 = 0;
              free(local_758);
              do {
                pvVar1 = local_728;
                if (local_720 <= uVar20) {
                  uVar5 = *(uint *)(param_1 + 0x38) & 0x410;
                  if (uVar5 == 0) goto LAB_00119677;
                  pcVar13 = "vnd.ms-office";
                  goto LAB_00119a1e;
                }
                lVar19 = 0;
                do {
                  bVar3 = FUN_00116630(*(undefined2 *)((long)pvVar1 + lVar19 * 2 + uVar20 * 0x88));
                  local_448[lVar19] = bVar3;
                  lVar19 = lVar19 + 1;
                } while (lVar19 != 0x20);
                ppuVar18 = &PTR_DAT_00123ce0;
                if ((*(uint *)(param_1 + 0x38) & 0x410) == 0) {
                  ppuVar18 = &PTR_DAT_00123c80;
                }
                uVar20 = uVar20 + 1;
                pcVar13 = (char *)FUN_001190a0(local_448,ppuVar18);
              } while (pcVar13 == (char *)0x0);
              pcVar16 = "%s";
              if ((*(uint *)(param_1 + 0x38) & 0x410) != 0) {
LAB_00119a1e:
                pcVar16 = "application/%s";
              }
              iVar4 = FUN_00114fd0(param_1,pcVar16,pcVar13);
              if (iVar4 == -1) goto LAB_00119466;
            }
            else {
LAB_0011992b:
              if (*(long *)(local_760 + 0x50) == 0xc1084) {
LAB_0011993d:
                if (*(long *)(local_760 + 0x58) != 0x46000000000000c0) goto LAB_001195a0;
                local_7a8 = "x-msi";
              }
              else {
LAB_001195a0:
                local_7a8 = (char *)0x0;
              }
LAB_001195a8:
              uVar20 = local_750;
              if (local_750 != 0) {
LAB_001195b1:
                uVar21 = 0;
                piVar6 = local_758;
                do {
                  FUN_00118a70(local_488,0x40,*piVar6);
                  iVar4 = piVar6[1];
                  if (false) goto LAB_0011966d;
                  pbVar9 = local_448;
                  switch(iVar4) {
                  default:
                    goto LAB_0011966d;
                  case 1:
                  case 0x47:
                    break;
                  case 2:
                    if ((*(uint *)(param_1 + 0x38) & 0x410) == 0) {
                      iVar4 = (int)*(short *)(piVar6 + 2);
                      pcVar13 = ", %s: %hd";
LAB_0011980c:
                      iVar4 = FUN_00114fd0(param_1,pcVar13,iVar4);
joined_r0x0011965e:
                      if (iVar4 == -1) goto LAB_0011966d;
                    }
                    break;
                  case 3:
                    if ((*(uint *)(param_1 + 0x38) & 0x410) == 0) {
                      iVar4 = piVar6[2];
                      pcVar13 = ", %s: %d";
                      goto LAB_0011980c;
                    }
                    break;
                  case 4:
                    if ((*(uint *)(param_1 + 0x38) & 0x410) == 0) {
                      dVar22 = (double)(float)piVar6[2];
LAB_0011983f:
                      iVar4 = FUN_00114fd0(dVar22,param_1,local_488);
                      goto joined_r0x0011965e;
                    }
                    break;
                  case 5:
                    if ((*(uint *)(param_1 + 0x38) & 0x410) == 0) {
                      dVar22 = *(double *)(piVar6 + 2);
                      goto LAB_0011983f;
                    }
                    break;
                  case 0x13:
                    if ((*(uint *)(param_1 + 0x38) & 0x410) == 0) {
                      iVar4 = piVar6[2];
                      pcVar13 = ", %s: %u";
                      goto LAB_0011980c;
                    }
                    break;
                  case 0x1e:
                  case 0x1f:
                    if (1 < piVar6[2]) {
                      pbVar15 = *(byte **)(piVar6 + 4);
                      iVar12 = piVar6[2] + -1;
                      lVar19 = 0;
                      do {
                        bVar3 = *pbVar15;
                        if (bVar3 == 0) break;
                        plVar7 = (long *)FUN_00104d70();
                        if ((*(byte *)(*plVar7 + 1 + (ulong)bVar3 * 2) & 0x40) != 0) {
                          local_448[lVar19] = bVar3;
                          lVar19 = lVar19 + 1;
                        }
                        pbVar15 = pbVar15 + (ulong)(iVar4 == 0x1f) + 1;
                        if (lVar19 == 0x400) {
                          lVar19 = 0x3ff;
                          break;
                        }
                        iVar12 = iVar12 + -1;
                      } while (iVar12 != -1);
                      local_448[lVar19] = 0;
                      if ((*(uint *)(param_1 + 0x38) & 0x410) == 0) {
                        if (local_448[0] != 0) goto LAB_00119647;
                      }
                      else if ((local_7a8 == (char *)0x0) && (*piVar6 == 0x12)) {
                        local_7a8 = (char *)FUN_001190a0(local_448,&DAT_00123d40);
                      }
                    }
                    break;
                  case 0x40:
                    lVar19 = *(long *)(piVar6 + 2);
                    if (lVar19 != 0) {
                      if (lVar19 < 1000000000000000) {
                        FUN_00118ae0(local_448,0x40, 0x00);
                        uVar5 = *(uint *)(param_1 + 0x38);
                      }
                      else {
                        FUN_00118d10(local_718,lVar19);
                        pbVar9 = (byte *)FUN_00119040(local_718,local_448);
                        if ((pbVar9 != (byte *)0x0) &&
                           (pcVar13 = strchr((char *)pbVar9,10), pcVar13 != (char *)0x0)) {
                          *pcVar13 = '\0';
                        }
                        uVar5 = *(uint *)(param_1 + 0x38);
                      }
                      if ((uVar5 & 0x410) == 0) {
LAB_00119647:
                        iVar4 = FUN_00114fd0(param_1,", %s: %s",pbVar9);
                        goto joined_r0x0011965e;
                      }
                    }
                  }
                  uVar21 = uVar21 + 1;
                  piVar6 = piVar6 + 6;
                } while (uVar21 < uVar20);
              }
              if ((*(uint *)(param_1 + 0x38) & 0x410) != 0) {
                if (local_7a8 == (char *)0x0) goto LAB_0011997f;
                iVar4 = FUN_00114fd0(param_1,"application/%s",local_7a8);
                if (iVar4 == -1) {
LAB_0011966d:
                  free(local_758);
                  goto LAB_00119672;
                }
              }
LAB_00119706:
              free(local_758);
            }
            goto LAB_0011970b;
          }
          iVar4 = FUN_00114fd0(param_1,"Composite Document File V2 Document", "");
          if (iVar4 == -1) goto LAB_00119de9;
          pcVar13 = "Little";
          if (local_6a8[0] != -2) {
            pcVar13 = "Big";
          }
          iVar4 = FUN_00114fd0(param_1,", %s Endian",pcVar13);
          if (iVar4 != -1) {
            uVar10 = (undefined)((ushort)local_6a8[2] >> 8);
            uVar2 = (undefined)local_6a8[2];
            if (local_6a2 == 1) {
              pcVar13 = ", Os: MacOS, Version %d.%d";
              uVar11 = uVar2;
LAB_00119554:
              iVar4 = FUN_00114fd0(param_1,pcVar13,uVar11);
            }
            else {
              if (local_6a2 == 2) {
                pcVar13 = ", Os: Windows, Version %d.%d";
                uVar11 = uVar10;
                uVar10 = uVar2;
                goto LAB_00119554;
              }
              iVar4 = FUN_00114fd0(param_1,", Os %d, Version: %d.%d",local_6a2);
            }
            if (iVar4 != -1) {
              if (local_760 == (char *)0x0) goto LAB_001195a8;
              if (*(long *)(local_760 + 0x50) == 0xc1084) {
                if (*(long *)(local_760 + 0x58) == 0x46000000000000c0) {
                  iVar4 = FUN_00114fd0(param_1,", %s","MSI Installer");
                  if (iVar4 == -1) goto LAB_00119672;
                  if ((*(uint *)(param_1 + 0x38) & 0x410) != 0) goto LAB_0011992b;
                }
                else if ((*(uint *)(param_1 + 0x38) & 0x410) != 0) goto LAB_0011993d;
              }
              else if ((*(uint *)(param_1 + 0x38) & 0x410) != 0) goto LAB_001195a0;
              if (local_750 != 0) {
                local_7a8 = (char *)0x0;
                uVar20 = local_750;
                goto LAB_001195b1;
              }
              goto LAB_00119706;
            }
          }
LAB_00119672:
          uVar5 = 0xfffffffe;
LAB_00119677:
          free(local_6c8);
          free(local_6e8[0]);
          free(local_728);
          free(local_738[0]);
          free(local_748[0]);
          goto LAB_001191ca;
        }
        if (((local_6b8 < 0x11) ||
            (local_6c8[1] != 0x6c694620746e656d || *local_6c8 != 0x75636f4420505748)) ||
           (*(char *)(local_6c8 + 2) != 'e')) {
          free(local_6c8);
          local_6c8 = (long *)0x0;
          local_6c0 = 0;
          local_6b8 = 0;
          goto LAB_0011934d;
        }
        pcVar13 = "application/x-hwp";
        if ((*(uint *)(param_1 + 0x38) & 0x410) == 0) {
          pcVar13 = "Hangul (Korean) Word Processor File 5.x";
        }
        iVar4 = FUN_00114fd0(param_1,"", pcVar13);
        if (iVar4 != -1) {
LAB_0011970b:
          uVar5 = 1;
          goto LAB_00119677;
        }
      }
LAB_00119466:
      uVar5 = 0xffffffff;
      goto LAB_001191ca;
    }
  }
  uVar5 = 0;
  goto LAB_001191ca;
  while( true ) {
    lVar19 = lVar19 + 1;
    pcVar13 = (&PTR_s_mfbu_header_00123c40)[lVar19];
    if (pcVar13 == (char *)0x0) break;
LAB_00119bb9:
    iVar4 = FUN_00117c70(&local_728,pcVar13,(&DAT_00123c68)[lVar19]);
    if (iVar4 < 1) goto LAB_00119bc9;
  }
  lVar19 = 1;
LAB_00119d72:
  if ((*(uint *)(param_1 + 0x38) & 0x410) == 0) {
    pcVar13 = "CDFV2 %s";
    puVar14 = (&PTR_s_Encrypted_00123be0)[lVar19 * 10];
  }
  else {
    pcVar13 = "application/CDFV2-%s";
    puVar14 = (&PTR_s_encrypted_00123be8)[lVar19 * 10];
  }
  iVar4 = FUN_00114fd0(param_1,pcVar13,puVar14);
  if (iVar4 == -1) {
LAB_00119bc9:
    pcVar13 = "Cannot read section info";
LAB_00119392:
    free(local_6e8[0]);
    free(local_728);
    free(local_738[0]);
    free(local_748[0]);
    goto LAB_001193e1;
  }
LAB_00119cb0:
  free(local_6e8[0]);
  free(local_728);
  free(local_738[0]);
  free(local_748[0]);
LAB_0011940d:
  uVar5 = 1;
LAB_001191ca:
  if (local_40 == *(long *)(in_FS_OFFSET + 0x28)) {
    return uVar5;
  }
                    // WARNING: Subroutine does not return
  __stack_chk_fail();
}



char * FUN_00119e40(char *param_1,char *param_2,long param_3)

{
  char cVar1;
  char *pcVar2;
  char *pcVar3;
  char *pcVar4;
  
  pcVar3 = param_2;
  if (param_3 != 0) {
    pcVar2 = param_2;
    pcVar3 = param_1;
    pcVar4 = param_1;
    if (param_3 != 1) {
      do {
        cVar1 = *pcVar2;
        pcVar2 = pcVar2 + 1;
        pcVar4 = pcVar3 + 1;
        *pcVar3 = cVar1;
        if (cVar1 == '\0') goto LAB_00119e83;
        pcVar3 = pcVar4;
      } while (param_1 + ~(ulong)pcVar4 + param_3 != (char *)0x0);
    }
    *pcVar4 = '\0';
    pcVar3 = pcVar2;
  }
  do {
    pcVar2 = pcVar3 + 1;
    if (*pcVar3 == '\0') break;
    pcVar2 = pcVar3 + 2;
    pcVar4 = pcVar3 + 1;
    pcVar3 = pcVar2;
  } while (*pcVar4 != '\0');
LAB_00119e83:
  return pcVar2 + (-1 - (long)param_2);
}



char * FUN_00119ec0(char *param_1,char *param_2,long param_3)

{
  char *pcVar1;
  size_t sVar2;
  char *pcVar3;
  char cVar4;
  char *pcVar5;
  
  if (param_3 == 0) {
    pcVar5 = (char *)0x0;
  }
  else {
    pcVar1 = param_1;
    do {
      if (*pcVar1 == '\0') break;
      pcVar1 = pcVar1 + 1;
    } while (pcVar1 != param_1 + param_3);
    pcVar5 = pcVar1 + -(long)param_1;
    param_3 = param_3 - (long)pcVar5;
    if (param_3 != 0) {
      cVar4 = *param_2;
      pcVar3 = param_2;
      if (cVar4 != '\0') {
        do {
          if (param_3 != 1) {
            *pcVar1 = cVar4;
            param_3 = param_3 + -1;
            pcVar1 = pcVar1 + 1;
          }
          cVar4 = pcVar3[1];
          pcVar3 = pcVar3 + 1;
        } while (cVar4 != '\0');
        pcVar5 = pcVar3 + ((long)pcVar5 - (long)param_2);
      }
      *pcVar1 = '\0';
      return pcVar5;
    }
  }
  sVar2 = strlen(param_2);
  return pcVar5 + sVar2;
}



undefined8 FUN_00119f50(long *param_1)

{
  int iVar1;
  char *pcVar2;
  undefined8 uVar3;
  int iVar4;
  char cVar5;
  char *pcVar6;
  int __c;
  int iVar7;
  int iVar8;
  
  pcVar2 = (char *)*param_1;
  cVar5 = *pcVar2;
  if (cVar5 == 'l') {
    cVar5 = pcVar2[1];
    pcVar6 = pcVar2 + 1;
    if (cVar5 == '\0') {
      *param_1 = (long)pcVar6;
      return 0xf;
    }
    if (cVar5 == 'l') {
      cVar5 = pcVar2[2];
      pcVar2 = pcVar2 + 2;
      iVar7 = 0;
      iVar1 = 1;
LAB_00119f97:
      iVar4 = 0;
      pcVar6 = pcVar2;
      goto joined_r0x00119fdf;
    }
    iVar8 = 1;
LAB_0011a00d:
    __c = (int)cVar5;
    pcVar2 = strchr("diouxX",__c);
    if (pcVar2 != (char *)0x0) {
      if (iVar8 != 0) {
        *param_1 = (long)pcVar6;
        return 3;
      }
      goto LAB_0011a032;
    }
    iVar4 = 0;
    iVar1 = 0;
    iVar7 = 0;
  }
  else {
    if (cVar5 < 'm') {
      if (cVar5 != 'L') {
        if (cVar5 == 'h') {
          cVar5 = pcVar2[1];
          pcVar2 = pcVar2 + 1;
          iVar1 = 0;
          iVar7 = 1;
        }
        else {
          iVar1 = 0;
          iVar7 = 0;
        }
        goto LAB_00119f97;
      }
      cVar5 = pcVar2[1];
      pcVar6 = pcVar2 + 1;
      iVar1 = 0;
      iVar7 = 0;
      iVar4 = 1;
    }
    else {
      iVar8 = 0;
      pcVar6 = pcVar2;
      if (cVar5 != 'q') goto LAB_0011a00d;
      cVar5 = pcVar2[1];
      iVar4 = 0;
      iVar7 = 0;
      iVar1 = 1;
      pcVar6 = pcVar2 + 1;
    }
joined_r0x00119fdf:
    if (cVar5 == '\0') {
LAB_00119fa0:
      *param_1 = (long)pcVar6;
      return 0xf;
    }
    __c = (int)cVar5;
    pcVar2 = strchr("diouxX",__c);
    if (pcVar2 != (char *)0x0) {
      if (iVar4 == 0) {
        if (iVar1 != 0) {
          *param_1 = (long)pcVar6;
          return 4;
        }
LAB_0011a032:
        *param_1 = (long)pcVar6;
        return 2;
      }
      goto LAB_00119fa0;
    }
    iVar8 = 0;
  }
  if (cVar5 == 'n') {
    if (iVar4 == 0) {
      *param_1 = (long)pcVar6;
      if (iVar7 != 0) {
        return 5;
      }
      if (iVar8 == 0) {
        if (iVar1 == 0) {
          return 6;
        }
        return 8;
      }
      return 7;
    }
LAB_0011a198:
    *param_1 = (long)pcVar6;
    return 0xf;
  }
  pcVar2 = strchr("DOU",__c);
  if (pcVar2 == (char *)0x0) {
    pcVar2 = strchr("eEfg",__c);
    if (pcVar2 == (char *)0x0) {
      if (cVar5 == 'c') {
        *param_1 = (long)pcVar6;
        uVar3 = 2;
      }
      else {
        if (cVar5 != 's') {
          if (cVar5 != 'p') goto LAB_0011a198;
          *param_1 = (long)pcVar6;
          goto joined_r0x0011a183;
        }
        *param_1 = (long)pcVar6;
        uVar3 = 0xb;
      }
      iVar1 = iVar7 + iVar8 + iVar1 + iVar4;
    }
    else {
      if (iVar4 != 0) {
        *param_1 = (long)pcVar6;
        return 10;
      }
      *param_1 = (long)pcVar6;
      iVar1 = iVar7 + iVar8 + iVar1;
      uVar3 = 9;
    }
    if (iVar1 == 0) {
      return uVar3;
    }
  }
  else {
    *param_1 = (long)pcVar6;
joined_r0x0011a183:
    if (iVar7 + iVar8 + iVar1 + iVar4 == 0) {
      return 3;
    }
  }
  return 0xf;
}



undefined8 FUN_0011a280(long *param_1)

{
  long *plVar1;
  char *pcVar2;
  undefined8 uVar3;
  byte bVar4;
  
  pcVar2 = (char *)*param_1;
  if (*pcVar2 == '.') {
    bVar4 = pcVar2[1];
    pcVar2 = pcVar2 + 1;
    if (bVar4 == 0x2a) {
      *param_1 = (long)pcVar2;
      uVar3 = 0xd;
    }
    else {
      plVar1 = (long *)FUN_00104d70();
      while ((*(byte *)(*plVar1 + 1 + (ulong)bVar4 * 2) & 8) != 0) {
        bVar4 = pcVar2[1];
        pcVar2 = pcVar2 + 1;
      }
      if (bVar4 != 0) goto LAB_0011a2c6;
      *param_1 = (long)pcVar2;
      uVar3 = 0xf;
    }
    return uVar3;
  }
LAB_0011a2c6:
  *param_1 = (long)pcVar2;
  uVar3 = FUN_00119f50(param_1);
  return uVar3;
}



undefined8 FUN_0011a300(long *param_1,int param_2)

{
  char *pcVar1;
  long *plVar2;
  undefined8 uVar3;
  byte bVar4;
  byte *pbVar5;
  
  pcVar1 = (char *)*param_1;
  if (param_2 == 0xc) {
    *param_1 = (long)(pcVar1 + 1);
  }
  else {
    if (param_2 == 0xd) {
      *param_1 = (long)(pcVar1 + 1);
      uVar3 = FUN_00119f50(param_1);
      return uVar3;
    }
    while( true ) {
      pcVar1 = strchr(pcVar1,0x25);
      if (pcVar1 == (char *)0x0) {
        *param_1 = 0;
        return 0xe;
      }
      bVar4 = pcVar1[1];
      pbVar5 = (byte *)(pcVar1 + 1);
      if (bVar4 == 0) {
        *param_1 = (long)pbVar5;
        return 0xf;
      }
      if (bVar4 != 0x25) break;
      pcVar1 = pcVar1 + 2;
    }
    do {
      pcVar1 = strchr("#0- +",(int)(char)bVar4);
      if (pcVar1 == (char *)0x0) {
        if (bVar4 == 0x2a) {
          *param_1 = (long)pbVar5;
          return 0xc;
        }
        bVar4 = *pbVar5;
        break;
      }
      bVar4 = pbVar5[1];
      pbVar5 = pbVar5 + 1;
    } while (bVar4 != 0);
    plVar2 = (long *)FUN_00104d70();
    while ((*(byte *)(*plVar2 + 1 + (ulong)bVar4 * 2) & 8) != 0) {
      bVar4 = pbVar5[1];
      pbVar5 = pbVar5 + 1;
    }
    *param_1 = (long)pbVar5;
    if (bVar4 == 0) {
      return 0xf;
    }
  }
  uVar3 = FUN_0011a280(param_1);
  return uVar3;
}



long FUN_0011a440(long param_1,long param_2)

{
  int iVar1;
  int iVar2;
  long lVar3;
  long in_FS_OFFSET;
  long local_50;
  long local_48;
  long local_40;
  
  local_40 = *(long *)(in_FS_OFFSET + 0x28);
  lVar3 = param_2;
  if (param_1 != 0) {
    iVar1 = 0;
    iVar2 = 0;
    local_50 = param_1;
    local_48 = param_2;
    do {
      iVar2 = FUN_0011a300(&local_50,iVar2);
      lVar3 = param_1;
      if ((iVar2 == 0xe) || (lVar3 = param_2, iVar2 == 0xf)) break;
      iVar1 = FUN_0011a300(&local_48,iVar1);
    } while (iVar2 == iVar1);
  }
  if (local_40 != *(long *)(in_FS_OFFSET + 0x28)) {
                    // WARNING: Subroutine does not return
    __stack_chk_fail();
  }
  return lVar3;
}



void _DT_FINI(void)

{
  return;
}


